alter table TB_HISTORIQUE_CLIENT add total_amounte decimal(18,2)
alter table TB_VENTE add cout money
alter table TB_VENTE add typee nvarchar(50)


insert_tb_historique_clien
get_information_bon
insert_vente_
get_vente_dtl
GetAllFacturesInDesc


USE [DB_PRODUCTION_POS]
GO
/****** Object:  UserDefinedFunction [dbo].[SplitString]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[SplitString]
(
    @Input NVARCHAR(MAX),
    @Delimiter CHAR(1)
)
RETURNS @Output TABLE (Value NVARCHAR(MAX))
AS
BEGIN
    DECLARE @Start INT, @End INT
    SET @Start = 1

    WHILE CHARINDEX(@Delimiter, @Input, @Start) > 0
    BEGIN
        SET @End = CHARINDEX(@Delimiter, @Input, @Start)
        INSERT INTO @Output (Value)
        VALUES (SUBSTRING(@Input, @Start, @End - @Start))
        SET @Start = @End + 1
    END

    INSERT INTO @Output (Value)
    VALUES (SUBSTRING(@Input, @Start, LEN(@Input) - @Start + 1))

    RETURN
END



GO
/****** Object:  Table [dbo].[historique_delelte]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[historique_delelte](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[datee] [date] NULL,
	[time] [time](7) NULL,
	[remarque] [nvarchar](max) NULL,
 CONSTRAINT [PK_historique_delelte] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[ID_client_Count]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ID_client_Count](
	[ID_client] [int] NOT NULL,
	[Total_Count] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID_client] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[ID_frnsre_count]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ID_frnsre_count](
	[ID_frnsre] [int] NOT NULL,
	[Total_Count] [int] NULL,
PRIMARY KEY CLUSTERED 
(
	[ID_frnsre] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Table_1]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Table_1](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NAME_FAV] [nvarchar](50) NULL,
 CONSTRAINT [PK_Table_1] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TABLE_PACK_REVENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TABLE_PACK_REVENTE](
	[CODE_BARRE_PACK] [nvarchar](50) NOT NULL,
	[DESIGNATION_PACK] [nvarchar](50) NULL,
	[CODE_BARRE_PRODUIT] [nvarchar](50) NULL,
	[QT_DE_PACK] [float] NULL,
	[PRICE_PACK] [decimal](19, 2) NULL,
	[ID_FAVOIRE] [int] NULL,
 CONSTRAINT [PK_TABLE_PACK_REVENTE] PRIMARY KEY CLUSTERED 
(
	[CODE_BARRE_PACK] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_ACHAT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_ACHAT](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_PRODUIT] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[QUANTITE_AFTER] [float] NULL,
	[PRIX_ACHAT_HT] [decimal](19, 2) NULL,
	[TVA] [decimal](19, 2) NULL,
	[PRIX_ACHAT_TTC] [decimal](19, 2) NULL,
	[TOTAL_HT] [decimal](19, 2) NULL,
	[TOTAL_TTC] [decimal](19, 2) NULL,
	[REMARQUE] [nvarchar](50) NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_ACHAT] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_ACHAT_CAISSE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_ACHAT_CAISSE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_PRODUIT] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[QUANTITE_AFTER] [float] NULL,
	[PRIX_ACHAT_HT] [decimal](19, 2) NULL,
	[TVA] [decimal](19, 2) NULL,
	[PRIX_ACHAT_TTC] [decimal](19, 2) NULL,
	[TOTAL_HT] [decimal](19, 2) NULL,
	[TOTAL_TTC] [decimal](19, 2) NULL,
	[REMARQUE] [nvarchar](50) NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
	[TYPE_achat] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_ACHAT_CAISSE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_ACHAT_PRODUIT_REVENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_ACHAT_PRODUIT_REVENT](
	[ID] [int] NOT NULL,
	[CODE_PRODUIT] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[PRICE_ACHAT_HT] [decimal](19, 2) NULL,
	[TVA] [decimal](19, 2) NULL,
	[PRICE_ACHAT_TTC] [decimal](19, 2) NULL,
	[TOTAL_HT] [decimal](19, 2) NULL,
	[TOTAL_TTC] [decimal](19, 2) NULL,
	[REMARQUE] [nvarchar](max) NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
	[QUANTITE_BEFOR] [float] NULL,
	[QUANTITE_AFTER] [float] NULL,
 CONSTRAINT [PK_TB_ACHAT_PRODUIT_REVENT] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_ACHAT_PRODUIT_REVENT_CAISSE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_ACHAT_PRODUIT_REVENT_CAISSE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CODE_PRODUIT] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[PRICE_ACHAT_HT] [decimal](19, 2) NULL,
	[TVA] [decimal](19, 2) NULL,
	[PRICE_ACHAT_TTC] [decimal](19, 2) NULL,
	[TOTAL_HT] [decimal](19, 2) NULL,
	[TOTAL_TTC] [decimal](19, 2) NULL,
	[REMARQUE] [nvarchar](max) NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
	[QUANTITE_BEFOR] [float] NULL,
	[QUANTITE_AFTER] [float] NULL,
	[TYPE_FACTURE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_ACHAT_PRODUIT_REVENT_CAISSE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_CATEGORIES]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_CATEGORIES](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CATEGORIES] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_CATEGORIES] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_CLIENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_CLIENT](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NAME] [nvarchar](50) NULL,
	[PRENAME] [nvarchar](50) NULL,
	[PHONE] [nvarchar](50) NULL,
	[FAX] [nvarchar](50) NULL,
	[EMAIL] [nvarchar](50) NULL,
	[SOLD_TOTAL] [decimal](19, 2) NULL,
	[SOLD_PAYE] [decimal](19, 2) NULL,
	[SOLD_NON_PAYE] [decimal](19, 2) NULL,
	[ADRESSE] [nvarchar](50) NULL,
	[Sold_avance] [decimal](19, 2) NULL,
	[MAX_CREDIT] [decimal](19, 2) NULL,
	[NIF] [nvarchar](50) NULL,
	[RC] [nvarchar](50) NULL,
	[Nic] [nvarchar](50) NULL,
	[article] [nvarchar](50) NULL,
	[originale_name_prename] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_CLIENT] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_CODE_BARRE_RESERVE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_CODE_BARRE_RESERVE](
	[code_barre_produit] [nvarchar](50) NULL,
	[code_barre_reserve] [nvarchar](50) NULL,
	[id] [int] IDENTITY(1,1) NOT NULL,
 CONSTRAINT [PK_TB_CODE_BARRE_RESERVE] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_CODE_BARRE_RESERVER_PACK]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_CODE_BARRE_RESERVER_PACK](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CODE_BARRE_OFFICIAL] [nvarchar](50) NULL,
	[CODE_BARRE_RESERVER] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_CODE_BARRE_RESERVER_PACK] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_COFRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_COFRE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[SOLD_ON_COFRE] [decimal](19, 2) NULL,
 CONSTRAINT [PK_TB_COFRE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_COLOR]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_COLOR](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[COLOR] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_COLOR] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_COMMANDE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_COMMANDE](
	[ID] [nvarchar](50) NOT NULL,
	[DATE] [date] NULL,
	[NOM_COMMANDE] [nvarchar](50) NULL,
	[ID_CLIENT] [int] NULL,
	[TYPE_COMMANDE] [nvarchar](50) NULL,
	[COUT_TOTAL] [decimal](19, 2) NULL,
	[VERSEMENT] [decimal](19, 2) NULL,
	[QTE] [int] NULL,
	[REMARQUE] [nvarchar](max) NULL,
	[PRICE_TOTAL_HT] [decimal](19, 2) NULL,
	[PRICE_TOTAL_TTC] [decimal](19, 2) NULL,
	[TVA] [decimal](19, 2) NULL,
	[deadline_Date] [date] NULL,
	[etas] [nvarchar](50) NULL,
	[id_user] [int] NULL,
	[TMBER] [float] NULL,
	[PRICE_ARAB] [nvarchar](50) NULL,
	[historique_Money] [decimal](19, 2) NULL,
	[new_money] [decimal](19, 2) NULL,
	[Price_en_francais] [nvarchar](100) NULL,
 CONSTRAINT [PK_TB_COMMANDE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_DECHET]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_DECHET](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[QT_Dechet] [int] NULL,
	[etas] [nvarchar](50) NULL,
	[price_u] [decimal](19, 2) NULL,
	[price_ttl] [decimal](19, 2) NULL,
	[ID_MATIER] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_DECHET] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_DECHET_REClage]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_DECHET_REClage](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[QT_Dechet] [int] NULL,
	[etas] [nvarchar](50) NULL,
	[ID_MATIER] [nvarchar](50) NULL,
	[price_u] [decimal](19, 2) NULL,
	[price_ttl] [decimal](19, 2) NULL,
 CONSTRAINT [PK_TB_DECHET_REClage] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_DEPENSE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_DEPENSE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CAUSE_DEPENSE] [nvarchar](max) NULL,
	[VALEURE] [decimal](19, 2) NULL,
	[DATE] [datetime] NULL,
	[USER_ID] [int] NULL,
 CONSTRAINT [PK_TB_DEPENSE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_DETAILLE_INVENTAIRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_DETAILLE_INVENTAIRE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CODEBARRE_PRODUIT] [nvarchar](50) NULL,
	[QUANTITE_THERORIQUE] [decimal](18, 2) NULL,
	[QUANTITE_PHY] [decimal](18, 2) NULL,
	[ECART] [decimal](18, 2) NULL,
	[PU] [decimal](18, 2) NULL,
	[P_TTL_ECART] [decimal](18, 2) NULL,
	[OBSERVATION] [nvarchar](max) NULL,
	[ID_PRINCIPALE_INVENTAIRE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_DETAILLE_INVENTAIRE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_DTL_LIVRAISON_TYPE_2]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_DTL_LIVRAISON_TYPE_2](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_SUB_COMMANDE] [int] NULL,
	[QT_LIV] [float] NULL,
	[PU] [money] NULL,
	[P_TTL] [money] NULL,
	[ID_TB_INFO_TYPE_2] [int] NULL,
 CONSTRAINT [PK_TB_DTL_LIVRAISON_TYPE_2] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FACTURATION]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FACTURATION](
	[Nmr_facture] [nvarchar](50) NOT NULL,
	[id_client] [int] NULL,
	[id_caissie] [int] NULL,
	[id_user] [int] NULL,
	[date] [date] NULL,
	[heure] [time](7) NULL,
	[Total_ttc] [decimal](18, 2) NULL,
	[total_ht] [decimal](18, 2) NULL,
	[tva] [decimal](18, 2) NULL,
	[remise] [decimal](18, 2) NULL,
	[pourcentage_remise] [float] NULL,
	[tembre] [float] NULL,
	[price_originale] [decimal](18, 2) NULL,
	[Count_article] [int] NULL,
	[ttl_QTT] [float] NULL,
	[price_arabe] [nvarchar](50) NULL,
	[price_fr] [nvarchar](50) NULL,
	[type_payment] [nvarchar](50) NULL,
	[old_sold] [decimal](18, 2) NULL,
	[versement] [decimal](18, 2) NULL,
	[new_sold] [decimal](18, 2) NULL,
	[remarque] [nvarchar](max) NULL,
	[cout_fctr] [decimal](18, 2) NULL,
	[etas] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_FACTURATION] PRIMARY KEY CLUSTERED 
(
	[Nmr_facture] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FACTURATION_VENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FACTURATION_VENTE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CODE_BARRE] [nvarchar](50) NULL,
	[DESIGNATION] [nvarchar](50) NULL,
	[N_COLIS] [float] NULL,
	[COLISSAGE] [float] NULL,
	[QTE] [float] NULL,
	[PRIC_U] [decimal](18, 2) NULL,
	[PRIE_TTL] [decimal](18, 2) NULL,
	[REMISE] [decimal](18, 2) NULL,
	[PRICE_APRES_REMISE] [decimal](18, 2) NULL,
	[PRNST] [float] NULL,
	[nmr_fctr] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_FACTURATION_VENTE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FACTURE_ACHAT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FACTURE_ACHAT](
	[NMR_FCTR] [nvarchar](50) NOT NULL,
	[DATE] [date] NULL,
	[ID_FRNSR] [int] NULL,
	[NMBRE_PRODUIT] [int] NULL,
	[VERSEMENT] [decimal](19, 2) NULL,
	[TOTAL] [decimal](19, 2) NULL,
	[ID_USER] [int] NULL,
	[total_HT] [decimal](19, 2) NULL,
	[Creditprecidenet] [decimal](19, 2) NULL,
	[creditNew] [decimal](19, 2) NULL,
 CONSTRAINT [PK_TB_FACTURE_ACHAT] PRIMARY KEY CLUSTERED 
(
	[NMR_FCTR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT](
	[NMR_FCTR] [nvarchar](50) NOT NULL,
	[DATE] [datetime] NULL,
	[ID_FOURNISSEUR] [int] NULL,
	[NMBRE_DE_PRODUIT] [int] NULL,
	[VERSEMNT] [decimal](19, 2) NULL,
	[TOTAL] [decimal](19, 2) NULL,
	[ID_USER] [int] NULL,
	[TOTAL_HT] [decimal](19, 2) NULL,
	[CREDIT_PRECEDENT] [decimal](19, 2) NULL,
	[CREDIT_AFTER] [decimal](19, 2) NULL,
 CONSTRAINT [PK_[TB_FACTURE_ACHAT_PRODUIT_REVENT] PRIMARY KEY CLUSTERED 
(
	[NMR_FCTR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FACTURE_VENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FACTURE_VENTE](
	[NMR_FACTURE] [nvarchar](50) NOT NULL,
	[DATE] [date] NULL,
	[HEURE] [time](7) NULL,
	[ID_CLIENT] [int] NULL,
	[TOTAL_FACURE_TTC] [decimal](19, 2) NULL,
	[TOTAL_FACTURE_HT] [decimal](19, 2) NULL,
	[TVA] [float] NULL,
	[OLD_SOLD] [decimal](19, 2) NULL,
	[VERSEMENT] [decimal](19, 2) NULL,
	[NEW_SOLD] [decimal](19, 2) NULL,
	[REMISE] [decimal](19, 2) NULL,
	[POURSENTAGE_REMISE] [float] NULL,
	[COUNT_ARTICLE] [int] NULL,
	[REMARQUE] [nvarchar](max) NULL,
	[ETAT] [nvarchar](50) NULL,
	[ID_USER] [int] NULL,
	[ID_CAISSIER] [int] NULL,
	[cout_of_fctr] [decimal](19, 2) NULL,
	[tmbre] [float] NULL,
	[pricearabe] [decimal](19, 2) NULL,
 CONSTRAINT [PK_TB_FACTURE_VENTE] PRIMARY KEY CLUSTERED 
(
	[NMR_FACTURE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FAVORIS]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FAVORIS](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[FAVOIRE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_FAVORIS] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
	[REMARQUE] [nvarchar](max) NULL,
	[IMAGE] [image] NULL,
 CONSTRAINT [PK_TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_FOURNISSUER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_FOURNISSUER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NAME] [nvarchar](50) NULL,
	[PRENAME] [nvarchar](50) NULL,
	[PHONE] [nvarchar](50) NULL,
	[FAX] [nvarchar](50) NULL,
	[EMAIL] [nvarchar](50) NULL,
	[SOLD_TOTAL] [decimal](19, 2) NULL,
	[SOLD_PAYE] [decimal](19, 2) NULL,
	[SOLD_NON_PAYE] [decimal](19, 2) NULL,
	[ADRESSE] [nvarchar](50) NULL,
	[NIF] [nvarchar](50) NULL,
	[RC] [nvarchar](50) NULL,
	[Nic] [nvarchar](50) NULL,
	[article] [nvarchar](50) NULL,
	[originale_name_prename] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_FOURNISSUER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_GESTION_PRODUIT_FINAUX]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_GESTION_PRODUIT_FINAUX](
	[CODE_BARRE] [nvarchar](50) NOT NULL,
	[DESIGNATION] [nvarchar](100) NULL,
	[QT_PARAMETRAGE] [float] NULL,
	[UNITE] [int] NULL,
	[CATEGORIE] [int] NULL,
	[COUT_DE_PRODUCTION] [decimal](19, 2) NULL,
	[QT_DANS_PACK] [float] NULL,
	[QT_TOTAL] [float] NULL,
	[QT_VENTE] [float] NULL,
	[QT_REST] [float] NULL,
	[QT_DECHET] [float] NULL,
	[PRICE_VENTE_HT] [decimal](19, 2) NULL,
	[PRICE_VENTE_TTC] [decimal](19, 2) NULL,
	[TVA] [float] NULL,
	[PRICE_GROS] [decimal](19, 2) NULL,
	[PRICE_MIN] [decimal](19, 2) NULL,
	[qt_alter] [int] NULL,
	[refereence] [nvarchar](50) NULL,
	[picture] [image] NULL,
 CONSTRAINT [PK_TB_GESTION_PRODUIT_FINAUX] PRIMARY KEY CLUSTERED 
(
	[CODE_BARRE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_CAISSIER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_CAISSIER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_CAISSIE] [int] NULL,
	[DATE] [date] NULL,
	[HEURE_ENTRE] [time](7) NULL,
	[HEURE_SORTIE] [time](7) NULL,
	[PRIX_FOND] [decimal](19, 2) NULL,
	[PRIX_CLOTURE] [decimal](19, 2) NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_CAISSIER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_CLIENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_CLIENT](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [date] NULL,
	[ID_CLIENT] [int] NULL,
	[PRICE] [decimal](19, 2) NULL,
	[CREDIT_OLD] [decimal](19, 2) NULL,
	[CREDIT_NEW] [decimal](19, 2) NULL,
	[REMARQUE] [nvarchar](50) NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
	[total_amounte] [decimal](18, 2) NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_CLIENT] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_COFRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_COFRE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [date] NULL,
	[HEURE] [time](7) NULL,
	[SOLD] [decimal](19, 2) NULL,
	[RAISON] [nvarchar](max) NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_COFRE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_DECHET]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_DECHET](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [date] NULL,
	[TIME] [time](7) NULL,
	[CODE_BARRE] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[LACAUSE] [nvarchar](max) NULL,
	[ID_USER] [int] NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_DECHET] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_DEMONTER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_DEMONTER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [datetime] NULL,
	[QT_BEFOR] [float] NULL,
	[QT_PRODUCTION] [float] NULL,
	[QT_AFTER] [float] NULL,
	[COUT_PRODUCTION] [money] NULL,
	[ID_USER] [int] NULL,
	[ID_PRODUCTION] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_DEMONTER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_FOURNISSEUR]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_FOURNISSEUR](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [date] NULL,
	[ID_CLIENT] [int] NULL,
	[PRICE] [decimal](19, 2) NULL,
	[CREDIT_OLD] [decimal](19, 2) NULL,
	[CREDIT_NEW] [decimal](19, 2) NULL,
	[REMARQUE] [nvarchar](max) NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_FOURNISSEUR] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_PRODUCTION]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_PRODUCTION](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[QT_BEFOR] [float] NULL,
	[QT_PROUDCTION] [float] NULL,
	[QT_AFTER] [float] NULL,
	[COUT_PRODUCTION] [decimal](19, 2) NULL,
	[ID_USER] [int] NULL,
	[ID_PRODUIT] [nvarchar](50) NULL,
	[DATE] [datetime] NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_PRODUCTION] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_HISTORIQUE_SUB_COMMANDE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_HISTORIQUE_SUB_COMMANDE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_HISTORUQE_LIVRAISON] [int] NULL,
	[ID_SUB_COMMANDE] [int] NULL,
	[QUANTITE_LIVRE] [int] NULL,
 CONSTRAINT [PK_TB_HISTORIQUE_SUB_COMMANDE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_INFO_CAISSIER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_INFO_CAISSIER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NAME] [nvarchar](50) NULL,
	[PRENAME] [nvarchar](50) NULL,
	[USER-NAME] [nvarchar](50) NULL,
	[PASSW] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_INFO_CAISSIER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_INFO_DE_LIV]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_INFO_DE_LIV](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [date] NULL,
	[NOM_DE_LIV] [nvarchar](50) NULL,
	[NOM_DE_RECU] [nvarchar](50) NULL,
	[TYPE_DE_LIV] [nvarchar](50) NULL,
	[info_chaufeur] [nvarchar](50) NULL,
	[info_matricule] [nvarchar](50) NULL,
	[id_commande] [nvarchar](50) NULL,
	[PRIC_DE_LIV] [money] NULL,
	[Versement] [money] NULL,
 CONSTRAINT [PK_TB_INFO_DE_LIV] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_INFO_LIVRAISON_TYPE_2]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_INFO_LIVRAISON_TYPE_2](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [date] NULL,
	[HEURE] [time](7) NULL,
	[LIVREURE] [nvarchar](50) NULL,
	[RECEVEUR] [nvarchar](50) NULL,
	[ID_COMMANDE] [nvarchar](50) NULL,
	[VERSEMENT_AVANT] [money] NULL,
	[VERSEMENT_ICI] [money] NULL,
	[TOTAL_LIVRAISON] [float] NULL,
	[LIVRAISON_AVANT] [float] NULL,
	[LIVRAISON_ICI] [float] NULL,
	[CREDIT_AVANT] [money] NULL,
	[CREDIT_AFTER] [money] NULL,
 CONSTRAINT [PK_TB_INFO_LIVRAISON_TYPE_2] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_LIVRAISON_VENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_LIVRAISON_VENTE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [datetime] NULL,
	[SENDER] [nvarchar](50) NULL,
	[RECUPIRATEUR] [nvarchar](50) NULL,
	[TYPE_LIV] [nvarchar](50) NULL,
	[PRICE_LIV] [decimal](19, 2) NULL,
	[INFORMATION_CHAUFEURE] [nvarchar](50) NULL,
	[MATRICULE] [nvarchar](50) NULL,
	[ID_USER] [int] NULL,
	[ID_CAISSIER] [int] NULL,
	[id_Facture] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_LIVRAISON_VENTE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_MARQUE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_MARQUE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[Marque] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_MARQUE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_MATIER_PREMIER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_MATIER_PREMIER](
	[CODEBARRE] [nvarchar](50) NOT NULL,
	[DESIGNATION] [nvarchar](50) NULL,
	[UNITE] [int] NULL,
	[CATEGORIES] [int] NULL,
	[STOCKES] [int] NULL,
	[MARKE] [int] NULL,
	[QUANTITE] [float] NULL,
	[QUANTITE_REST] [float] NULL,
	[QUANTITE_USE] [float] NULL,
	[QUANTITE_PACKES] [float] NULL,
	[PHOTO] [image] NULL,
	[DATE_PREPARATION] [date] NULL,
	[OBSERVATION] [nvarchar](max) NULL,
	[STOCKES_MIN] [int] NULL,
	[PRODUIT_DES_PIECES] [nvarchar](50) NULL,
	[REFERENCE] [nvarchar](50) NULL,
	[PRICE_HT] [decimal](19, 2) NULL,
	[PRICE_TTC] [decimal](19, 2) NULL,
	[TVA] [decimal](19, 2) NULL,
 CONSTRAINT [PK_TB_MATIER_PREMIER] PRIMARY KEY CLUSTERED 
(
	[CODEBARRE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_MATIER_PREMIER_PRODUCTION]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_MATIER_PREMIER_PRODUCTION](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_PRODUIT_FINAUX] [nvarchar](50) NULL,
	[ID_MATIER_PREMIER] [nvarchar](50) NULL,
	[QT] [float] NULL,
	[PRICE_ACHAT] [decimal](19, 2) NULL,
	[PRICE_TTL] [decimal](19, 2) NULL,
	[QT_DECHET] [float] NULL,
	[delte] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_MATIER_PREMIER_PRODUCTION] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_MATIER_PREMIER_PRODUCTION_CAISS]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_MATIER_PREMIER_PRODUCTION_CAISS](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_PRODUIT_FINAUX] [nvarchar](50) NULL,
	[ID_MATIER_PREMIER] [nvarchar](50) NULL,
	[QT] [float] NULL,
	[PRICE_ACHAT] [money] NULL,
	[PRICE_TTL] [money] NULL,
	[QT_DECHET] [float] NULL,
	[delte] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_MATIER_PREMIER_PRODUCTION_CAISS] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_MATIER_USE_SUB_CMND]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_MATIER_USE_SUB_CMND](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_MATIER] [nvarchar](50) NULL,
	[ID_SUB_COMMANDE] [int] NULL,
	[QT] [float] NULL,
	[COUT] [decimal](19, 2) NULL,
	[NAME_MATIER] [nvarchar](50) NULL,
	[QTDECHET] [int] NULL,
 CONSTRAINT [PK_TB_MATIER_USE_SUB_CMND] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_MATIER_USE_SUB_CMND_caise]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_MATIER_USE_SUB_CMND_caise](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_MATIER] [nvarchar](50) NULL,
	[ID_SUB_COMMANDE] [int] NULL,
	[QT] [float] NULL,
	[COUT] [decimal](19, 2) NULL,
	[NAME_MATIER] [nvarchar](50) NULL,
	[QTDECHET] [int] NULL,
	[delte] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_MATIER_USE_SUB_CMND_caise] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_MAX_ADRESS]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_MAX_ADRESS](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[MacAdress] [nvarchar](max) NULL,
	[Serial] [nvarchar](max) NULL,
	[instal_Day] [date] NULL,
 CONSTRAINT [PK_TB_MAX_ADRESS] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_NOTIFICATION]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_NOTIFICATION](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NOTIFICATION] [nvarchar](max) NULL,
 CONSTRAINT [PK_TB_NOTIFICATION] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_OPTION_PRODUIT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_OPTION_PRODUIT](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_PRODUIT] [nvarchar](50) NULL,
	[OPTION] [nvarchar](50) NULL,
	[VALEUR] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_OPTION_PRODUIT] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_OUVERIER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_OUVERIER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NAME] [nvarchar](50) NULL,
	[PRENAME] [nvarchar](50) NULL,
	[FONCTION] [nvarchar](50) NULL,
	[PHONE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_OUVERIER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX](
	[BARCODE_PACK] [nvarchar](50) NOT NULL,
	[DESIGNATION] [nvarchar](50) NULL,
	[ID_PRODUIT_FINAUX] [nvarchar](50) NULL,
	[PRICE_GROS] [decimal](19, 2) NULL,
	[PRICE_DETAILLE] [decimal](19, 2) NULL,
	[PRICE_MIN] [decimal](19, 2) NULL,
	[QT_DISPONIBLE] [float] NULL,
	[picture] [image] NULL,
 CONSTRAINT [PK_TB_PACK_GESTION_PRODUIT_FINAUX] PRIMARY KEY CLUSTERED 
(
	[BARCODE_PACK] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_PACK_PRODUIT_REVENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_PACK_PRODUIT_REVENT](
	[pack_code_barre] [nvarchar](50) NOT NULL,
	[pack_designation] [nvarchar](50) NULL,
	[code_barre_produit] [nvarchar](50) NULL,
	[quantite] [float] NULL,
	[price_unitair] [decimal](19, 2) NULL,
	[photo] [image] NULL,
	[id_favoire] [int] NULL,
	[photo_code_barre] [image] NULL,
 CONSTRAINT [PK_TB_PACK_PRODUIT_REVENT] PRIMARY KEY CLUSTERED 
(
	[pack_code_barre] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_PARAMETRE_INFO]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_PARAMETRE_INFO](
	[NAME] [nvarchar](50) NULL,
	[PRENAME] [nvarchar](50) NULL,
	[ADRESS] [nvarchar](50) NULL,
	[ACTIVITY] [nvarchar](50) NULL,
	[NMR_REGISTRE] [nvarchar](max) NULL,
	[NMR_MATIER] [nvarchar](max) NULL,
	[NMR_JIBAI] [nvarchar](max) NULL,
	[LOGO] [image] NULL,
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[WILAYA] [nvarchar](50) NULL,
	[CompanyName] [nvarchar](50) NULL,
	[Phone] [nvarchar](50) NULL,
	[Message] [nvarchar](max) NULL,
	[PRINT_FACTURE] [nvarchar](50) NULL,
	[PRINT_BON] [nvarchar](50) NULL,
	[PRINT_BON_A4] [nvarchar](50) NULL,
	[DONT_PRINT] [nvarchar](50) NULL,
	[DAY_AVANT_PEREPRTION] [int] NULL,
 CONSTRAINT [PK_TB_PARAMETRE_INFO] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_PRINCIPALE_INVENTAIRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_PRINCIPALE_INVENTAIRE](
	[NMR_INVENTAIR] [nvarchar](50) NOT NULL,
	[DATE] [date] NULL,
	[HEURE] [time](7) NULL,
	[TOTAL_THEORIQUE] [decimal](18, 2) NULL,
	[TOTAL_PHYSIQUE] [decimal](18, 2) NULL,
	[MONTANT_ECART] [decimal](18, 2) NULL,
	[OBSERVATION] [nvarchar](max) NULL,
	[ID_USER] [int] NULL,
 CONSTRAINT [PK_TB_PRINCIPALE_INVENTAIRE] PRIMARY KEY CLUSTERED 
(
	[NMR_INVENTAIR] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_PRINCIPE_FACTURE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_PRINCIPE_FACTURE](
	[NMR_FACTURE] [nvarchar](50) NOT NULL,
	[ID_CLIENT] [int] NULL,
	[DATE] [date] NULL,
	[TOTAL_HT] [decimal](18, 2) NULL,
	[TVA] [float] NULL,
	[TMBRE] [float] NULL,
	[TOTAL_TTC] [decimal](18, 2) NULL,
	[VERSE] [decimal](18, 2) NULL,
	[REST] [decimal](18, 2) NULL,
	[prix_arabe] [nvarchar](150) NULL,
	[ID_USER] [int] NULL,
 CONSTRAINT [PK_TB_PRINCIPE_FACTURE] PRIMARY KEY CLUSTERED 
(
	[NMR_FACTURE] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_PRODUIT_OF_FCTR_VIERGE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_PRODUIT_OF_FCTR_VIERGE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[NAME] [nvarchar](50) NULL,
	[PRIX_UNITE] [decimal](18, 2) NULL,
	[QUANTITE] [int] NULL,
	[TOTAL] [decimal](18, 2) NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_PRODUIT_OF_FCTR_VIERGE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_Produit_revente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_Produit_revente](
	[CodeBarre] [nvarchar](50) NOT NULL,
	[designation] [nvarchar](50) NULL,
	[reference] [nvarchar](50) NULL,
	[id_categories] [int] NULL,
	[id_stocke] [int] NULL,
	[id_marque] [int] NULL,
	[id_unite] [int] NULL,
	[id_taille] [int] NULL,
	[id_color] [int] NULL,
	[id_favoire] [int] NULL,
	[date_expiration] [date] NULL,
	[price_achat_HT] [decimal](18, 2) NULL,
	[price_achat_TTC] [decimal](18, 2) NULL,
	[TVA] [float] NULL,
	[Quantite_TOTAL] [float] NULL,
	[price_vente1] [decimal](18, 2) NULL,
	[price_vente2] [decimal](18, 2) NULL,
	[price_min] [decimal](18, 2) NULL,
	[vente_apres_expiration] [nvarchar](50) NULL,
	[stocke_negatif] [nvarchar](50) NULL,
	[Quantite_vente] [float] NULL,
	[Quantite_rest] [float] NULL,
	[Quantite_dechet] [float] NULL,
	[Photo] [image] NULL,
	[QT_DANS_PACK] [float] NULL,
	[Quantite_alert] [float] NULL,
	[ihtiyaj] [float] NULL,
	[barcodeimage] [image] NULL,
 CONSTRAINT [PK_TB_Produit_revente] PRIMARY KEY CLUSTERED 
(
	[CodeBarre] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_REMARQUE_CLIENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_REMARQUE_CLIENT](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_CLIENT] [int] NULL,
	[REMARQUE_DE_CLIENT] [nvarchar](max) NULL,
 CONSTRAINT [PK_TB_REMARQUE_CLIENT] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_repatation]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_repatation](
	[NMR_OPERATION] [nvarchar](50) NOT NULL,
	[DATE_ENTRE] [date] NULL,
	[TIME] [time](0) NULL,
	[CLIENT] [nvarchar](50) NULL,
	[NMR_TEL_] [nvarchar](50) NULL,
	[PROBLEM] [nvarchar](max) NULL,
	[PRIX] [decimal](18, 2) NULL,
	[DATE_SORTIE] [date] NULL,
	[ETAS] [nvarchar](50) NULL,
	[PICTURE_CODE_BARRE] [image] NULL,
 CONSTRAINT [PK_TB_repatation] PRIMARY KEY CLUSTERED 
(
	[NMR_OPERATION] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_ROUTOUR_PRODUIT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_ROUTOUR_PRODUIT](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CODE_BARRE_PRODUIT] [nvarchar](50) NULL,
	[QT] [float] NULL,
	[ID_CAISSIER] [int] NULL,
	[ID_USER] [int] NULL,
	[DATE] [date] NULL,
	[HEURE] [time](7) NULL,
	[price_U] [decimal](18, 2) NULL,
	[Price_TTl] [decimal](18, 2) NULL,
	[PRice_achat_ttl] [decimal](18, 2) NULL,
PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_STOCK]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_STOCK](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[STOCKE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_STOCK] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[Tb_sub_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Tb_sub_commande](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[id_commande] [int] NULL,
	[sub_name_commande] [nvarchar](50) NULL,
	[Quantite] [int] NULL,
	[prix_unite] [float] NULL,
	[prix_total] [float] NULL,
	[QTE_REST] [int] NULL,
	[QTE_LIVRE] [int] NULL,
 CONSTRAINT [PK_Tb_sub_commande] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_SUM_COMMANDE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_SUM_COMMANDE](
	[ID] [int] NOT NULL,
	[ID_COMMANDE] [nvarchar](50) NULL,
	[SUB_COMMANDE_TITLE] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[PRIX_UNITAIR] [decimal](18, 2) NULL,
	[PRIX_TOTAL] [decimal](18, 2) NULL,
	[QTE_REST] [int] NULL,
	[QT_LIVRE] [int] NULL,
	[price_cout] [decimal](18, 2) NULL,
 CONSTRAINT [PK_TB_SUM_COMMANDE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_SUM_COMMANDE_caise]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_SUM_COMMANDE_caise](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_COMMANDE] [nvarchar](50) NULL,
	[SUB_COMMANDE_TITLE] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[PRIX_UNITAIR] [decimal](18, 2) NULL,
	[PRIX_TOTAL] [decimal](18, 2) NULL,
	[QTE_REST] [int] NULL,
	[QT_LIVRE] [int] NULL,
	[price_cout] [decimal](18, 2) NULL,
 CONSTRAINT [PK_TB_SUM_COMMANDE_caise] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_TAILLE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_TAILLE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[TAILLE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_TAILLE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_TOOLS_COMMANDE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_TOOLS_COMMANDE](
	[ID] [int] NOT NULL,
	[TOOLS] [nvarchar](50) NULL,
	[ID_COMMANDE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_TOOLS_COMMANDE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_TOOLS_COMMANDE_caise]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_TOOLS_COMMANDE_caise](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[TOOLS] [nvarchar](50) NULL,
	[ID_COMMANDE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_TOOLS_COMMANDE_caise] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_UNITE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_UNITE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[UNITE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_UNITE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_UPLOAD_FICHIER_FACTURE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_UPLOAD_FICHIER_FACTURE](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
	[REMARQUE] [nvarchar](max) NULL,
	[IMAGE] [image] NULL,
 CONSTRAINT [PK_TB_UPLOAD_FICHIER_FACTURE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_USER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_USER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[ID_OUVERIER] [int] NULL,
	[USERR] [nvarchar](50) NULL,
	[PASS] [nvarchar](50) NULL,
	[ROLE] [nvarchar](50) NULL,
	[ETAS] [nvarchar](50) NULL,
	[Code_Recupiraiton] [nvarchar](50) NULL,
	[Stock] [int] NULL,
	[unite] [int] NULL,
	[categorie] [int] NULL,
	[marque] [int] NULL,
	[favoris] [int] NULL,
	[taille] [int] NULL,
	[color] [int] NULL,
	[fournisseure] [int] NULL,
	[ouverier] [int] NULL,
	[users] [int] NULL,
	[caissier] [int] NULL,
	[client] [int] NULL,
	[historique_client] [int] NULL,
	[remarque] [int] NULL,
	[achat] [int] NULL,
	[facture_achat] [int] NULL,
	[dossier_fctr_achat] [int] NULL,
	[historique_frnsre] [int] NULL,
	[stock_produit] [int] NULL,
	[pack] [int] NULL,
	[facture_vente] [int] NULL,
	[list_vente] [int] NULL,
	[liv] [int] NULL,
	[POS] [int] NULL,
	[les_charge] [int] NULL,
	[lapie] [int] NULL,
	[transition_caissier] [int] NULL,
	[state_total] [int] NULL,
	[benifice] [int] NULL,
	[serverss] [int] NULL,
	[facture_info] [int] NULL,
 CONSTRAINT [PK_TB_USER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_VENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_VENTE](
	[CODE_BARRE_PRODUIT] [nvarchar](50) NULL,
	[QUANTITE_VENTE] [float] NULL,
	[PRIX_VENTE] [decimal](18, 2) NULL,
	[PRIX_TOTAL] [decimal](18, 2) NULL,
	[ID_FACTURE] [nvarchar](50) NULL,
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[cout] [money] NULL,
	[typee] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_VENTE] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_VENTE_]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_VENTE_](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[CODEBARRE] [nvarchar](50) NULL,
	[DESIGNATION] [nvarchar](50) NULL,
	[QUANTITE] [float] NULL,
	[PRICE_U] [decimal](18, 2) NULL,
	[PRICE_TTL] [decimal](18, 2) NULL,
	[TYPE] [nvarchar](50) NULL,
 CONSTRAINT [PK_TB_VENTE_] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]

GO
/****** Object:  Table [dbo].[TB_VERSEMNT_OUVERIER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TB_VERSEMNT_OUVERIER](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DATE] [datetime] NULL,
	[ID_OUVERIER] [int] NULL,
	[PRICE_PAYER] [money] NULL,
	[REMARQUE] [nvarchar](max) NULL,
	[User_I] [int] NULL,
 CONSTRAINT [PK_TB_VERSEMNT_OUVERIER] PRIMARY KEY CLUSTERED 
(
	[ID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]

GO
ALTER TABLE [dbo].[TB_ACHAT]  WITH CHECK ADD  CONSTRAINT [FK_TB_ACHAT_TB_FACTURE_ACHAT] FOREIGN KEY([ID_FACTURE])
REFERENCES [dbo].[TB_FACTURE_ACHAT] ([NMR_FCTR])
GO
ALTER TABLE [dbo].[TB_ACHAT] CHECK CONSTRAINT [FK_TB_ACHAT_TB_FACTURE_ACHAT]
GO
ALTER TABLE [dbo].[TB_ACHAT]  WITH CHECK ADD  CONSTRAINT [FK_TB_ACHAT_TB_MATIER_PREMIER] FOREIGN KEY([ID_PRODUIT])
REFERENCES [dbo].[TB_MATIER_PREMIER] ([CODEBARRE])
GO
ALTER TABLE [dbo].[TB_ACHAT] CHECK CONSTRAINT [FK_TB_ACHAT_TB_MATIER_PREMIER]
GO
ALTER TABLE [dbo].[TB_ACHAT_PRODUIT_REVENT]  WITH CHECK ADD  CONSTRAINT [FK_TB_ACHAT_PRODUIT_REVENT_TB_FACTURE_ACHAT_PRODUIT_REVENT] FOREIGN KEY([ID_FACTURE])
REFERENCES [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT] ([NMR_FCTR])
GO
ALTER TABLE [dbo].[TB_ACHAT_PRODUIT_REVENT] CHECK CONSTRAINT [FK_TB_ACHAT_PRODUIT_REVENT_TB_FACTURE_ACHAT_PRODUIT_REVENT]
GO
ALTER TABLE [dbo].[TB_ACHAT_PRODUIT_REVENT]  WITH CHECK ADD  CONSTRAINT [FK_TB_ACHAT_PRODUIT_REVENT_TB_Produit_revente] FOREIGN KEY([CODE_PRODUIT])
REFERENCES [dbo].[TB_Produit_revente] ([CodeBarre])
GO
ALTER TABLE [dbo].[TB_ACHAT_PRODUIT_REVENT] CHECK CONSTRAINT [FK_TB_ACHAT_PRODUIT_REVENT_TB_Produit_revente]
GO
ALTER TABLE [dbo].[TB_CODE_BARRE_RESERVE]  WITH CHECK ADD  CONSTRAINT [FK_TB_CODE_BARRE_RESERVE_TB_Produit_revente] FOREIGN KEY([code_barre_produit])
REFERENCES [dbo].[TB_Produit_revente] ([CodeBarre])
GO
ALTER TABLE [dbo].[TB_CODE_BARRE_RESERVE] CHECK CONSTRAINT [FK_TB_CODE_BARRE_RESERVE_TB_Produit_revente]
GO
ALTER TABLE [dbo].[TB_COMMANDE]  WITH CHECK ADD  CONSTRAINT [FK_TB_COMMANDE_TB_CLIENT] FOREIGN KEY([ID_CLIENT])
REFERENCES [dbo].[TB_CLIENT] ([ID])
GO
ALTER TABLE [dbo].[TB_COMMANDE] CHECK CONSTRAINT [FK_TB_COMMANDE_TB_CLIENT]
GO
ALTER TABLE [dbo].[TB_FACTURE_ACHAT]  WITH CHECK ADD  CONSTRAINT [FK_TB_FACTURE_ACHAT_TB_FOURNISSUER] FOREIGN KEY([ID_FRNSR])
REFERENCES [dbo].[TB_FOURNISSUER] ([ID])
GO
ALTER TABLE [dbo].[TB_FACTURE_ACHAT] CHECK CONSTRAINT [FK_TB_FACTURE_ACHAT_TB_FOURNISSUER]
GO
ALTER TABLE [dbo].[TB_FACTURE_ACHAT]  WITH CHECK ADD  CONSTRAINT [FK_TB_FACTURE_ACHAT_TB_USER] FOREIGN KEY([ID_USER])
REFERENCES [dbo].[TB_USER] ([ID])
GO
ALTER TABLE [dbo].[TB_FACTURE_ACHAT] CHECK CONSTRAINT [FK_TB_FACTURE_ACHAT_TB_USER]
GO
ALTER TABLE [dbo].[TB_FACTURE_VENTE]  WITH CHECK ADD  CONSTRAINT [FK_TB_FACTURE_VENTE_TB_CLIENT] FOREIGN KEY([ID_CLIENT])
REFERENCES [dbo].[TB_CLIENT] ([ID])
GO
ALTER TABLE [dbo].[TB_FACTURE_VENTE] CHECK CONSTRAINT [FK_TB_FACTURE_VENTE_TB_CLIENT]
GO
ALTER TABLE [dbo].[TB_FACTURE_VENTE]  WITH CHECK ADD  CONSTRAINT [FK_TB_FACTURE_VENTE_TB_INFO_CAISSIER] FOREIGN KEY([ID_CAISSIER])
REFERENCES [dbo].[TB_INFO_CAISSIER] ([ID])
GO
ALTER TABLE [dbo].[TB_FACTURE_VENTE] CHECK CONSTRAINT [FK_TB_FACTURE_VENTE_TB_INFO_CAISSIER]
GO
ALTER TABLE [dbo].[TB_FACTURE_VENTE]  WITH CHECK ADD  CONSTRAINT [FK_TB_FACTURE_VENTE_TB_USER] FOREIGN KEY([ID_USER])
REFERENCES [dbo].[TB_USER] ([ID])
GO
ALTER TABLE [dbo].[TB_FACTURE_VENTE] CHECK CONSTRAINT [FK_TB_FACTURE_VENTE_TB_USER]
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_CAISSIER]  WITH CHECK ADD  CONSTRAINT [FK_TB_HISTORIQUE_CAISSIER_TB_INFO_CAISSIER] FOREIGN KEY([ID_CAISSIE])
REFERENCES [dbo].[TB_INFO_CAISSIER] ([ID])
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_CAISSIER] CHECK CONSTRAINT [FK_TB_HISTORIQUE_CAISSIER_TB_INFO_CAISSIER]
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_FOURNISSEUR]  WITH CHECK ADD  CONSTRAINT [FK_TB_HISTORIQUE_FOURNISSEUR_TB_FOURNISSUER] FOREIGN KEY([ID_CLIENT])
REFERENCES [dbo].[TB_FOURNISSUER] ([ID])
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_FOURNISSEUR] CHECK CONSTRAINT [FK_TB_HISTORIQUE_FOURNISSEUR_TB_FOURNISSUER]
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_SUB_COMMANDE]  WITH CHECK ADD  CONSTRAINT [FK_TB_HISTORIQUE_SUB_COMMANDE_TB_INFO_DE_LIV] FOREIGN KEY([ID_HISTORUQE_LIVRAISON])
REFERENCES [dbo].[TB_INFO_DE_LIV] ([ID])
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_SUB_COMMANDE] CHECK CONSTRAINT [FK_TB_HISTORIQUE_SUB_COMMANDE_TB_INFO_DE_LIV]
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_SUB_COMMANDE]  WITH CHECK ADD  CONSTRAINT [FK_TB_HISTORIQUE_SUB_COMMANDE_TB_SUM_COMMANDE] FOREIGN KEY([ID_SUB_COMMANDE])
REFERENCES [dbo].[TB_SUM_COMMANDE] ([ID])
GO
ALTER TABLE [dbo].[TB_HISTORIQUE_SUB_COMMANDE] CHECK CONSTRAINT [FK_TB_HISTORIQUE_SUB_COMMANDE_TB_SUM_COMMANDE]
GO
ALTER TABLE [dbo].[TB_INFO_DE_LIV]  WITH CHECK ADD  CONSTRAINT [FK_TB_INFO_DE_LIV_TB_COMMANDE] FOREIGN KEY([id_commande])
REFERENCES [dbo].[TB_COMMANDE] ([ID])
GO
ALTER TABLE [dbo].[TB_INFO_DE_LIV] CHECK CONSTRAINT [FK_TB_INFO_DE_LIV_TB_COMMANDE]
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER]  WITH CHECK ADD  CONSTRAINT [FK_TB_MATIER_PREMIER_TB_CATEGORIES1] FOREIGN KEY([CATEGORIES])
REFERENCES [dbo].[TB_CATEGORIES] ([ID])
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER] CHECK CONSTRAINT [FK_TB_MATIER_PREMIER_TB_CATEGORIES1]
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER]  WITH CHECK ADD  CONSTRAINT [FK_TB_MATIER_PREMIER_TB_MARQUE1] FOREIGN KEY([MARKE])
REFERENCES [dbo].[TB_MARQUE] ([ID])
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER] CHECK CONSTRAINT [FK_TB_MATIER_PREMIER_TB_MARQUE1]
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER]  WITH CHECK ADD  CONSTRAINT [FK_TB_MATIER_PREMIER_TB_STOCK1] FOREIGN KEY([STOCKES])
REFERENCES [dbo].[TB_STOCK] ([ID])
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER] CHECK CONSTRAINT [FK_TB_MATIER_PREMIER_TB_STOCK1]
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER]  WITH CHECK ADD  CONSTRAINT [FK_TB_MATIER_PREMIER_TB_UNITE1] FOREIGN KEY([UNITE])
REFERENCES [dbo].[TB_UNITE] ([ID])
GO
ALTER TABLE [dbo].[TB_MATIER_PREMIER] CHECK CONSTRAINT [FK_TB_MATIER_PREMIER_TB_UNITE1]
GO
ALTER TABLE [dbo].[TB_OPTION_PRODUIT]  WITH CHECK ADD  CONSTRAINT [FK_TB_OPTION_PRODUIT_TB_MATIER_PREMIER] FOREIGN KEY([ID_PRODUIT])
REFERENCES [dbo].[TB_MATIER_PREMIER] ([CODEBARRE])
GO
ALTER TABLE [dbo].[TB_OPTION_PRODUIT] CHECK CONSTRAINT [FK_TB_OPTION_PRODUIT_TB_MATIER_PREMIER]
GO
ALTER TABLE [dbo].[TB_PACK_PRODUIT_REVENT]  WITH CHECK ADD  CONSTRAINT [FK_TB_PACK_PRODUIT_REVENT_TB_FAVORIS] FOREIGN KEY([id_favoire])
REFERENCES [dbo].[TB_FAVORIS] ([ID])
GO
ALTER TABLE [dbo].[TB_PACK_PRODUIT_REVENT] CHECK CONSTRAINT [FK_TB_PACK_PRODUIT_REVENT_TB_FAVORIS]
GO
ALTER TABLE [dbo].[TB_PACK_PRODUIT_REVENT]  WITH CHECK ADD  CONSTRAINT [FK_TB_PACK_PRODUIT_REVENT_TB_Produit_revente] FOREIGN KEY([code_barre_produit])
REFERENCES [dbo].[TB_Produit_revente] ([CodeBarre])
GO
ALTER TABLE [dbo].[TB_PACK_PRODUIT_REVENT] CHECK CONSTRAINT [FK_TB_PACK_PRODUIT_REVENT_TB_Produit_revente]
GO
ALTER TABLE [dbo].[TB_Produit_revente]  WITH CHECK ADD  CONSTRAINT [FK_TB_Produit_revente_TB_CATEGORIES] FOREIGN KEY([id_categories])
REFERENCES [dbo].[TB_CATEGORIES] ([ID])
GO
ALTER TABLE [dbo].[TB_Produit_revente] CHECK CONSTRAINT [FK_TB_Produit_revente_TB_CATEGORIES]
GO
ALTER TABLE [dbo].[TB_Produit_revente]  WITH CHECK ADD  CONSTRAINT [FK_TB_Produit_revente_TB_COLOR] FOREIGN KEY([id_color])
REFERENCES [dbo].[TB_COLOR] ([ID])
GO
ALTER TABLE [dbo].[TB_Produit_revente] CHECK CONSTRAINT [FK_TB_Produit_revente_TB_COLOR]
GO
ALTER TABLE [dbo].[TB_Produit_revente]  WITH CHECK ADD  CONSTRAINT [FK_TB_Produit_revente_TB_FAVORIS] FOREIGN KEY([id_favoire])
REFERENCES [dbo].[TB_FAVORIS] ([ID])
GO
ALTER TABLE [dbo].[TB_Produit_revente] CHECK CONSTRAINT [FK_TB_Produit_revente_TB_FAVORIS]
GO
ALTER TABLE [dbo].[TB_Produit_revente]  WITH CHECK ADD  CONSTRAINT [FK_TB_Produit_revente_TB_MARQUE] FOREIGN KEY([id_marque])
REFERENCES [dbo].[TB_MARQUE] ([ID])
GO
ALTER TABLE [dbo].[TB_Produit_revente] CHECK CONSTRAINT [FK_TB_Produit_revente_TB_MARQUE]
GO
ALTER TABLE [dbo].[TB_Produit_revente]  WITH CHECK ADD  CONSTRAINT [FK_TB_Produit_revente_TB_STOCK] FOREIGN KEY([id_stocke])
REFERENCES [dbo].[TB_STOCK] ([ID])
GO
ALTER TABLE [dbo].[TB_Produit_revente] CHECK CONSTRAINT [FK_TB_Produit_revente_TB_STOCK]
GO
ALTER TABLE [dbo].[TB_Produit_revente]  WITH CHECK ADD  CONSTRAINT [FK_TB_Produit_revente_TB_TAILLE] FOREIGN KEY([id_taille])
REFERENCES [dbo].[TB_TAILLE] ([ID])
GO
ALTER TABLE [dbo].[TB_Produit_revente] CHECK CONSTRAINT [FK_TB_Produit_revente_TB_TAILLE]
GO
ALTER TABLE [dbo].[TB_Produit_revente]  WITH CHECK ADD  CONSTRAINT [FK_TB_Produit_revente_TB_UNITE] FOREIGN KEY([id_unite])
REFERENCES [dbo].[TB_UNITE] ([ID])
GO
ALTER TABLE [dbo].[TB_Produit_revente] CHECK CONSTRAINT [FK_TB_Produit_revente_TB_UNITE]
GO
ALTER TABLE [dbo].[TB_SUM_COMMANDE]  WITH CHECK ADD  CONSTRAINT [FK_TB_SUM_COMMANDE_TB_COMMANDE] FOREIGN KEY([ID_COMMANDE])
REFERENCES [dbo].[TB_COMMANDE] ([ID])
GO
ALTER TABLE [dbo].[TB_SUM_COMMANDE] CHECK CONSTRAINT [FK_TB_SUM_COMMANDE_TB_COMMANDE]
GO
ALTER TABLE [dbo].[TB_USER]  WITH CHECK ADD  CONSTRAINT [FK_TB_USER_TB_OUVERIER] FOREIGN KEY([ID_OUVERIER])
REFERENCES [dbo].[TB_OUVERIER] ([ID])
GO
ALTER TABLE [dbo].[TB_USER] CHECK CONSTRAINT [FK_TB_USER_TB_OUVERIER]
GO
ALTER TABLE [dbo].[TB_VENTE]  WITH CHECK ADD  CONSTRAINT [FK_TB_VENTE_TB_FACTURE_VENTE] FOREIGN KEY([ID_FACTURE])
REFERENCES [dbo].[TB_FACTURE_VENTE] ([NMR_FACTURE])
ON DELETE CASCADE
GO
ALTER TABLE [dbo].[TB_VENTE] CHECK CONSTRAINT [FK_TB_VENTE_TB_FACTURE_VENTE]
GO
/****** Object:  StoredProcedure [dbo].[add_achat_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[add_achat_produit_revent] 
 @CODE_PRODUIT		nvarchar(50)
,@QUANTITE			float
,@PRICE_ACHAT_HT	money
,@TVA				float
,@PRICE_ACHAT_TTC	money
,@TOTAL_HT			money
,@TOTAL_TTC			money
,@REMARQUE			nvarchar(max)
,@ID_FACTURE		nvarchar(50)
,@QUANTITE_BEFOR	float
,@QUANTITE_AFTER	float
as
INSERT INTO [dbo].[TB_ACHAT_PRODUIT_REVENT]
           ( [CODE_PRODUIT]
           ,[QUANTITE]
           ,[PRICE_ACHAT_HT]
           ,[TVA]
           ,[PRICE_ACHAT_TTC]
           ,[TOTAL_HT]
           ,[TOTAL_TTC]
           ,[REMARQUE]
           ,[ID_FACTURE]
           ,[QUANTITE_BEFOR]
           ,[QUANTITE_AFTER])
     VALUES
           (
		      @CODE_PRODUIT		
			,@QUANTITE			
			,@PRICE_ACHAT_HT	
			,@TVA				
			,@PRICE_ACHAT_TTC	
			,@TOTAL_HT			
			,@TOTAL_TTC			
			,@REMARQUE			
			,@ID_FACTURE		
			,@QUANTITE_BEFOR	
			,@QUANTITE_AFTER	
		   )

















GO
/****** Object:  StoredProcedure [dbo].[add_Client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[add_Client]
@NAME     NVARCHAR(50),
@PRENAME  NVARCHAR(50),
@ADRESSE  NVARCHAR(50),
@PHONE	  NVARCHAR(50),
@FAX	  NVARCHAR(50),
@EMAIL 	  NVARCHAR(50),
@SOLD_TOTAL  	 float,
@SOLD_PAYEE		 float,
@SOLD_NON_PAYES	 float,
@sold_verse float , 
@Max_credit float,
@NIF nvarchar(50),
@Rc nvarchar(50),
@Nic nvarchar(50),
@article nvarchar(50),
@original_name_prename nvarchar(50)
as
INSERT INTO [dbo].[TB_CLIENT]
           (
		    [NAME]
           ,[PRENAME]
		   ,ADRESSE
           ,[PHONE]
           ,[FAX]
           ,[EMAIL]
           ,[SOLD_TOTAL]
           ,[SOLD_PAYE]
           ,[SOLD_NON_PAYE]
           ,Sold_avance 
		   ,MAX_CREDIT
		   ,NIF  
		   ,RC
		   ,Nic
		   ,article  
		   ,originale_name_prename
		   )
     VALUES
           (
		   @NAME     ,
		   @PRENAME  ,
		   @ADRESSE  ,
		   @PHONE	 ,
		   @FAX	  	 ,
		   @EMAIL	 ,
		   @SOLD_TOTAL,
		   @SOLD_PAYEE,
		   @SOLD_NON_PAYES 	,
		   @sold_verse , 
		   @Max_credit,
		   @NIF,
		   @Rc,
		   @Nic,
		   @article,
		   @original_name_prename
		   )
















GO
/****** Object:  StoredProcedure [dbo].[add_fournisseur]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE proc [dbo].[add_fournisseur]
@NAME     NVARCHAR(50),
@PRENAME  NVARCHAR(50),
@ADRESSE  NVARCHAR(50),
@PHONE	  NVARCHAR(50),
@FAX	  NVARCHAR(50),
@EMAIL 	  NVARCHAR(50),
@SOLD_TOTAL  	 float,
@SOLD_PAYEE		 float,
@SOLD_NON_PAYES	 float, 
@NIF nvarchar(50),
@Rc nvarchar(50),
@Nic nvarchar(50),
@article nvarchar(50),
@original_name_prename nvarchar(50)
as
INSERT INTO [dbo].TB_FOURNISSUER
           (
		    [NAME]
           ,[PRENAME]
		   ,ADRESSE
           ,[PHONE]
           ,[FAX]
           ,[EMAIL]
           ,[SOLD_TOTAL]
           ,[SOLD_PAYE]
           ,[SOLD_NON_PAYE] 
		   ,NIF  
		   ,RC
		   ,Nic
		   ,article  
		   ,originale_name_prename
		   )
     VALUES
           (
		   @NAME     ,
		   @PRENAME  ,
		   @ADRESSE  ,
		   @PHONE	 ,
		   @FAX	  	 ,
		   @EMAIL	 ,
		   @SOLD_TOTAL,
		   @SOLD_PAYEE,
		   @SOLD_NON_PAYES 	, 
		   @NIF,
		   @Rc,
		   @Nic,
		   @article,
		   @original_name_prename
		   )
















GO
/****** Object:  StoredProcedure [dbo].[add_gestion_produit_finaux]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[add_gestion_produit_finaux]
 @CODE_BARRE			nvarchar(50)
,@DESIGNATION			nvarchar(100)
,@QT_PARAMETRAGE		float
,@UNITE					int
,@CATEGORIE				int
,@COUT_DE_PRODUCTION	money
,@QT_DANS_PACK			int
,@QT_TOTAL				int
,@QT_VENTE				int
,@QT_REST				int
,@QT_DECHET				int
,@PRICE_VENTE_HT		money
,@PRICE_VENTE_TTC		money
,@TVA					float
,@PRICE_GROS			money
,@PRICE_MIN				money
,@qt_alter				int
as
INSERT INTO [dbo].[TB_GESTION_PRODUIT_FINAUX]
           ([CODE_BARRE]
           ,[DESIGNATION]
           ,[QT_PARAMETRAGE]
           ,[UNITE]
           ,[CATEGORIE]
           ,[COUT_DE_PRODUCTION]
           ,[QT_DANS_PACK]
           ,[QT_TOTAL]
           ,[QT_VENTE]
           ,[QT_REST]
           ,[QT_DECHET]
           ,[PRICE_VENTE_HT]
           ,[PRICE_VENTE_TTC]
           ,[TVA]
           ,[PRICE_GROS]
           ,[PRICE_MIN]
		   ,qt_alter)
     VALUES
           (
		     @CODE_BARRE			
			,@DESIGNATION			
			,@QT_PARAMETRAGE		
			,@UNITE					
			,@CATEGORIE				
			,@COUT_DE_PRODUCTION	
			,@QT_DANS_PACK			
			,@QT_TOTAL				
			,@QT_VENTE				
			,@QT_REST				
			,@QT_DECHET				
			,@PRICE_VENTE_HT		
			,@PRICE_VENTE_TTC		
			,@TVA					
			,@PRICE_GROS			
			,@PRICE_MIN	
			,@qt_alter			
		   )

















GO
/****** Object:  StoredProcedure [dbo].[add_new_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[add_new_commande]
 @ID				nvarchar(50)
,@DATE				date
,@NOM_COMMANDE		nvarchar(50)
,@ID_CLIENT			int
,@TYPE_COMMANDE		nvarchar(50)
,@COUT_TOTAL		money
,@VERSEMENT			money
,@QTE				int
,@REMARQUE			nvarchar(max)
,@PRICE_TOTAL_HT	money
,@PRICE_TOTAL_TTC	money
,@TVA				float
,@deadline_Date		date
,@etas				nvarchar(50)
,@id_user			int
,@TMBER				float
,@PRICE_ARAB		nvarchar(50)
,@historique_Money  money
,@new_money			money
,@Price_en_francais nvarchar(100)
as
INSERT INTO [dbo].[TB_COMMANDE]
           ([ID]
           ,[DATE]
           ,[NOM_COMMANDE]
           ,[ID_CLIENT]
           ,[TYPE_COMMANDE]
           ,[COUT_TOTAL]
           ,[VERSEMENT]
           ,[QTE]
           ,[REMARQUE]
           ,[PRICE_TOTAL_HT]
           ,[PRICE_TOTAL_TTC]
           ,[TVA]
           ,[deadline_Date]
           ,[etas]
		   ,id_user
		   ,TMBER
		   ,PRICE_ARAB
		   ,historique_Money
		   ,new_money
		   ,Price_en_francais
		   )
     VALUES
           (
		    @ID				
		   ,@DATE				
		   ,@NOM_COMMANDE		
		   ,@ID_CLIENT			
		   ,@TYPE_COMMANDE		
		   ,@COUT_TOTAL		
		   ,@VERSEMENT			
		   ,@QTE				
		   ,@REMARQUE			
		   ,@PRICE_TOTAL_HT	
		   ,@PRICE_TOTAL_TTC	
		   ,@TVA				
		   ,@deadline_Date		
		   ,@etas	
		   ,@id_user				
		   ,@TMBER		
		   ,@PRICE_ARAB
		   ,@historique_Money 
		   ,@new_money		
		   ,@Price_en_francais	
		   )
















GO
/****** Object:  StoredProcedure [dbo].[ADD_ON_CAISSE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[ADD_ON_CAISSE]
@ID_PRODUIT			nvarchar(50)
,@QUANTITE			float
,@QUANTITE_AFTER	float
,@PRIX_ACHAT_HT		money
,@TVA				float
,@PRIX_ACHAT_TTC	money
,@TOTAL_HT			money
,@TOTAL_TTC			money
,@REMARQUE			nvarchar(50)
,@ID_FACTURE		nvarchar(50)
,@Type_achat		nvarchar(50)
AS
INSERT INTO [dbo].[TB_ACHAT_CAISSE]
           ([ID_PRODUIT]
           ,[QUANTITE]
           ,[QUANTITE_AFTER]
           ,[PRIX_ACHAT_HT]
           ,[TVA]
           ,[PRIX_ACHAT_TTC]
           ,[TOTAL_HT]
           ,[TOTAL_TTC]
           ,[REMARQUE]
           ,[ID_FACTURE]
		   ,TYPE_achat)
     VALUES
           (
		     @ID_PRODUIT			
			,@QUANTITE			
			,@QUANTITE_AFTER	
			,@PRIX_ACHAT_HT		
			,@TVA				
			,@PRIX_ACHAT_TTC	
			,@TOTAL_HT			
			,@TOTAL_TTC			
			,@REMARQUE			
			,@ID_FACTURE	
			,@Type_achat	
		   )

















GO
/****** Object:  StoredProcedure [dbo].[add_ouverier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[add_ouverier]
 @NAME		nvarchar(50) 
,@PRENAME	nvarchar(50) 
,@FONCTION	nvarchar(50) 
,@PHONE		nvarchar(50) 		   
as
INSERT INTO [dbo].[TB_OUVERIER]
           ([NAME]
           ,[PRENAME]
           ,[FONCTION]
           ,[PHONE])
     VALUES
           (
			 @NAME		 
			,@PRENAME	 
			,@FONCTION	 
			,@PHONE		 
		   )			 

















GO
/****** Object:  StoredProcedure [dbo].[add_picture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 create proc [dbo].[add_picture]
 @codeBarre nvarchar(50)
,@Photo     image
 as
UPDATE [dbo].[TB_Produit_revente]
   SET  [barcodeimage] = @Photo
 WHERE  CodeBarre = @codeBarre









GO
/****** Object:  StoredProcedure [dbo].[add_prduit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[add_prduit_revent]
 @CodeBarre					nvarchar(50)
,@designation				nvarchar(50)
,@reference					nvarchar(50)
,@id_categories				int
,@id_stocke					int
,@id_marque					int
,@id_unite					int
,@id_taille					int
,@id_color					int
,@id_favoire				int
,@date_expiration			date
,@price_achat_HT			money
,@price_achat_TTC			money
,@TVA						float
,@Quantite_TOTAL			float 
,@price_vente1				money
,@price_vente2				money
,@price_min					money
,@vente_apres_expiration	nvarchar(50)
,@stocke_negatif			nvarchar(50)
,@Quantite_vente			float
,@Quantite_rest				float
,@Quantite_dechet			float
,@Photo						image
,@QT_DANS_PACK				float
,@Quantite_alert			float
,@ihtiyaj					float
as
INSERT INTO [dbo].[TB_Produit_revente]
           ([CodeBarre]
           ,[designation]
           ,[reference]
           ,[id_categories]
           ,[id_stocke]
           ,[id_marque]
           ,[id_unite]
           ,[id_taille]
           ,[id_color]
           ,[id_favoire]
           ,[date_expiration]
           ,[price_achat_HT]
           ,[price_achat_TTC]
           ,[TVA]
           ,[Quantite_TOTAL] 
           ,[price_vente1]
           ,[price_vente2]
           ,[price_min]
           ,[vente_apres_expiration]
           ,[stocke_negatif]
           ,[Quantite_vente]
           ,[Quantite_rest]
           ,[Quantite_dechet]
           ,[Photo]
           ,[QT_DANS_PACK]
		   ,Quantite_alert
		   ,ihtiyaj
		   )
     VALUES
           (
		     @CodeBarre					
			,@designation				
			,@reference					
			,@id_categories				
			,@id_stocke					
			,@id_marque					
			,@id_unite					
			,@id_taille					
			,@id_color					
			,@id_favoire				
			,@date_expiration			
			,@price_achat_HT			
			,@price_achat_TTC			
			,@TVA						
			,@Quantite_TOTAL 			
			,@price_vente1				
			,@price_vente2				
			,@price_min					
			,@vente_apres_expiration	
			,@stocke_negatif			
			,@Quantite_vente			
			,@Quantite_rest				
			,@Quantite_dechet			
			,@Photo						
			,@QT_DANS_PACK		
			,@Quantite_alert	
			,@ihtiyaj	
		   )

















GO
/****** Object:  StoredProcedure [dbo].[add_produit_on_principe_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[add_produit_on_principe_facture]
 @NAME			nvarchar(50) 
,@PRIX_UNITE	MONEY		 
,@QUANTITE		float		 
,@TOTAL			MONEY		 
,@ID_FACTURE	nvarchar(50) 
as
INSERT INTO [dbo].[TB_PRODUIT_OF_FCTR_VIERGE]
           ([NAME]
           ,[PRIX_UNITE]
           ,[QUANTITE]
           ,[TOTAL]
           ,[ID_FACTURE])
     VALUES
           (
		    @NAME			
		   ,@PRIX_UNITE	
		   ,@QUANTITE		
		   ,@TOTAL			
		   ,@ID_FACTURE	
		   ) 


















GO
/****** Object:  StoredProcedure [dbo].[ADD_QT_REST]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
   
--+++++++++++++++++++++++++++++++++++++
create PROC [dbo].[ADD_QT_REST]
@CODEBARRE NVARCHAR(50),
@QUANTITE FLOAT
AS 
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke]
      ,[id_marque] = [id_marque]
      ,[id_unite] = [id_unite]
      ,[id_taille] = [id_taille]
      ,[id_color] = [id_color]
      ,[id_favoire] = [id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT] = [price_achat_HT]
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL]+@QUANTITE
      ,[price_vente1] = [price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] =[price_min]
      ,[vente_apres_expiration] = [vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] = [Quantite_vente]
      ,[Quantite_rest] = [Quantite_rest] + @QUANTITE
      ,[Quantite_dechet] = [Quantite_dechet]
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
      ,[Quantite_alert] = [Quantite_alert]
      ,[ihtiyaj] = [ihtiyaj]
 WHERE [CodeBarre] = @CODEBARRE
--+++++++++++++++++++++++++++++++++++++++++++++++++












GO
/****** Object:  StoredProcedure [dbo].[ADD_QUANTITE_DECHET]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
   
  
--++++++++++++++++++++++++++++++++++++++++++

create PROC [dbo].[ADD_QUANTITE_DECHET]
@CODE_BARRE NVARCHAR(50) ,
@QUANTITE FLOAT
AS
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke]
      ,[id_marque] = [id_marque]
      ,[id_unite] = [id_unite]
      ,[id_taille] = [id_taille]
      ,[id_color] = [id_color]
      ,[id_favoire] = [id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT] = [price_achat_HT]
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL]
      ,[price_vente1] = [price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] =[price_min]
      ,[vente_apres_expiration] = [vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] = [Quantite_vente]
      ,[Quantite_rest] = [Quantite_rest] - @QUANTITE
      ,[Quantite_dechet] = [Quantite_dechet]+ @QUANTITE
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
      ,[Quantite_alert] = [Quantite_alert]
      ,[ihtiyaj] = [ihtiyaj]
 WHERE [CodeBarre] = @CODE_BARRE












GO
/****** Object:  StoredProcedure [dbo].[ADD_QUANTITE_DECHET_HISTORIQUE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
   
 
--++++++++++++++++++++++++++++++++
create PROC [dbo].[ADD_QUANTITE_DECHET_HISTORIQUE]
 @DATE			date
,@TIME			time(7)
,@CODE_BARRE	nvarchar(50)
,@QUANTITE		float
,@LACAUSE		nvarchar(max)
,@ID_USER		int
AS
INSERT INTO [dbo].[TB_HISTORIQUE_DECHET]
           ([DATE]
           ,[TIME]
           ,[CODE_BARRE]
           ,[QUANTITE]
           ,[LACAUSE]
           ,[ID_USER])
     VALUES
           (
		     @DATE			
			,@TIME			
			,@CODE_BARRE	
			,@QUANTITE		
			,@LACAUSE		
			,@ID_USER		
		   )












GO
/****** Object:  StoredProcedure [dbo].[add_reparation]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[add_reparation]
    @NMR_OPERATION NVARCHAR(50),
    @DATE_ENTRE DATE,
    @TIME TIME(0),
    @CLIENT NVARCHAR(50),
    @NMR_TEL NVARCHAR(50),
    @PROBLEM NVARCHAR(MAX),
    @PRIX DECIMAL(18,2), 
    @ETAS NVARCHAR(50),
    @PICTURE_CODE_BARRE IMAGE
AS
BEGIN
    SET NOCOUNT ON;

    INSERT INTO [dbo].[TB_repatation] 
        ([NMR_OPERATION], [DATE_ENTRE], [TIME], [CLIENT], [NMR_TEL_], 
         [PROBLEM], [PRIX], [ETAS], [PICTURE_CODE_BARRE])
    VALUES 
        (@NMR_OPERATION, @DATE_ENTRE, @TIME, @CLIENT, @NMR_TEL, 
         @PROBLEM, @PRIX, @ETAS, @PICTURE_CODE_BARRE);
END;


GO
/****** Object:  StoredProcedure [dbo].[add_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[add_stock]
@STOCK nvarchar(50)
as 
INSERT INTO [dbo].[TB_STOCK]
           ([STOCKE])
     VALUES
           (@STOCK)

















GO
/****** Object:  StoredProcedure [dbo].[add_sub_commande_caise]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[add_sub_commande_caise]
@ID_COMMANDE		 nvarchar(50)
,@SUB_COMMANDE_TITLE nvarchar(50)
,@QUANTITE			 float
,@PRIX_UNITAIR		 money
,@PRIX_TOTAL		 money
,@QTE_REST			 float
,@QT_LIVRE			 float
,@price_cout		 money
as
INSERT INTO [dbo].[TB_SUM_COMMANDE_caise]
           ([ID_COMMANDE]
           ,[SUB_COMMANDE_TITLE]
           ,[QUANTITE]
           ,[PRIX_UNITAIR]
           ,[PRIX_TOTAL]
           ,[QTE_REST]
           ,[QT_LIVRE]
           ,[price_cout])
     VALUES
           (
		    @ID_COMMANDE		
			,@SUB_COMMANDE_TITLE
			,@QUANTITE			
			,@PRIX_UNITAIR		
			,@PRIX_TOTAL		
			,@QTE_REST			
			,@QT_LIVRE			
			,@price_cout		
		   )

















GO
/****** Object:  StoredProcedure [dbo].[add_tb_remarque_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[add_tb_remarque_client]
@ID_CLIENT			int
,@REMARQUE_DE_CLIENT nvarchar(max)
as
INSERT INTO [dbo].[TB_REMARQUE_CLIENT]
           ([ID_CLIENT]
           ,[REMARQUE_DE_CLIENT])
     VALUES
           (
		    @ID_CLIENT			
		   ,@REMARQUE_DE_CLIENT
		   )

















GO
/****** Object:  StoredProcedure [dbo].[add_tools_caisse_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[add_tools_caisse_commande]
 @TOOLS			nvarchar(50)
,@ID_COMMANDE    nvarchar(50)
as
INSERT INTO [dbo].[TB_TOOLS_COMMANDE_caise]
           ([TOOLS]
           ,[ID_COMMANDE])
     VALUES
           (
		     @TOOLS			
			,@ID_COMMANDE 
		   )

















GO
/****** Object:  StoredProcedure [dbo].[addReserveCode_barre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[addReserveCode_barre]
@code_barre_produit  nvarchar(50)
,@code_barre_reserve nvarchar(50)
as
INSERT INTO [dbo].[TB_CODE_BARRE_RESERVE]
           ([code_barre_produit]
           ,[code_barre_reserve])
     VALUES
           (
		   @code_barre_produit  
		   ,@code_barre_reserve 
		   )

















GO
/****** Object:  StoredProcedure [dbo].[archive_Commannde_Client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[archive_Commannde_Client]
@ID_Client int
as
SELECT [TB_SUM_COMMANDE].[ID] 
      ,[SUB_COMMANDE_TITLE]
      ,[QUANTITE]
      ,[PRIX_UNITAIR]
      ,[PRIX_TOTAL]
      ,[QTE_REST]
      ,[QT_LIVRE]
      ,[price_cout]
	  ,TB_COMMANDE.[ID]
	  ,[DATE]
	  ,[NOM_COMMANDE]
	  ,[ID_CLIENT]
	  ,[TYPE_COMMANDE]
	  ,[COUT_TOTAL]
	  ,[VERSEMENT]
	  ,[QTE]
	  ,TB_COMMANDE.[REMARQUE]
	  ,[PRICE_TOTAL_HT]
	  ,[PRICE_TOTAL_TTC]
	  ,[TVA]
	  ,[deadline_Date]
	  ,TB_COMMANDE.[etas] 
	  ,[TMBER]
	  ,[PRICE_ARAB] 
	  ,TB_CLIENT.[NAME]
	  ,TB_CLIENT.[PRENAME]
	  ,TB_CLIENT.[PHONE]
	  ,[FAX]
	  ,[EMAIL]
	  ,[SOLD_TOTAL]
	  ,[SOLD_PAYE]
	  ,[SOLD_NON_PAYE]
	  ,[ADRESSE]
	  ,[Sold_avance]
	  ,[MAX_CREDIT]
	  ,[NIF]
	  ,[RC]
	  ,[Nic]
	  ,[article]
	  ,[originale_name_prename]
	  ,TB_OUVERIER.[NAME]
      ,TB_OUVERIER.[PRENAME]
      ,[FONCTION] 
	  ,TB_COMMANDE.historique_Money
	  ,TB_COMMANDE.new_money
	  ,TB_COMMANDE.Price_en_francais
  FROM [dbo].[TB_SUM_COMMANDE]
  inner join TB_COMMANDE on TB_COMMANDE.ID = TB_SUM_COMMANDE.ID_COMMANDE
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  inner join TB_USER on TB_USER.ID = TB_COMMANDE.id_user
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where TB_COMMANDE.ID_CLIENT = @ID_Client
   

















GO
/****** Object:  StoredProcedure [dbo].[calcel_update_matier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[calcel_update_matier]
@CODEBARRE nvarchar(50)
,@QUANTITE		int
,@QUANTITE_REST	int 
AS 
UPDATE [dbo].[TB_MATIER_PREMIER]
   SET [CODEBARRE] = [CODEBARRE]
      ,[DESIGNATION] = [DESIGNATION]
      ,[UNITE] = [UNITE]
      ,[CATEGORIES] = [CATEGORIES]
      ,[STOCKES] = [STOCKES]
      ,[MARKE] = [MARKE]
      ,[QUANTITE] = [QUANTITE]-@QUANTITE
      ,[QUANTITE_REST] = @QUANTITE_REST
      ,[QUANTITE_USE] = [QUANTITE_USE]
      ,[QUANTITE_PACKES] = [QUANTITE_PACKES]
      ,[PHOTO] = [PHOTO]
      ,[DATE_PREPARATION] = [DATE_PREPARATION]
      ,[OBSERVATION] = [OBSERVATION]
      ,[STOCKES_MIN] = [STOCKES_MIN]
      ,[PRODUIT_DES_PIECES] = [PRODUIT_DES_PIECES]
 WHERE CODEBARRE = @CODEBARRE

















GO
/****** Object:  StoredProcedure [dbo].[calcel_update_matier_revente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[calcel_update_matier_revente]
@CODEBARRE nvarchar(50)
,@QUANTITE		float
,@QUANTITE_REST	float
as
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke] 
      ,[id_marque] = [id_marque] 
      ,[id_unite]   =[id_unite]  
      ,[id_taille] = [id_taille] 
      ,[id_color]  = [id_color]  
      ,[id_favoire] =[id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT]  = [price_achat_HT] 
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL]-@QUANTITE
      ,[price_vente1] = [price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] = [price_min]
      ,[vente_apres_expiration] = [vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] = [Quantite_vente]
      ,[Quantite_rest] = @QUANTITE_REST
      ,[Quantite_dechet] = [Quantite_dechet]
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
 WHERE [CodeBarre]=@CODEBARRE

















GO
/****** Object:  StoredProcedure [dbo].[change_information_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[change_information_produit_revent]
 @CodeBarre			nvarchar(50)
,@designation		nvarchar(50) 
,@reference			nvarchar(50) 
,@id_categories		int 
,@id_stocke			int 
,@id_marque			int 
,@id_unite			int 
,@id_taille			int 
,@id_color			int 
,@id_favoire		int 
,@date_expiration	date 
,@price_vente1		money 
,@price_vente2		money 
,@price_min			money 
,@Photo				image  
,@price_achat_HT			money
,@price_achat_TTC			money
,@TVA						float
,@Quantite_alert			float
,@ihtiyaj					float
as
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] =				[CodeBarre]
      ,[designation] =				@designation	
      ,[reference] =				@reference		
      ,[id_categories] =			@id_categories	
      ,[id_stocke] =				@id_stocke		
      ,[id_marque] =				@id_marque		
      ,[id_unite] =					@id_unite		
      ,[id_taille] =				@id_taille		
      ,[id_color] =					@id_color		
      ,[id_favoire] =				@id_favoire	
      ,[date_expiration] =			@date_expiration
      ,[price_achat_HT] =			@price_achat_HT	 
      ,[price_achat_TTC] =			@price_achat_TTC	 
      ,[TVA] =						@TVA				 
      ,[Quantite_TOTAL] =			[Quantite_TOTAL]
      ,[price_vente1] =				@price_vente1	
      ,[price_vente2] =				@price_vente2	
      ,[price_min] =				@price_min		
      ,[vente_apres_expiration] =	[vente_apres_expiration]
      ,[stocke_negatif] =			[stocke_negatif]
      ,[Quantite_vente] =			[Quantite_vente]
      ,[Quantite_rest] =			[Quantite_rest]
      ,[Quantite_dechet] =			[Quantite_dechet]
      ,[Photo] =					@Photo			
      ,[QT_DANS_PACK] =				[QT_DANS_PACK]
	  ,Quantite_alert =				@Quantite_alert
	  ,ihtiyaj = 					@ihtiyaj		
 WHERE CodeBarre = @CodeBarre
















GO
/****** Object:  StoredProcedure [dbo].[change_information_produit_revent_no_img]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[change_information_produit_revent_no_img]
 @CodeBarre			nvarchar(50)
,@designation		nvarchar(50) 
,@reference			nvarchar(50) 
,@id_categories		int 
,@id_stocke			int 
,@id_marque			int 
,@id_unite			int 
,@id_taille			int 
,@id_color			int 
,@id_favoire		int 
,@date_expiration	date 
,@price_vente1		money 
,@price_vente2		money 
,@price_min			money    
,@price_achat_HT			money
,@price_achat_TTC			money
,@TVA						float
,@Quantite_alert			float
,@ihtiyaj					float
as
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] =				[CodeBarre]
      ,[designation] =				@designation	
      ,[reference] =				@reference		
      ,[id_categories] =			@id_categories	
      ,[id_stocke] =				@id_stocke		
      ,[id_marque] =				@id_marque		
      ,[id_unite] =					@id_unite		
      ,[id_taille] =				@id_taille		
      ,[id_color] =					@id_color		
      ,[id_favoire] =				@id_favoire	
      ,[date_expiration] =			@date_expiration
      ,[price_achat_HT] =			@price_achat_HT	 
      ,[price_achat_TTC] =			@price_achat_TTC	 
      ,[TVA] =						@TVA				 
      ,[Quantite_TOTAL] =			[Quantite_TOTAL]
      ,[price_vente1] =				@price_vente1	
      ,[price_vente2] =				@price_vente2	
      ,[price_min] =				@price_min		
      ,[vente_apres_expiration] =	[vente_apres_expiration]
      ,[stocke_negatif] =			[stocke_negatif]
      ,[Quantite_vente] =			[Quantite_vente]
      ,[Quantite_rest] =			[Quantite_rest]
      ,[Quantite_dechet] =			[Quantite_dechet] 		
      ,[QT_DANS_PACK] =				[QT_DANS_PACK]
	  ,Quantite_alert =				@Quantite_alert
	  ,ihtiyaj = 					@ihtiyaj		
 WHERE CodeBarre = @CodeBarre
















GO
/****** Object:  StoredProcedure [dbo].[check_if_caisse_renter]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[check_if_caisse_renter]
@ID_caisse int,
@DATE	date
as
SELECT [ID]
      ,[ID_CAISSIE]
      ,[DATE]
      ,[HEURE_ENTRE]
      ,[HEURE_SORTIE]
      ,[PRIX_FOND]
      ,[PRIX_CLOTURE]
  FROM [dbo].[TB_HISTORIQUE_CAISSIER]
where ID_CAISSIE  = @ID_caisse and DATE = @DATE 















GO
/****** Object:  StoredProcedure [dbo].[check_if_pack_exite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 create proc [dbo].[check_if_pack_exite]
 @ID_Product nvarchar(50)
 as 
SELECT [pack_code_barre]
      ,[pack_designation]
      ,[code_barre_produit]
      ,[quantite]
      ,[price_unitair]
      ,[photo]
      ,[id_favoire]
  FROM [dbo].[TB_PACK_PRODUIT_REVENT] 
  where [code_barre_produit] = @ID_Product












GO
/****** Object:  StoredProcedure [dbo].[check_produit_if_exist]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[check_produit_if_exist]
@CodeBarre nvarchar(50)
as 
SELECT [CodeBarre]
      ,[designation]
      ,[reference]
      ,[id_categories]
      ,[id_stocke]
      ,[id_marque]
      ,[id_unite]
      ,[id_taille]
      ,[id_color]
      ,[id_favoire]
      ,[date_expiration]
      ,[price_achat_HT]
      ,[price_achat_TTC]
      ,[TVA]
      ,[Quantite_TOTAL]
      ,[price_vente1]
      ,[price_vente2]
      ,[price_min]
      ,[vente_apres_expiration]
      ,[stocke_negatif]
      ,[Quantite_vente]
      ,[Quantite_rest]
      ,[Quantite_dechet]
      ,[Photo]
      ,[QT_DANS_PACK]
      ,[Quantite_alert]
      ,[ihtiyaj]
  FROM [dbo].[TB_Produit_revente]
  where CodeBarre = @CodeBarre














GO
/****** Object:  StoredProcedure [dbo].[CheckAndUpdateProductPack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE PROCEDURE [dbo].[CheckAndUpdateProductPack]
    @CODE_PRODUIT NVARCHAR(50),
    @QUANTITE FLOAT
AS
BEGIN
    -- Check if the product has an associated pack
    IF EXISTS (SELECT 1 FROM [dbo].[TB_PACK_PRODUIT_REVENT] WHERE [code_barre_produit] = @CODE_PRODUIT)
    BEGIN
        -- Update the quantity of the pack by subtracting the quantity times QT_DANS_PACK
        UPDATE PPR
        SET PPR.[quantite] = PPR.[quantite] - (@QUANTITE * PR.[QT_DANS_PACK])
        FROM [dbo].[TB_PACK_PRODUIT_REVENT] PPR
        INNER JOIN [dbo].[TB_Produit_revente] PR ON PPR.[code_barre_produit] = PR.[CodeBarre]
        WHERE PPR.[code_barre_produit] = @CODE_PRODUIT
    END
    ELSE
    BEGIN
        -- If no pack is associated, raise an error or handle accordingly
        RAISERROR('No pack found for the given product code.', 16, 1);
    END
END

















GO
/****** Object:  StoredProcedure [dbo].[clear_vente_where_edit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[clear_vente_where_edit]
@idFctr nvarchar(50)
as
DELETE FROM [dbo].[TB_VENTE]
      WHERE [TB_VENTE].ID_FACTURE = @idFctr

















GO
/****** Object:  StoredProcedure [dbo].[create_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[create_facture] 
 @NMR_FCTR	nvarchar(50)
,@DATE		date
,@ID_FRNSR	int
,@NMBRE_PRODUIT int
,@VERSEMENT money
,@TOTAL		money
,@ID_USER	int
,@total_HT	money
,@Creditprecidenet money
,@creditNew money
as
INSERT INTO [dbo].[TB_FACTURE_ACHAT]
           ([NMR_FCTR]
           ,[DATE]
           ,[ID_FRNSR]
           ,[NMBRE_PRODUIT]
           ,[VERSEMENT]
           ,[TOTAL]
           ,[ID_USER]
           ,[total_HT]
           ,[Creditprecidenet]
           ,[creditNew])
     VALUES
           (
		     @NMR_FCTR	
			,@DATE		
			,@ID_FRNSR
			,@NMBRE_PRODUIT	
			,@VERSEMENT 
			,@TOTAL		
			,@ID_USER	
			,@total_HT	
			,@Creditprecidenet
			,@creditNew
		   )

















GO
/****** Object:  StoredProcedure [dbo].[create_facture_principale]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[create_facture_principale]
 @NMR_FACTURE	  nvarchar(50) 
,@ID_CLIENT		  int			
,@DATE			  date			
,@TOTAL_HT		  money			
,@TVA			  float			
,@TMBRE			  float			
,@TOTAL_TTC		  money			
,@VERSE			  money			
,@REST			  money			
,@ID_USER		  int			
,@prix_on_arabe	  nvarchar(max) 
AS
INSERT INTO [dbo].[TB_PRINCIPE_FACTURE]
           ([NMR_FACTURE]
           ,[ID_CLIENT]
           ,[DATE]
           ,[TOTAL_HT]
           ,[TVA]
           ,[TMBRE]
           ,[TOTAL_TTC]
           ,[VERSE]
           ,[REST]
           ,[prix_arabe]
           ,[ID_USER])  
     VALUES
           (
		    @NMR_FACTURE 
           ,@ID_CLIENT	  
           ,@DATE		  
           ,@TOTAL_HT	  
           ,@TVA		  
           ,@TMBRE		  
           ,@TOTAL_TTC	  
           ,@VERSE		  
           ,@REST	
		   ,@prix_on_arabe 		  
           ,@ID_USER
		   )
















GO
/****** Object:  StoredProcedure [dbo].[delet_from_Caisse_achat_prevent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delet_from_Caisse_achat_prevent]
@ID int
as
DELETE FROM [dbo].TB_ACHAT_PRODUIT_REVENT_CAISSE
      WHERE ID =@ID
















GO
/****** Object:  StoredProcedure [dbo].[delet_pack_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delet_pack_produit_revent]
@id_produit nvarchar(50)
as
DELETE FROM [dbo].[TB_PACK_PRODUIT_REVENT]
      WHERE code_barre_produit = @id_produit




GO
/****** Object:  StoredProcedure [dbo].[delete_all_fav]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delete_all_fav]
@id_fav int
as 
UPDATE [dbo].[TB_Produit_revente]
   SET [id_favoire] = null
 WHERE [id_favoire] =@id_fav










GO
/****** Object:  StoredProcedure [dbo].[delete_all_fav_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delete_all_fav_pack]
@id_fav int
as
UPDATE [dbo].[TB_PACK_PRODUIT_REVENT]
   SET  [id_favoire] = null
 WHERE [id_favoire] =@id_fav






GO
/****** Object:  StoredProcedure [dbo].[delete_by_code_barre_secondaire]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_by_code_barre_secondaire]
@codeSecondaire nvarchar(50) 
as
DELETE FROM [dbo].[TB_CODE_BARRE_RESERVER_PACK]
      WHERE [TB_CODE_BARRE_RESERVER_PACK].[CODE_BARRE_RESERVER] = @codeSecondaire

















GO
/****** Object:  StoredProcedure [dbo].[delete_caisse_tools]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_caisse_tools]
@ID int
as
DELETE FROM [dbo].[TB_TOOLS_COMMANDE_caise]
      WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[delete_cassier_info]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_cassier_info]
@ID			nvarchar(50)
as
DELETE FROM [dbo].[TB_INFO_CAISSIER]
      WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[delete_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_client]
@ID int
as
DELETE from TB_CLIENT 
where ID=@ID
















GO
/****** Object:  StoredProcedure [dbo].[delete_color_]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 create proc [dbo].[delete_color_]
 @id int
 as 
DELETE FROM [dbo].[TB_COLOR]
      WHERE TB_COLOR.ID = @id

















GO
/****** Object:  StoredProcedure [dbo].[delete_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[delete_commande]
@ID nvarchar(50)
as
DELETE FROM [dbo].[TB_COMMANDE]
      WHERE ID = @ID















GO
/****** Object:  StoredProcedure [dbo].[DELETE_FACTURE_VENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[DELETE_FACTURE_VENTE]
@ID_FACTURE NVARCHAR(50)
AS
DELETE FROM [dbo].TB_FACTURE_VENTE
      WHERE NMR_FACTURE=@ID_FACTURE



GO
/****** Object:  StoredProcedure [dbo].[delete_fct_vente_edit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delete_fct_vente_edit]
@ID_Fctr nvarchar(50) 
as
DELETE FROM [dbo].[TB_FACTURE_VENTE]
      WHERE NMR_FACTURE = @ID_Fctr




GO
/****** Object:  StoredProcedure [dbo].[delete_fctr_vente_product]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delete_fctr_vente_product]
@ID_Fctr nvarchar(50) 
as 
DELETE FROM [dbo].[TB_VENTE]
      WHERE ID_FACTURE = @ID_Fctr




GO
/****** Object:  StoredProcedure [dbo].[delete_frnsr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_frnsr]
@ID int
as
DELETE from TB_FOURNISSUER 
where ID=@ID
















GO
/****** Object:  StoredProcedure [dbo].[delete_from_caisse_achat]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_from_caisse_achat]
@ID int
as
DELETE FROM [dbo].[TB_ACHAT_CAISSE]
      WHERE ID =@ID

















GO
/****** Object:  StoredProcedure [dbo].[DELETE_FROM_STOCK]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[DELETE_FROM_STOCK]
@CodeBarre INT
AS
DELETE FROM [dbo].[TB_Produit_revente]
      WHERE CodeBarre =@CodeBarre














GO
/****** Object:  StoredProcedure [dbo].[DELETE_HISTORIQUE_CLIENT_BY_ID_FCTR]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[DELETE_HISTORIQUE_CLIENT_BY_ID_FCTR]
@ID_FACTURE NVARCHAR(50),
@remarque nvarchar(50)
AS
DELETE FROM [dbo].[TB_HISTORIQUE_CLIENT]
      WHERE ID_FACTURE = @ID_FACTURE and REMARQUE =@remarque


GO
/****** Object:  StoredProcedure [dbo].[delete_just_one_fctr_en_attend]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[delete_just_one_fctr_en_attend]
@CodeBarre nvarchar(50) 
as 
DELETE FROM [dbo].[TB_VENTE]
      WHERE CODE_BARRE_PRODUIT = @CodeBarre



GO
/****** Object:  StoredProcedure [dbo].[DELETE_LIST_VENTE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROC [dbo].[DELETE_LIST_VENTE]
@ID_FACTURE NVARCHAR(50)
AS 
DELETE FROM [dbo].[TB_VENTE]
      WHERE ID_FACTURE = @ID_FACTURE



GO
/****** Object:  StoredProcedure [dbo].[delete_matier_premier_caisse_production]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_matier_premier_caisse_production]
@id int
as
DELETE FROM [dbo].[TB_MATIER_PREMIER_PRODUCTION_CAISS]
      WHERE ID = @id

















GO
/****** Object:  StoredProcedure [dbo].[delete_one_from_tb_reserve_code]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[delete_one_from_tb_reserve_code]
@code_secodaire int
as
delete 
  FROM [dbo].[TB_CODE_BARRE_RESERVE]
  where id = @code_secodaire

















GO
/****** Object:  StoredProcedure [dbo].[delete_prin_fctr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[delete_prin_fctr]
@id_fctr nvarchar(50)
as
DELETE FROM [dbo].[TB_PRINCIPE_FACTURE]
      WHERE NMR_FACTURE=@id_fctr
	  
DELETE FROM [dbo].[TB_PRODUIT_OF_FCTR_VIERGE]
	  WHERE ID_FACTURE=@id_fctr

















GO
/****** Object:  StoredProcedure [dbo].[delete_product_new]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_product_new] 
@barCode nvarchar(50)
as
DELETE FROM [dbo].[TB_MATIER_PREMIER]
      WHERE CODEBARRE = @barCode

















GO
/****** Object:  StoredProcedure [dbo].[delete_produit_revene_caisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_produit_revene_caisse]
@ID int
as
DELETE FROM [dbo].[TB_ACHAT_PRODUIT_REVENT_CAISSE]
      WHERE ID =@ID

















GO
/****** Object:  StoredProcedure [dbo].[delete_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[delete_produit_revent]
@codeBarre nvarchar(50)
as
delete from TB_Produit_revente 
where @codeBarre = CodeBarre
















GO
/****** Object:  StoredProcedure [dbo].[delete_produit_revente_from_list_achat]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[delete_produit_revente_from_list_achat]
@ID int
as
DELETE FROM [dbo].[TB_ACHAT_PRODUIT_REVENT]
      WHERE ID=@ID














GO
/****** Object:  StoredProcedure [dbo].[delete_remarque_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_remarque_client]
@ID int
as 
DELETE FROM [dbo].[TB_REMARQUE_CLIENT]
      WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[delete_sub_comnd]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_sub_comnd]
@ID int
as
DELETE FROM [dbo].[TB_SUM_COMMANDE_caise]
      WHERE ID = @ID
















GO
/****** Object:  StoredProcedure [dbo].[delete_tb_reserve_code]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delete_tb_reserve_code]
@Code_barre_principale nvarchar(50)
as
delete 
  FROM [dbo].[TB_CODE_BARRE_RESERVE]
  where code_barre_produit = @Code_barre_principale

















GO
/****** Object:  StoredProcedure [dbo].[delete_vente_QT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[delete_vente_QT]
@ID int
as
delete from [dbo].[TB_VENTE] 
 WHERE ID=@ID
















GO
/****** Object:  StoredProcedure [dbo].[delte_CATEGORIES]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delte_CATEGORIES]
@ID int 
as
DELETE FROM [dbo].[TB_CATEGORIES]
     WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[delte_depense]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delte_depense]
@ID int
as
DELETE FROM [dbo].[TB_DEPENSE]
      WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[delte_detailles]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[delte_detailles]
@id int
as
DELETE FROM [dbo].[TB_OPTION_PRODUIT]
      WHERE id = @id

















GO
/****** Object:  StoredProcedure [dbo].[delte_matier_for_edit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delte_matier_for_edit]
@id int
as
DELETE FROM [dbo].[TB_MATIER_PREMIER_PRODUCTION]
      WHERE ID =@id

















GO
/****** Object:  StoredProcedure [dbo].[delte_ouverier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROCEDURE [dbo].[delte_ouverier]
    @ID INT
	as
	DELETE FROM [dbo].[TB_VERSEMNT_OUVERIER]
    WHERE [ID] = @ID;

















GO
/****** Object:  StoredProcedure [dbo].[delte_ouverierID]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delte_ouverierID]
 @ID			int
 as
DELETE FROM [dbo].[TB_OUVERIER]
      WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[delte_pack_from_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delte_pack_from_stock]
@codeBarre nvarchar(50)
as 
DELETE FROM [dbo].[TB_PACK_PRODUIT_REVENT]
      WHERE code_barre_produit= @codeBarre 





GO
/****** Object:  StoredProcedure [dbo].[delte_produit_finaux]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delte_produit_finaux]
@codeBarre nvarchar(50),
@Qt_diminuer int
as
UPDATE [dbo].[TB_GESTION_PRODUIT_FINAUX]
   SET [CODE_BARRE] = [CODE_BARRE]
      ,[DESIGNATION] = [DESIGNATION]
      ,[QT_PARAMETRAGE] = [QT_PARAMETRAGE]
      ,[UNITE] = [UNITE]
      ,[CATEGORIE] = [CATEGORIE]
      ,[COUT_DE_PRODUCTION] = [COUT_DE_PRODUCTION]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
      ,[QT_TOTAL] = [QT_TOTAL]
      ,[QT_VENTE] = [QT_VENTE] + @Qt_diminuer
      ,[QT_REST] = [QT_REST] - @Qt_diminuer
      ,[QT_DECHET] = [QT_DECHET]
      ,[PRICE_VENTE_HT] = [PRICE_VENTE_HT]
      ,[PRICE_VENTE_TTC] = [PRICE_VENTE_TTC]
      ,[TVA] = [TVA]
      ,[PRICE_GROS] = [PRICE_GROS]
      ,[PRICE_MIN] = [PRICE_MIN]
      ,[qt_alter] = [qt_alter]
      ,[refereence] = [refereence]
      ,[picture] = [picture]
 WHERE CODE_BARRE = @codeBarre

















GO
/****** Object:  StoredProcedure [dbo].[delte_produit_from_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delte_produit_from_stock]
@codeBarre nvarchar(50)
as
DELETE FROM [dbo].[TB_Produit_revente]
      WHERE CodeBarre = @codeBarre





GO
/****** Object:  StoredProcedure [dbo].[delte_reserve_bc_produit_from_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[delte_reserve_bc_produit_from_stock]
@codeBarre nvarchar(50)
as
DELETE FROM [dbo].[TB_CODE_BARRE_RESERVE]
      WHERE code_barre_produit = @codeBarre





GO
/****** Object:  StoredProcedure [dbo].[delte_reserve_code_bare_pack_from_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[delte_reserve_code_bare_pack_from_stock]
@codeBarre nvarchar(50)
as
DELETE FROM [dbo].[TB_CODE_BARRE_RESERVER_PACK]
      WHERE CODE_BARRE_OFFICIAL = @codeBarre




GO
/****** Object:  StoredProcedure [dbo].[delte_stocke]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delte_stocke]
@ID int
as
DELETE FROM [dbo].[TB_STOCK]
      WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[delte_sub_comd]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[delte_sub_comd]
@ID_Commande nvarchar(50)
as 
DELETE FROM [dbo].[TB_SUM_COMMANDE]
      WHERE  ID_COMMANDE =@ID_Commande















GO
/****** Object:  StoredProcedure [dbo].[delte_taille]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[delte_taille]
@id		int
as
DELETE FROM [dbo].[TB_TAILLE]
      WHERE TB_TAILLE.ID = @id

















GO
/****** Object:  StoredProcedure [dbo].[delte_TB_MARQUE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[delte_TB_MARQUE]
@ID int 
as
DELETE FROM [dbo].TB_MARQUE
     WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[delte_tb_matier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[delte_tb_matier]
@ID int
as
DELETE FROM [dbo].[TB_MATIER_USE_SUB_CMND_caise]
      WHERE ID = @ID
















GO
/****** Object:  StoredProcedure [dbo].[delte_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[delte_unite]
@ID int 
as
DELETE FROM [dbo].[TB_UNITE]
     WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[delte_user]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[delte_user] 
 @id   int as
DELETE FROM [dbo].[TB_USER] WHERE ID = @id

















GO
/****** Object:  StoredProcedure [dbo].[deltee_produit_revent_Qt]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[deltee_produit_revent_Qt]
@Code_Barre_produit nvarchar(50),
@QT					float 
as  
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] =[designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke]
      ,[id_marque] = [id_marque]
      ,[id_unite] = [id_unite]
      ,[id_taille] = [id_taille]
      ,[id_color] = [id_color]
      ,[id_favoire] = [id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT] = [price_achat_HT]
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL]
      ,[price_vente1] = [price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] =[price_min]
      ,[vente_apres_expiration] = [vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] = [Quantite_vente]+@QT
      ,[Quantite_rest] = [Quantite_rest]-@QT
      ,[Quantite_dechet] = [Quantite_dechet]
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
 WHERE CodeBarre = @Code_Barre_produit
















GO
/****** Object:  StoredProcedure [dbo].[deltete_new_revent_product]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[deltete_new_revent_product] 
@barCode nvarchar(50)
as
DELETE FROM [dbo].[TB_Produit_revente]
      WHERE CodeBarre = @barCode
















GO
/****** Object:  StoredProcedure [dbo].[edit_achat]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[edit_achat]
 @ID int 
,@Quantite_deference float
,@Prix_Achat_HT  money
,@Prix_achat_TTC money
,@TVA			money
as
UPDATE [dbo].[TB_ACHAT_PRODUIT_REVENT]
   SET [ID] = [ID]
      ,[CODE_PRODUIT] =[CODE_PRODUIT]
      ,[QUANTITE] =[QUANTITE]+@Quantite_deference
      ,[PRICE_ACHAT_HT] = @Prix_Achat_HT
      ,[TVA] = @TVA
      ,[PRICE_ACHAT_TTC] =	@Prix_achat_TTC
      ,[TOTAL_HT] =			@Prix_Achat_HT *([QUANTITE]+@Quantite_deference)
      ,[TOTAL_TTC] =		@Prix_achat_TTC*([QUANTITE]+@Quantite_deference)
      ,[REMARQUE] =			[REMARQUE] 		
      ,[ID_FACTURE] =		[ID_FACTURE] 	
      ,[QUANTITE_BEFOR] =	[QUANTITE_BEFOR] 
      ,[QUANTITE_AFTER] =	[QUANTITE_AFTER] +@Quantite_deference
 WHERE ID=@ID














GO
/****** Object:  StoredProcedure [dbo].[edit_Article]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[edit_Article]
@CODEBARRE nvarchar(50),
@QT_deference float
as
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke] 
      ,[id_marque] = [id_marque] 
      ,[id_unite]   =[id_unite]  
      ,[id_taille] = [id_taille] 
      ,[id_color]  = [id_color]  
      ,[id_favoire] =[id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT]  = [price_achat_HT] 
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL] +@QT_deference
      ,[price_vente1] = [price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] = [price_min]
      ,[vente_apres_expiration] = [vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] = [Quantite_vente]
      ,[Quantite_rest] = [Quantite_rest] + @QT_deference
      ,[Quantite_dechet] = [Quantite_dechet]
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
 WHERE [CodeBarre]=@CODEBARRE















GO
/****** Object:  StoredProcedure [dbo].[edit_CATEGORIES]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[edit_CATEGORIES]
@ID int ,
@CATEGORIES nvarchar(50)
as
UPDATE [dbo].[TB_CATEGORIES]
   SET [CATEGORIES] = @CATEGORIES
 WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




 
create proc [dbo].[edit_client]
@ID		  int,
@NAME     NVARCHAR(50),
@PRENAME  NVARCHAR(50),
@ADRESSE  NVARCHAR(50),
@PHONE	  NVARCHAR(50),
@FAX	  NVARCHAR(50),
@EMAIL 	  NVARCHAR(50),
@SOLD_TOTAL  	 float,
@SOLD_PAYEE		 float,
@SOLD_NON_PAYES	 float,
@sold_verse float , 
@Max_credit float,
@NIF nvarchar(50),
@Rc nvarchar(50),
@Nic nvarchar(50),
@article nvarchar(50),
@original_name_prename nvarchar(50)
as
UPDATE [dbo].[TB_CLIENT]
   SET [NAME] =          @NAME    		
      ,[PRENAME] =  	 @PRENAME		
      ,[PHONE] =  		 @PHONE			
      ,[FAX] =  		 @FAX			
      ,[EMAIL] =  		 @EMAIL			
      ,[SOLD_TOTAL] =  	 @SOLD_TOTAL		
      ,[SOLD_PAYE] =  	 @SOLD_PAYEE		
      ,[SOLD_NON_PAYE] = @SOLD_NON_PAYES   
      ,[ADRESSE] =  	 @ADRESSE		
	  ,Sold_avance = @sold_verse 
	  ,MAX_CREDIT = @Max_credit
	  ,NIF = @NIF
	  ,RC = @Rc
	  ,Nic = @Nic
	  ,article = @Article
	  ,originale_name_prename = @original_name_prename
 WHERE TB_CLIENT.ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_comd]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[edit_comd]
 @ID				nvarchar(50)
,@DATE				date
,@NOM_COMMANDE		nvarchar(50)
,@ID_CLIENT			int
,@TYPE_COMMANDE		nvarchar(50)
,@COUT_TOTAL		money
,@VERSEMENT			money
,@QTE				float
,@REMARQUE			nvarchar(max)
,@PRICE_TOTAL_HT	money
,@PRICE_TOTAL_TTC	money
,@TVA				float
,@deadline_Date		date
,@etas				nvarchar(50)
,@id_user			int
,@TMBER				float
,@PRICE_ARAB		nvarchar(50)
,@Price_en_francais nvarchar(100)
as
UPDATE [dbo].[TB_COMMANDE]
   SET [ID] = [ID]
      ,[DATE] = @DATE
      ,[NOM_COMMANDE] = @NOM_COMMANDE
      ,[ID_CLIENT] = [ID_CLIENT]
      ,[TYPE_COMMANDE] = @TYPE_COMMANDE
      ,[COUT_TOTAL] = @COUT_TOTAL
      ,[VERSEMENT] = @VERSEMENT
      ,[QTE] = @QTE
      ,[REMARQUE] = @REMARQUE
      ,[PRICE_TOTAL_HT] = @PRICE_TOTAL_HT
      ,[PRICE_TOTAL_TTC] = @PRICE_TOTAL_TTC
      ,[TVA] = @TVA
      ,[deadline_Date] = @deadline_Date
      ,[etas] =@etas
      ,[id_user] = @id_user
      ,[TMBER] = @TMBER
      ,[PRICE_ARAB] = @PRICE_ARAB
	  ,Price_en_francais =@Price_en_francais
 WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_commande_etas]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[edit_commande_etas]
 @ID				nvarchar(50) 
 ,@etas				nvarchar(50) 
as
UPDATE [dbo].[TB_COMMANDE]
   SET [ID] = [ID]
      ,[DATE] = [DATE]
      ,[NOM_COMMANDE] = [NOM_COMMANDE]
      ,[ID_CLIENT] = [ID_CLIENT]
      ,[TYPE_COMMANDE] = [TYPE_COMMANDE]
      ,[COUT_TOTAL] = [COUT_TOTAL]
      ,[VERSEMENT] = [VERSEMENT]
      ,[QTE] = [QTE]
      ,[REMARQUE] = [REMARQUE]
      ,[PRICE_TOTAL_HT] = [PRICE_TOTAL_HT]
      ,[PRICE_TOTAL_TTC] = [PRICE_TOTAL_TTC]
      ,[TVA] = [TVA]
      ,[deadline_Date] = [deadline_Date]
      ,[etas] =@etas
      ,[id_user] = [id_user]
      ,[TMBER] = [TMBER]
      ,[PRICE_ARAB] = [PRICE_ARAB]
 WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_etas]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[edit_etas]
@nmr_operation nvarchar(50)
,@PRIX decimal(18,2)
,@DATE_SORTIE date
,@etas nvarchar(50)
as
UPDATE [dbo].[TB_repatation]
   SET [PRIX] = @PRIX
      ,[DATE_SORTIE] = @DATE_SORTIE
	  ,ETAS = @etas 
 WHERE NMR_OPERATION = @nmr_operation


GO
/****** Object:  StoredProcedure [dbo].[edit_etas_dechet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[edit_etas_dechet]
@id int,
@etas nvarchar(50)
as
UPDATE [dbo].[TB_DECHET_REClage]
   SET [QT_Dechet] = [QT_Dechet]
      ,[etas] = @etas
      ,[ID_MATIER] = [ID_MATIER]
 WHERE ID = @id

















GO
/****** Object:  StoredProcedure [dbo].[edit_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE PROCEDURE [dbo].[edit_facture]
  @NMR_FACTURE_ORIGINAL nvarchar(50),  
  @DATE date,
  @HEURE time(7),
  @ID_CLIENT int,
  @TOTAL_FACTURE_TTC money,
  @TOTAL_FACTURE_HT money,
  @TVA float,
  @OLD_SOLD money,
  @VERSEMENT money,
  @NEW_SOLD money,
  @REMISE money,
  @POURSENTAGE_REMISE float,
  @COUNT_ARTICLE int,
  @REMARQUE nvarchar(max),
  @ETAT nvarchar(50),
  @ID_USER int,
  @ID_CAISSIER int	
,@cout_of_fctr			money
AS
 
  -- Update the existing invoice record
  UPDATE [dbo].[TB_FACTURE_VENTE]
  SET 
    [DATE] = @DATE,
    [HEURE] = @HEURE,
    [ID_CLIENT] = @ID_CLIENT,
    TOTAL_FACURE_TTC = @TOTAL_FACTURE_TTC,
    [TOTAL_FACTURE_HT] = @TOTAL_FACTURE_HT,
    [TVA] = @TVA,
    [OLD_SOLD] = @OLD_SOLD,
    [VERSEMENT] = @VERSEMENT,
    [NEW_SOLD] = @NEW_SOLD,
    [REMISE] = @REMISE,
    [POURSENTAGE_REMISE] = @POURSENTAGE_REMISE,
    [COUNT_ARTICLE] = @COUNT_ARTICLE,
    [REMARQUE] = @REMARQUE,
    [ETAT] = @ETAT,
    [ID_USER] = @ID_USER,
    [ID_CAISSIER] = @ID_CAISSIER,
	cout_of_fctr = @cout_of_fctr
  WHERE [TB_FACTURE_VENTE].[NMR_FACTURE] = @NMR_FACTURE_ORIGINAL
















GO
/****** Object:  StoredProcedure [dbo].[edit_fav_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[edit_fav_pack]
@Code_barre nvarchar(50),
@Fav int
as  
UPDATE [dbo].[TB_PACK_PRODUIT_REVENT]
   SET  [id_favoire] = @Fav
 WHERE pack_code_barre = @Code_barre




GO
/****** Object:  StoredProcedure [dbo].[edit_fav_produit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[edit_fav_produit]
@Code_barre nvarchar(50),
@Fav int
as
UPDATE [dbo].[TB_Produit_revente]
   SET  [id_favoire] =  @Fav
 WHERE CodeBarre = @Code_barre




GO
/****** Object:  StoredProcedure [dbo].[edit_fournisseur]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE proc [dbo].[edit_fournisseur]
@ID		  INT,
@NAME     NVARCHAR(50),
@PRENAME  NVARCHAR(50),
@ADRESSE  NVARCHAR(50),
@PHONE	  NVARCHAR(50),
@FAX	  NVARCHAR(50),
@EMAIL 	  NVARCHAR(50),
@SOLD_TOTAL  	 float,
@SOLD_PAYEE		 float,
@SOLD_NON_PAYES	 float, 
@NIF nvarchar(50),
@Rc nvarchar(50),
@Nic nvarchar(50),
@article nvarchar(50),
@original_name_prename nvarchar(50)
as
UPDATE [dbo].TB_FOURNISSUER
   SET [NAME] =          @NAME    		
      ,[PRENAME] =  	 @PRENAME		
      ,[PHONE] =  		 @PHONE			
      ,[FAX] =  		 @FAX			
      ,[EMAIL] =  		 @EMAIL			
      ,[SOLD_TOTAL] =  	 @SOLD_TOTAL		
      ,[SOLD_PAYE] =  	 @SOLD_PAYEE		
      ,[SOLD_NON_PAYE] = @SOLD_NON_PAYES   
      ,[ADRESSE] =  	 @ADRESSE 
	  ,NIF = @NIF
	  ,RC = @Rc
	  ,Nic = @Nic
	  ,article = @Article
	  ,originale_name_prename = @original_name_prename
 WHERE TB_FOURNISSUER.ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_gestion_produit_finaux]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[edit_gestion_produit_finaux]
 @CODE_BARRE			nvarchar(50)
,@DESIGNATION			nvarchar(100)
,@QT_PARAMETRAGE		int
,@UNITE					int
,@CATEGORIE				int
,@COUT_DE_PRODUCTION	money
,@QT_DANS_PACK			int
,@PRICE_VENTE_HT		money
,@PRICE_VENTE_TTC		money
,@TVA					float
,@PRICE_GROS			money
,@PRICE_MIN				money
,@qt_alter				int
as
UPDATE [dbo].[TB_GESTION_PRODUIT_FINAUX]
   SET [CODE_BARRE] = [CODE_BARRE]
      ,[DESIGNATION] = @DESIGNATION
      ,[QT_PARAMETRAGE] = @QT_PARAMETRAGE
      ,[UNITE] = @UNITE
      ,[CATEGORIE] = @CATEGORIE
      ,[COUT_DE_PRODUCTION] = @COUT_DE_PRODUCTION
      ,[QT_DANS_PACK] = @QT_DANS_PACK
      ,[QT_TOTAL] = [QT_TOTAL]
      ,[QT_VENTE] = [QT_VENTE]
      ,[QT_REST] =	[QT_REST]
      ,[QT_DECHET] = [QT_DECHET]
      ,[PRICE_VENTE_HT] = @PRICE_VENTE_HT
      ,[PRICE_VENTE_TTC] = @PRICE_VENTE_TTC
      ,[TVA] = @TVA
      ,[PRICE_GROS] = @PRICE_GROS
      ,[PRICE_MIN] = @PRICE_MIN
      ,[qt_alter] = @qt_alter
 WHERE [CODE_BARRE] = @CODE_BARRE

















GO
/****** Object:  StoredProcedure [dbo].[EDIT_HISTORIQE_WHENE_DELET_FCTRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[EDIT_HISTORIQE_WHENE_DELET_FCTRE]
@ID INT,
@VERSEMENT DECIMAL(19,2),
@TOTAL_TTC DECIMAL(19,2)
AS
UPDATE [dbo].[TB_CLIENT]
   SET [NAME] = [NAME]
      ,[PRENAME] = [PRENAME]
      ,[PHONE] = [PHONE]
      ,[FAX] = [FAX]
      ,[EMAIL] = [EMAIL]
      ,[SOLD_TOTAL] =  [SOLD_TOTAL]- @TOTAL_TTC
      ,[SOLD_PAYE] = [SOLD_PAYE]- @VERSEMENT
      ,[SOLD_NON_PAYE] = [SOLD_NON_PAYE]-(@TOTAL_TTC-@VERSEMENT)
      ,[ADRESSE] = [ADRESSE]
      ,[Sold_avance] = [Sold_avance]
      ,[MAX_CREDIT] = [MAX_CREDIT]
      ,[NIF] = [NIF]
      ,[RC] = [RC]
      ,[Nic] = [Nic]
      ,[article] = [article]
      ,[originale_name_prename] = [originale_name_prename]
 WHERE ID=@ID



GO
/****** Object:  StoredProcedure [dbo].[edit_historique_payment]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[edit_historique_payment]
@NMR_fctr nvarchar(50),
@Versement decimal,
@Credit_old decimal,
@CreditNew decimal
as  
SELECT [ID]
      ,[DATE]
      ,[ID_CLIENT]
      ,@Versement
      ,@Credit_old
      ,@CreditNew
      ,[REMARQUE]
  FROM [dbo].[TB_HISTORIQUE_FOURNISSEUR]
  where REMARQUE =@NMR_fctr














GO
/****** Object:  StoredProcedure [dbo].[edit_marque]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






create proc [dbo].[edit_marque]
@ID int ,
@Marque nvarchar(50)
as
UPDATE [dbo].TB_MARQUE
   SET Marque = @Marque
 WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_pack_info_without_pctr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[edit_pack_info_without_pctr]
@pack_code_barre NVARCHAR(50),
@pack_designation NVARCHAR(50), 
@price_unitair decimal, 
@id_favoire INT
as
UPDATE [dbo].[TB_PACK_PRODUIT_REVENT]
   SET [pack_code_barre] =	@pack_code_barre	 
      ,[pack_designation] = @pack_designation
      ,[code_barre_produit] =[code_barre_produit]	 
      ,[quantite] =[quantite]
      ,[price_unitair] =@price_unitair		 
      ,[photo] =[photo]				 
      ,[id_favoire] =	@id_favoire		 
 WHERE  pack_code_barre=@pack_code_barre















GO
/****** Object:  StoredProcedure [dbo].[edit_pack_information]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[edit_pack_information]
@pack_code_barre NVARCHAR(50),
@pack_designation NVARCHAR(50), 
@price_unitair decimal,
@photo IMAGE,
@id_favoire INT
as
UPDATE [dbo].[TB_PACK_PRODUIT_REVENT]
   SET [pack_code_barre] =	@pack_code_barre	 
      ,[pack_designation] = @pack_designation
      ,[code_barre_produit] =[code_barre_produit]	 
      ,[quantite] =[quantite]
      ,[price_unitair] =@price_unitair		 
      ,[photo] =@photo				 
      ,[id_favoire] =	@id_favoire		 
 WHERE  pack_code_barre=@pack_code_barre















GO
/****** Object:  StoredProcedure [dbo].[EDIT_PRICE_PACK]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[EDIT_PRICE_PACK]
@CODE_BARE_PACK NVARCHAR(50),
@PRICE DECIMAL(18,2)
AS
UPDATE [dbo].[TB_PACK_PRODUIT_REVENT]
   SET [pack_code_barre] =  [pack_code_barre]
      ,[pack_designation] = [pack_designation]
      ,[code_barre_produit] = [code_barre_produit]
      ,[quantite] = [quantite]
      ,[price_unitair] = @PRICE
      ,[photo] = [photo] 
      ,[id_favoire] = [id_favoire]
 WHERE [pack_code_barre] = @CODE_BARE_PACK







GO
/****** Object:  StoredProcedure [dbo].[edit_qt_matier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[edit_qt_matier]
@Id_matier nvarchar(50),
@Qt_use float
as
UPDATE [dbo].[TB_MATIER_PREMIER]
   SET [CODEBARRE] = [CODEBARRE]
      ,[DESIGNATION] = [DESIGNATION]
      ,[UNITE] = [UNITE]
      ,[CATEGORIES] = [CATEGORIES]
      ,[STOCKES] = [STOCKES]
      ,[MARKE] = [MARKE]
      ,[QUANTITE] = [QUANTITE]
      ,[QUANTITE_REST] =[QUANTITE_REST]-@Qt_use
      ,[QUANTITE_USE] = [QUANTITE_USE]+@Qt_use
      ,[QUANTITE_PACKES] = [QUANTITE_PACKES]
      ,[PHOTO] = [PHOTO]
      ,[DATE_PREPARATION] = [DATE_PREPARATION]
      ,[OBSERVATION] = [OBSERVATION]
      ,[STOCKES_MIN] = [STOCKES_MIN]
      ,[PRODUIT_DES_PIECES] = [PRODUIT_DES_PIECES]
 WHERE CODEBARRE=@Id_matier

















GO
/****** Object:  StoredProcedure [dbo].[edit_qt_matier_production]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[edit_qt_matier_production]
@Id_matier nvarchar(50),
@Qt_use float
as
UPDATE [dbo].[TB_MATIER_PREMIER]
   SET [CODEBARRE] = [CODEBARRE]
      ,[DESIGNATION] = [DESIGNATION]
      ,[UNITE] = [UNITE]
      ,[CATEGORIES] = [CATEGORIES]
      ,[STOCKES] = [STOCKES]
      ,[MARKE] = [MARKE]
      ,[QUANTITE] = [QUANTITE]
      ,[QUANTITE_REST] =[QUANTITE_REST]-@Qt_use
      ,[QUANTITE_USE] = [QUANTITE_USE]+@Qt_use
      ,[QUANTITE_PACKES] = [QUANTITE_PACKES]
      ,[PHOTO] = [PHOTO]
      ,[DATE_PREPARATION] = [DATE_PREPARATION]
      ,[OBSERVATION] = [OBSERVATION]
      ,[STOCKES_MIN] = [STOCKES_MIN]
      ,[PRODUIT_DES_PIECES] = [PRODUIT_DES_PIECES]
 WHERE CODEBARRE=@Id_matier
















GO
/****** Object:  StoredProcedure [dbo].[edit_qt_pack_achat]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[edit_qt_pack_achat]
@CODE_PRODUIT nvarchar(50),
@QUANTITE	  float
as
UPDATE [dbo].[TB_PACK_PRODUIT_REVENT]
   SET [pack_code_barre] = [pack_code_barre]
      ,[pack_designation] = [pack_designation]
      ,[code_barre_produit] = [code_barre_produit]
      ,[quantite] = [quantite]+@QUANTITE
      ,[price_unitair] = [price_unitair]
      ,[photo] = [photo]
      ,[id_favoire] = [id_favoire]
 WHERE code_barre_produit = @CODE_PRODUIT

















GO
/****** Object:  StoredProcedure [dbo].[edit_setting]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
    
--/////////////////////////////////////// 
CREATE PROCEDURE [dbo].[edit_setting]
    @NAME nvarchar(50),
    @PRENAME nvarchar(50),
    @ADRESS nvarchar(50),
    @ACTIVITY nvarchar(50),
    @NMR_REGISTRE nvarchar(max),
    @NMR_MATIER nvarchar(max),
    @NMR_JIBAI nvarchar(max),
    @LOGO image,
    @WILAYA nvarchar(50),
    @CompanyName nvarchar(50),
    @ID int, -- Assuming you have an ID column to identify the record to update,
	@Phone nvarchar(50),
	@Message nvarchar(max)
   ,@PRINT_FACTURE	nvarchar(50)
   ,@PRINT_BON		nvarchar(50)
   ,@PRINT_BON_A4	nvarchar(50)
   ,@DONT_PRINT		nvarchar(50)
   ,@DAY_AVANT_PEREPRTION int
	
AS
BEGIN
    UPDATE [dbo].[TB_PARAMETRE_INFO]
    SET [NAME] = @NAME,
        [PRENAME] = @PRENAME,
        [ADRESS] = @ADRESS,
        [ACTIVITY] = @ACTIVITY,
        [NMR_REGISTRE] = @NMR_REGISTRE,
        [NMR_MATIER] = @NMR_MATIER,
        [NMR_JIBAI] = @NMR_JIBAI,
        [LOGO] = @LOGO,
        [WILAYA] = @WILAYA,
		CompanyName = @CompanyName,
		Phone = @Phone,
		Message = @Message
		,PRINT_FACTURE  =@PRINT_FACTURE	
		,PRINT_BON		=@PRINT_BON		
		,PRINT_BON_A4	=@PRINT_BON_A4	
		,DONT_PRINT		=@DONT_PRINT	
		,DAY_AVANT_PEREPRTION = @DAY_AVANT_PEREPRTION	
    WHERE [ID] = @ID; -- Replace with the actual condition to identify the record to update
END











GO
/****** Object:  StoredProcedure [dbo].[edit_stockes]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[edit_stockes]
@ID int,
@STOCK nvarchar(50)
as 
UPDATE [dbo].[TB_STOCK]
   SET [STOCKE] = @STOCK
 WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_sub_cout]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[edit_sub_cout]
@ID_sub int,
@cout money
as
UPDATE [dbo].[TB_SUM_COMMANDE_caise]
   SET [ID_COMMANDE] = [ID_COMMANDE]
      ,[SUB_COMMANDE_TITLE] = [SUB_COMMANDE_TITLE]
      ,[QUANTITE] = [QUANTITE]
      ,[PRIX_UNITAIR] = [PRIX_UNITAIR]
      ,[PRIX_TOTAL] =[PRIX_TOTAL]
      ,[QTE_REST] = [QTE_REST]
      ,[QT_LIVRE] = [QT_LIVRE]
      ,[price_cout] = @cout
 WHERE ID = @ID_sub  

















GO
/****** Object:  StoredProcedure [dbo].[edit_tb_cofre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[edit_tb_cofre]
@ID int ,
@SOLD_ON_COFRE decimal(19,2)
as 
UPDATE [dbo].[TB_COFRE]
   SET [SOLD_ON_COFRE] = @SOLD_ON_COFRE
 WHERE ID =@ID















GO
/****** Object:  StoredProcedure [dbo].[edit_tb_ouverier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[edit_tb_ouverier]
 @ID			int
,@NAME		nvarchar(50) 
,@PRENAME	nvarchar(50) 
,@FONCTION	nvarchar(50) 
,@PHONE		nvarchar(50) 
as
UPDATE [dbo].[TB_OUVERIER]
   SET [NAME] =		@NAME		
      ,[PRENAME] =	@PRENAME	
      ,[FONCTION] = @FONCTION	
      ,[PHONE] =@PHONE		
 WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_tb_sub_comande_whene_complete]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[edit_tb_sub_comande_whene_complete]
@ID_commande nvarchar(50)
as 
UPDATE [dbo].[TB_SUM_COMMANDE]
   SET [ID] = [ID]
      ,[ID_COMMANDE] = [ID_COMMANDE]
      ,[SUB_COMMANDE_TITLE] =[SUB_COMMANDE_TITLE]
      ,[QUANTITE] = [QUANTITE]
      ,[PRIX_UNITAIR] = [PRIX_UNITAIR]
      ,[PRIX_TOTAL] = [PRIX_TOTAL]
      ,[QTE_REST] = 0
      ,[QT_LIVRE] = [QUANTITE]
      ,[price_cout] = [price_cout]
 WHERE [ID_COMMANDE] = @ID_commande

















GO
/****** Object:  StoredProcedure [dbo].[edit_tb_sub_comande_whene_not_complete]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[edit_tb_sub_comande_whene_not_complete]
@ID INT ,
@qtetake int
AS
UPDATE [dbo].[Tb_sub_commande]
   SET [id_commande] =		[id_commande]	 
      ,[sub_name_commande] =	 [sub_name_commande]
      ,[Quantite] =				 [Quantite]
      ,[prix_unite] =			 [prix_unite]
      ,[prix_total] =			 [prix_total]
      ,[QTE_REST] =				 [QTE_REST]-@qtetake
      ,[QTE_LIVRE] =			 [QTE_LIVRE]+ @qtetake
 WHERE id =@ID 
















GO
/****** Object:  StoredProcedure [dbo].[edit_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[edit_unite]
@ID int ,
@Unite nvarchar(50)
as
UPDATE [dbo].[TB_UNITE]
   SET [UNITE] = @Unite
 WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[edit_update_whene_Recupi]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[edit_update_whene_Recupi]
 @ID_OUVERIER int,
    @USERR nvarchar(50),
    @PASS nvarchar(50),
    @ROLE nvarchar(50),
    @ETAS nvarchar(50),
    @Code_Recupiraiton nvarchar(50),
    @id int
	as 
	UPDATE [dbo].[TB_USER]
    SET [ID_OUVERIER] = @ID_OUVERIER,
        [USERR] = @USERR,
        [PASS] = @PASS,
        [ROLE] = @ROLE,
        [ETAS] = @ETAS,
        [Code_Recupiraiton] = @Code_Recupiraiton
		
    WHERE ID = @id;













GO
/****** Object:  StoredProcedure [dbo].[edit_vente_QT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[edit_vente_QT]
@ID int, 
@Quantite float
as
UPDATE [dbo].[TB_VENTE]
   SET [CODE_BARRE_PRODUIT] =	[CODE_BARRE_PRODUIT]
      ,[QUANTITE_VENTE] = [QUANTITE_VENTE]+@Quantite	
      ,[PRIX_VENTE] =	[PRIX_VENTE]		
      ,[PRIX_TOTAL] =	[PRIX_TOTAL]		
      ,[ID_FACTURE] =	[ID_FACTURE]		
 WHERE ID=@ID
















GO
/****** Object:  StoredProcedure [dbo].[edit_versement_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[edit_versement_commande]
@id_commande nvarchar(50),
@price_versé money
as 
UPDATE [dbo].[TB_COMMANDE]
   SET [ID] = [ID]
      ,[DATE] = [DATE] 
      ,[NOM_COMMANDE] = [NOM_COMMANDE]
      ,[ID_CLIENT] = [ID_CLIENT]
      ,[TYPE_COMMANDE] = [TYPE_COMMANDE]
      ,[COUT_TOTAL] = [COUT_TOTAL]
      ,[VERSEMENT] = [VERSEMENT]+@price_versé
      ,[QTE] = [QTE]
      ,[REMARQUE] = [REMARQUE]
      ,[PRICE_TOTAL_HT] = [PRICE_TOTAL_HT]
      ,[PRICE_TOTAL_TTC] = [PRICE_TOTAL_TTC]
      ,[TVA] = [TVA]
      ,[deadline_Date] = [deadline_Date]
      ,[etas] = [etas]
      ,[id_user] = [id_user]
      ,[TMBER] = [TMBER]
      ,[PRICE_ARAB] =[PRICE_ARAB]
 WHERE ID = @id_commande

















GO
/****** Object:  StoredProcedure [dbo].[edit_whene_demontez]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[edit_whene_demontez]
@Id_matier nvarchar(50),
@Qt_use float
as
UPDATE [dbo].[TB_MATIER_PREMIER]
   SET [CODEBARRE] = [CODEBARRE]
      ,[DESIGNATION] = [DESIGNATION]
      ,[UNITE] = [UNITE]
      ,[CATEGORIES] = [CATEGORIES]
      ,[STOCKES] = [STOCKES]
      ,[MARKE] = [MARKE]
      ,[QUANTITE] = [QUANTITE]
      ,[QUANTITE_REST] =[QUANTITE_REST]+@Qt_use
      ,[QUANTITE_USE] = [QUANTITE_USE]-@Qt_use
      ,[QUANTITE_PACKES] = [QUANTITE_PACKES]
      ,[PHOTO] = [PHOTO]
      ,[DATE_PREPARATION] = [DATE_PREPARATION]
      ,[OBSERVATION] = [OBSERVATION]
      ,[STOCKES_MIN] = [STOCKES_MIN]
      ,[PRODUIT_DES_PIECES] = [PRODUIT_DES_PIECES]
 WHERE CODEBARRE=@Id_matier

















GO
/****** Object:  StoredProcedure [dbo].[facture_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[facture_vente]
@nmr_Facture nvarchar(50)
as
SELECT 
		--////////////////////////////
	   [TB_GESTION_PRODUIT_FINAUX].[CODE_BARRE]
      ,[TB_GESTION_PRODUIT_FINAUX].[DESIGNATION]
	  --/////////////////////////////////////// 
      ,[TB_VENTE].[QUANTITE_VENTE]
      ,[TB_VENTE].[PRIX_VENTE]
      ,[TB_VENTE].[PRIX_TOTAL] 
      ,[TB_VENTE].[ID]
	  --/////////////////////////////
	  ,[TB_FACTURE_VENTE].[NMR_FACTURE]
      ,[TB_FACTURE_VENTE].[DATE]
      ,[TB_FACTURE_VENTE].[HEURE] 
      ,[TB_FACTURE_VENTE].[TOTAL_FACURE_TTC]
      ,[TB_FACTURE_VENTE].[TOTAL_FACTURE_HT]
      ,[TB_FACTURE_VENTE].[TVA]
      ,[TB_FACTURE_VENTE].[OLD_SOLD]
      ,[TB_FACTURE_VENTE].[VERSEMENT]
      ,[TB_FACTURE_VENTE].[NEW_SOLD]
      ,[TB_FACTURE_VENTE].[REMISE]
      ,[TB_FACTURE_VENTE].[POURSENTAGE_REMISE]
      ,[TB_FACTURE_VENTE].[COUNT_ARTICLE]
      ,[TB_FACTURE_VENTE].[REMARQUE]
      ,[TB_FACTURE_VENTE].[ETAT] 
      ,[TB_FACTURE_VENTE].[cout_of_fctr] 
      ,[TB_FACTURE_VENTE].tmbre 
      ,[TB_FACTURE_VENTE].pricearabe 
	  --//////////////////////////////////////// 
      ,[TB_USER].[USERR]
      ,[TB_USER].[PASS]
      ,[TB_USER].[ROLE]
      ,[TB_USER].[ETAS]
	  --//////////////////////////////////////// 
      ,[TB_OUVERIER].[NAME]
      ,[TB_OUVERIER].[PRENAME]
      ,[TB_OUVERIER].[FONCTION]
      ,[TB_OUVERIER].[PHONE]
	  --///////////////////////////////////////// 
      ,[TB_CLIENT].[NAME]
      ,[TB_CLIENT].[PRENAME]
      ,[TB_CLIENT].[PHONE]
      ,[TB_CLIENT].[FAX]
      ,[TB_CLIENT].[EMAIL]
      ,[TB_CLIENT].[SOLD_TOTAL]
      ,[TB_CLIENT].[SOLD_PAYE]
      ,[TB_CLIENT].[SOLD_NON_PAYE]
      ,[TB_CLIENT].[ADRESSE]
      ,[TB_CLIENT].[Sold_avance]
      ,[TB_CLIENT].[MAX_CREDIT]
      ,[TB_CLIENT].[NIF]
      ,[TB_CLIENT].[RC]
      ,[TB_CLIENT].[Nic]
      ,[TB_CLIENT].[article]
      ,[TB_CLIENT].[originale_name_prename]
  FROM [dbo].[TB_VENTE]
  inner join TB_FACTURE_VENTE on TB_FACTURE_VENTE.NMR_FACTURE = TB_VENTE.ID_FACTURE
  inner join TB_USER on TB_USER.ID = TB_FACTURE_VENTE.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = TB_VENTE.[CODE_BARRE_PRODUIT]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_FACTURE_VENTE.ID_CLIENT
 where [TB_VENTE].ID_FACTURE = @nmr_Facture

 
















GO
/****** Object:  StoredProcedure [dbo].[facture_vente_1]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROC [dbo].[facture_vente_1]
@nmr_Facture NVARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;

     SELECT 
        -- Selecting the correct CodeBarre and designation
        COALESCE(TB_Produit_revente.CodeBarre, TB_PACK_PRODUIT_REVENT.pack_code_barre, TB_VENTE.CODE_BARRE_PRODUIT) AS CodeBarre,
        COALESCE(TB_Produit_revente.designation, TB_PACK_PRODUIT_REVENT.pack_designation, TB_VENTE.CODE_BARRE_PRODUIT) AS designation,
        -- Other columns
        TB_VENTE.QUANTITE_VENTE,
        TB_VENTE.PRIX_VENTE,
        TB_VENTE.PRIX_TOTAL, 
        TB_VENTE.ID,
        TB_FACTURE_VENTE.NMR_FACTURE,
        TB_FACTURE_VENTE.DATE,
        TB_FACTURE_VENTE.HEURE, 
        TB_FACTURE_VENTE.TOTAL_FACURE_TTC,
        TB_FACTURE_VENTE.TOTAL_FACTURE_HT,
        TB_FACTURE_VENTE.TVA,
        TB_FACTURE_VENTE.OLD_SOLD,
        TB_FACTURE_VENTE.VERSEMENT,
        TB_FACTURE_VENTE.NEW_SOLD,
        TB_FACTURE_VENTE.REMISE,
        TB_FACTURE_VENTE.POURSENTAGE_REMISE,
        TB_FACTURE_VENTE.COUNT_ARTICLE,
        TB_FACTURE_VENTE.REMARQUE,
        TB_FACTURE_VENTE.ETAT,
        TB_FACTURE_VENTE.cout_of_fctr,
        TB_FACTURE_VENTE.tmbre,
        TB_FACTURE_VENTE.pricearabe,
        TB_USER.USERR,
        TB_USER.PASS,
        TB_USER.ROLE,
        TB_USER.ETAS,
        TB_OUVERIER.NAME,
        TB_OUVERIER.PRENAME,
        TB_OUVERIER.FONCTION,
        TB_OUVERIER.PHONE,
        TB_CLIENT.NAME AS ClientName,
        TB_CLIENT.PRENAME AS ClientPrename,
        TB_CLIENT.PHONE AS ClientPhone,
        TB_CLIENT.FAX,
        TB_CLIENT.EMAIL,
        TB_CLIENT.SOLD_TOTAL,
        TB_CLIENT.SOLD_PAYE,
        TB_CLIENT.SOLD_NON_PAYE,
        TB_CLIENT.ADRESSE,
        TB_CLIENT.Sold_avance,
        TB_CLIENT.MAX_CREDIT,
        TB_CLIENT.NIF,
        TB_CLIENT.RC,
        TB_CLIENT.Nic,
        TB_CLIENT.article,
        TB_CLIENT.originale_name_prename
    FROM TB_VENTE
    INNER JOIN TB_FACTURE_VENTE ON TB_FACTURE_VENTE.NMR_FACTURE = TB_VENTE.ID_FACTURE
    INNER JOIN TB_USER ON TB_USER.ID = TB_FACTURE_VENTE.ID_USER
    INNER JOIN TB_OUVERIER ON TB_OUVERIER.ID = TB_USER.ID_OUVERIER
    LEFT JOIN TB_Produit_revente ON TB_Produit_revente.CodeBarre = TB_VENTE.CODE_BARRE_PRODUIT
    LEFT JOIN TB_PACK_PRODUIT_REVENT ON TB_PACK_PRODUIT_REVENT.pack_code_barre = TB_VENTE.CODE_BARRE_PRODUIT
    INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_FACTURE_VENTE.ID_CLIENT
    WHERE TB_VENTE.ID_FACTURE = @nmr_Facture;
END















GO
/****** Object:  StoredProcedure [dbo].[FILL_COMBO_CATEGORIES]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[FILL_COMBO_CATEGORIES]
as 
SELECT [ID]
      ,[CATEGORIES]
  FROM [dbo].[TB_CATEGORIES]

















GO
/****** Object:  StoredProcedure [dbo].[FILL_COMBO_FAV]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[FILL_COMBO_FAV]
AS
SELECT [ID]
      ,FAVOIRE
  FROM [dbo].TB_FAVORIS

















GO
/****** Object:  StoredProcedure [dbo].[FILL_COMBO_Marque]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[FILL_COMBO_Marque]
as
SELECT [ID]
      ,[Marque]
  FROM [dbo].[TB_MARQUE]

















GO
/****** Object:  StoredProcedure [dbo].[fill_combo_matier_premier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[fill_combo_matier_premier]
as
SELECT [CODEBARRE]
      ,[DESIGNATION]
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,[QUANTITE]
      ,[QUANTITE_REST]
      ,[QUANTITE_USE]
      ,[QUANTITE_PACKES]
      ,[PHOTO]
      ,[DATE_PREPARATION]
      ,[OBSERVATION]
      ,[STOCKES_MIN]
      ,[PRODUIT_DES_PIECES]
      ,[REFERENCE]
  FROM [dbo].[TB_MATIER_PREMIER]
  inner join TB_UNITE on TB_UNITE.ID =[TB_MATIER_PREMIER].UNITE
  inner join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_MATIER_PREMIER].CATEGORIES
  inner join TB_STOCK on TB_STOCK.ID =[TB_MATIER_PREMIER].STOCKES
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_MATIER_PREMIER].MARKE

















GO
/****** Object:  StoredProcedure [dbo].[fill_combo_produit_fabrique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[fill_combo_produit_fabrique]
as  
SELECT [CODE_BARRE]
      ,[DESIGNATION]
      ,[QT_PARAMETRAGE]
      ,[UNITE]
      ,[CATEGORIE]
      ,[COUT_DE_PRODUCTION]
      ,[QT_DANS_PACK]
      ,[QT_TOTAL]
      ,[QT_VENTE]
      ,[QT_REST]
      ,[QT_DECHET]
      ,[PRICE_VENTE_HT]
      ,[PRICE_VENTE_TTC]
      ,[TVA]
      ,[PRICE_GROS]
      ,[PRICE_MIN]
      ,[qt_alter]
      ,[refereence]
      ,[picture]
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]

















GO
/****** Object:  StoredProcedure [dbo].[fill_combo_produit_pack_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[fill_combo_produit_pack_produit_revent]
as 
SELECT [pack_code_barre]
      ,[pack_designation]
      ,[code_barre_produit]
      ,[quantite]
      ,[price_unitair]
      ,[photo]
      ,[id_favoire]
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]

















GO
/****** Object:  StoredProcedure [dbo].[fill_combo_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- Inline SQL script
CREATE proc [dbo].[fill_combo_produit_revent]
as 
SELECT [CodeBarre]
      ,[designation]
      ,[reference]
      ,[id_categories]
      ,[id_stocke]
      ,[id_marque]
      ,[id_unite]
      ,[id_taille]
      ,[id_color]
      ,[id_favoire]
      ,[date_expiration]
      ,[price_achat_HT]
      ,[price_achat_TTC]
      ,[TVA]
      ,[Quantite_TOTAL]
      ,[price_vente1]
      ,[price_vente2]
      ,[price_min]
      ,[vente_apres_expiration]
      ,[stocke_negatif]
      ,[Quantite_vente]
      ,[Quantite_rest]
      ,[Quantite_dechet]
      ,[Photo]
      ,[QT_DANS_PACK]
      ,[Quantite_alert]
      ,[ihtiyaj]
  FROM [dbo].[TB_Produit_revente] 











GO
/****** Object:  StoredProcedure [dbo].[FILL_COMBO_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[FILL_COMBO_stock]
as
SELECT [ID]
      ,[STOCKE]
  FROM [dbo].[TB_STOCK]

















GO
/****** Object:  StoredProcedure [dbo].[FILL_COMBO_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[FILL_COMBO_unite]
as
SELECT [ID]
      ,[UNITE]
  FROM [dbo].[TB_UNITE]

















GO
/****** Object:  StoredProcedure [dbo].[fill_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[fill_produit_revent]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
  FROM [dbo].[TB_Produit_revente]
  inner join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  inner join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  inner join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 















GO
/****** Object:  StoredProcedure [dbo].[get_ACCES_USer]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[get_ACCES_USer]
@ID int
as
SELECT [ID] 
      ,[Stock]
      ,[unite]
      ,[categorie]
      ,[marque]
      ,[favoris]
      ,[taille]
      ,[color]
      ,[fournisseure]
      ,[ouverier]
      ,[users]
      ,[caissier]
      ,[client]
      ,[historique_client]
      ,[remarque]
      ,[achat]
      ,[facture_achat]
      ,[dossier_fctr_achat]
      ,[historique_frnsre]
      ,[stock_produit]
      ,[pack]
      ,[facture_vente]
      ,[list_vente]
      ,[liv]
      ,[POS]
      ,[les_charge]
      ,[lapie]
      ,[transition_caissier]
      ,[state_total]
      ,[benifice]
      ,[serverss]
      ,[facture_info]
  FROM [dbo].[TB_USER]
  where ID = @ID














GO
/****** Object:  StoredProcedure [dbo].[get_achat_by_id_fctre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_achat_by_id_fctre]
@id_fctr nvarchar(50)
as
SELECT [ID_PRODUIT] as'رمز المنتوج'
	  ,TB_MATIER_PREMIER.DESIGNATION as'اسم المنتوج'
      ,[TB_ACHAT].[QUANTITE] as'الكمية'
      ,[QUANTITE_AFTER] as'كمية المنتوج بعد الشراء'
      ,[PRIX_ACHAT_HT] as'سعر الشراء  HT'
      ,[TB_ACHAT].[TVA] as'TVA'
      ,[PRIX_ACHAT_TTC] as'سعر الشرا TTC'
      ,[TOTAL_HT] as'المبلغ الكلي HT'
      ,[TOTAL_TTC] as'المبلغ الكلي TTC' 
      ,[ID_FACTURE] as'رقم الفاتورة'
  FROM [dbo].[TB_ACHAT]
  inner join TB_MATIER_PREMIER on TB_MATIER_PREMIER.CODEBARRE = TB_ACHAT.ID_PRODUIT
  where TB_ACHAT.ID_FACTURE = @id_fctr

















GO
/****** Object:  StoredProcedure [dbo].[GET_ALL_PRODUCT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[GET_ALL_PRODUCT]
AS
SELECT [CodeBarre]
      ,[designation] 
      ,[date_expiration] 
      ,[Quantite_rest] 
      ,[Quantite_alert]
  FROM [dbo].[TB_Produit_revente]















GO
/****** Object:  StoredProcedure [dbo].[get_bon_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_bon_client]
@ID int
as
SELECT [TB_HISTORIQUE_CLIENT].ID
      ,[DATE]
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'client'
      ,[PRICE]
      ,[CREDIT_OLD]
      ,[CREDIT_NEW]
      ,[REMARQUE]
  FROM [dbo].[TB_HISTORIQUE_CLIENT]
  inner join TB_CLIENT on TB_CLIENT.id = TB_HISTORIQUE_CLIENT.ID_CLIENT
  where [TB_HISTORIQUE_CLIENT].ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[GET_CAISSE_PRODUCT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[GET_CAISSE_PRODUCT]
AS
SELECT [ID] as'ID'
      ,TB_MATIER_PREMIER.CODEBARRE as'رمز المنتج'
      ,TB_MATIER_PREMIER.DESIGNATION as'اسم المنتج'
      ,[TB_ACHAT_CAISSE].[QUANTITE] as'الكمية'
      ,[QUANTITE_AFTER] as'كمية المنتج بعد الشراء'
      ,[PRIX_ACHAT_HT] as'سعر الشراء HT'
      ,[TB_ACHAT_CAISSE].[TVA] as'TVA'
      ,[PRIX_ACHAT_TTC] as'سعر الشراء TTC'
      ,[TOTAL_HT] as'السعر الكلي HT'
      ,[TOTAL_TTC] as'السعر الكلي TTC' 
      ,[ID_FACTURE] as'رقم الفاتورة'
	  ,TYPE_achat as 'نوع الشراء'
  FROM [dbo].[TB_ACHAT_CAISSE]
  INNER JOIN  TB_MATIER_PREMIER ON  TB_MATIER_PREMIER.CODEBARRE = TB_ACHAT_CAISSE.ID_PRODUIT

















GO
/****** Object:  StoredProcedure [dbo].[GET_CAISSE_PRODUIT_REVENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[GET_CAISSE_PRODUIT_REVENT]
AS
SELECT [TB_ACHAT_PRODUIT_REVENT_CAISSE].[ID]
      ,TB_Produit_revente.CodeBarre as 'رقم المنتج'
	  ,TB_Produit_revente.designation as 'اسم المنتج'
      ,[QUANTITE] as'الكمية'
	  ,[QUANTITE_BEFOR] as'كمية المنتج قبل الشراء'
      ,[QUANTITE_AFTER] as'كمية المنتج بعد الشراء'
      ,[TB_ACHAT_PRODUIT_REVENT_CAISSE].[PRICE_ACHAT_HT] as'سعر الشراء HT'
      ,[TB_ACHAT_PRODUIT_REVENT_CAISSE].[TVA] as'TVA'	    
      ,[TB_ACHAT_PRODUIT_REVENT_CAISSE].[PRICE_ACHAT_TTC] as'سعر الشراء TTC'
      ,[TB_ACHAT_PRODUIT_REVENT_CAISSE].[TOTAL_HT] as'السعر الكلي HT'
      ,[TB_ACHAT_PRODUIT_REVENT_CAISSE].[TOTAL_TTC] as'السعر الكلي TTC'
      ,[REMARQUE] as'ملاحظة'
      ,[ID_FACTURE] as'رقم الفاتورة'
      ,[TYPE_FACTURE] as 'نوع الشراء'
  FROM [dbo].[TB_ACHAT_PRODUIT_REVENT_CAISSE]
  INNER JOIN  TB_Produit_revente ON  TB_Produit_revente.CODEBARRE = [TB_ACHAT_PRODUIT_REVENT_CAISSE].CODE_PRODUIT

















GO
/****** Object:  StoredProcedure [dbo].[get_client_information]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_client_information]
@id_client int
as
SELECT [ID]
      ,[NAME]
      ,[PRENAME]
      ,[PHONE]
      ,[FAX]
      ,[EMAIL]
      ,[SOLD_TOTAL]
      ,[SOLD_PAYE]
      ,[SOLD_NON_PAYE]
      ,[ADRESSE]
      ,[Sold_avance]
      ,[MAX_CREDIT]
      ,[NIF]
      ,[RC]
      ,[Nic]
      ,[article]
      ,[originale_name_prename]
  FROM [dbo].[TB_CLIENT]
  where ID = @id_client

















GO
/****** Object:  StoredProcedure [dbo].[get_client_of_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_client_of_commande]
@id_commande nvarchar(50)
as
SELECT [ID]
      ,[DATE]
      ,[NOM_COMMANDE]
      ,[ID_CLIENT]
      ,[TYPE_COMMANDE]
      ,[COUT_TOTAL]
      ,[VERSEMENT]
      ,[QTE]
      ,[REMARQUE]
      ,[PRICE_TOTAL_HT]
      ,[PRICE_TOTAL_TTC]
      ,[TVA]
      ,[deadline_Date]
      ,[etas]
      ,[id_user]
      ,[TMBER]
      ,[PRICE_ARAB]
  FROM [dbo].[TB_COMMANDE]
  where ID = @id_commande

















GO
/****** Object:  StoredProcedure [dbo].[get_client_tb]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



Create proc [dbo].[get_client_tb]
as
SELECT [ID] as'ID'
      ,[NAME] as'الاسم'
      ,[PRENAME] as'اللقب'
	  ,[ADRESSE] as'العنوان'
      ,[PHONE] as'الهاتف'
      ,[FAX] as'الفاكس'
      ,[EMAIL] as'الإيميل'
      ,[SOLD_TOTAL] as'المبلغ الكلي'
      ,[SOLD_PAYE] as'المبلغ المدفوع'
      ,[SOLD_NON_PAYE] as'المبلغ الغير مدفوع'
      ,[Sold_avance] as'مبلغ مسبق' 
	   ,MAX_CREDIT AS 'سقف التأخير'
	   ,NIF as 'NIF'
	   ,RC as 'RC'
	   ,Nic as 'Nic'
	   ,article as 'Article'
  FROM [dbo].[TB_CLIENT]


















GO
/****** Object:  StoredProcedure [dbo].[get_code_Barre_Picture_produit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[get_code_Barre_Picture_produit]
@codebarre nvarchar(50)   
AS
BEGIN
    SELECT [barcodeimage]
    FROM [dbo].[TB_Produit_revente]
    WHERE CodeBarre = @codebarre 
END 


GO
/****** Object:  StoredProcedure [dbo].[get_code_Barre_Picture_produit_BP]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[get_code_Barre_Picture_produit_BP]
    @codebarre_list NVARCHAR(MAX)
AS
BEGIN
    SELECT [barcodeimage]
    FROM [dbo].[TB_Produit_revente]
    WHERE CodeBarre IN (
        SELECT Value FROM dbo.SplitString(@codebarre_list, ',')
    );
END


GO
/****** Object:  StoredProcedure [dbo].[get_combo]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_combo]
as 
SELECT [ID]
      ,[NAME]
      ,[PRENAME]
      ,[PHONE]
      ,[FAX]
      ,[EMAIL]
      ,[SOLD_TOTAL]
      ,[SOLD_PAYE]
      ,[SOLD_NON_PAYE]
      ,[ADRESSE]
      ,[NIF]
      ,[RC]
      ,[Nic]
      ,[article]
      ,[originale_name_prename]
  FROM [dbo].[TB_FOURNISSUER]

















GO
/****** Object:  StoredProcedure [dbo].[get_Combo_caisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[get_Combo_caisse]
as
SELECT [ID]
      ,[NAME]+' '+[PRENAME] as'ANA'
      ,[USER-NAME]
      ,[PASSW]
  FROM [dbo].[TB_INFO_CAISSIER]















GO
/****** Object:  StoredProcedure [dbo].[get_combo_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_combo_client]
as 
SELECT [ID]
      ,[NAME] +' ' + [PRENAME] as 'Client'
      ,[PHONE]
      ,[FAX]
      ,[EMAIL]
      ,[SOLD_TOTAL]
      ,[SOLD_PAYE]
      ,[SOLD_NON_PAYE]
      ,[ADRESSE]
      ,[Sold_avance]
      ,[MAX_CREDIT]
      ,[NIF]
      ,[RC]
      ,[Nic]
      ,[article]
      ,[originale_name_prename]
  FROM [dbo].[TB_CLIENT] 


















GO
/****** Object:  StoredProcedure [dbo].[get_combo_color]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_combo_color]
as
SELECT [ID]
      ,[COLOR]
  FROM [dbo].[TB_COLOR]

















GO
/****** Object:  StoredProcedure [dbo].[get_combo_frnse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_combo_frnse]
as 
SELECT [ID]
      ,[NAME] +' ' +  [PRENAME] as'frnsr'
      ,[PHONE]
      ,[FAX]
      ,[EMAIL]
      ,[SOLD_TOTAL]
      ,[SOLD_PAYE]
      ,[SOLD_NON_PAYE]
      ,[ADRESSE]
      ,[NIF]
      ,[RC]
      ,[Nic]
      ,[article]
      ,[originale_name_prename]
  FROM [dbo].[TB_FOURNISSUER]

















GO
/****** Object:  StoredProcedure [dbo].[get_combo_matier_premier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_combo_matier_premier]
as 

SELECT [CODEBARRE]
      ,[DESIGNATION]
      ,[UNITE]
      ,[CATEGORIES]
      ,[STOCKES]
      ,[MARKE]
      ,[QUANTITE]
      ,[QUANTITE_REST]
      ,[QUANTITE_USE]
      ,[QUANTITE_PACKES]
      ,[PHOTO]
      ,[DATE_PREPARATION]
      ,[OBSERVATION]
      ,[STOCKES_MIN]
      ,[PRODUIT_DES_PIECES]
      ,[PRICE_HT]
      ,[PRICE_TTC]
      ,[TB_MATIER_PREMIER].[TVA] as 'TVA'
  FROM [dbo].[TB_MATIER_PREMIER]

















GO
/****** Object:  StoredProcedure [dbo].[get_combo_ouverier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_combo_ouverier]
as
SELECT [ID]
      ,[NAME] +' '+[PRENAME] as'Name' 
      ,[FONCTION]
      ,[PHONE]
  FROM [dbo].[TB_OUVERIER]

















GO
/****** Object:  StoredProcedure [dbo].[get_combo_pack_fabrique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_combo_pack_fabrique]
as
SELECT [BARCODE_PACK]
      ,[DESIGNATION]
      ,[ID_PRODUIT_FINAUX]
      ,[PRICE_GROS]
      ,[PRICE_DETAILLE]
      ,[PRICE_MIN]
      ,[QT_DISPONIBLE]
      ,[picture]
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]

















GO
/****** Object:  StoredProcedure [dbo].[get_combo_taille]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_combo_taille]
as
SELECT [ID]
      ,[TAILLE]
  FROM [dbo].[TB_TAILLE]

















GO
/****** Object:  StoredProcedure [dbo].[get_commande_proforma]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_commande_proforma]
@type_commande nvarchar(50)
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,TMBER as'نسبة الطابع'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  where REMARQUE=@type_commande 
















GO
/****** Object:  StoredProcedure [dbo].[get_commande_proforma_and_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_commande_proforma_and_date]
@type_commande nvarchar(50),
@Date date 
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,TMBER as'نسبة الطابع'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  where REMARQUE=@type_commande
  and      
  		[DATE] = @Date 
        
















GO
/****** Object:  StoredProcedure [dbo].[get_commande_proforma_for_tmbre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE proc  [dbo].[get_commande_proforma_for_tmbre]
@id_cmd nvarchar(50)
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,TMBER as'نسبة الطابع'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  where [TB_COMMANDE].[ID]=@id_cmd
















GO
/****** Object:  StoredProcedure [dbo].[get_count_product]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[get_count_product]
@CodeBarre nvarchar(50)
as  
SELECT [CodeBarre]
      ,[designation]
      ,[reference]
      ,[id_categories]
      ,[id_stocke]
      ,[id_marque]
      ,[id_unite]
      ,[id_taille]
      ,[id_color]
      ,[id_favoire]
      ,[date_expiration]
      ,[price_achat_HT]
      ,[price_achat_TTC]
      ,[TVA]
      ,[Quantite_TOTAL]
      ,[price_vente1]
      ,[price_vente2]
      ,[price_min]
      ,[vente_apres_expiration]
      ,[stocke_negatif]
      ,[Quantite_vente]
      ,[Quantite_rest]
      ,[Quantite_dechet]
      ,[Photo]
      ,[QT_DANS_PACK]
  FROM [dbo].[TB_Produit_revente]
  where CodeBarre = @CodeBarre















GO
/****** Object:  StoredProcedure [dbo].[get_dechet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_dechet]
as
SELECT [ID] as'ID'
      ,TB_MATIER_PREMIER.DESIGNATION as'اسم المادة'
      ,[PRICE_U] as'سعر الشراء'
      ,[QT_dechet] as'كمية المخلفات'
      ,[price_ttl] as'سعر المخلفات'
      ,[etas] as'الحالة'
  FROM [dbo].[TB_DECHET]
  inner join TB_MATIER_PREMIER on TB_MATIER_PREMIER.CODEBARRE = [TB_DECHET].ID_MATIER

















GO
/****** Object:  StoredProcedure [dbo].[get_detaiile_fctr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[get_detaiile_fctr]
@ID_fctr nvarchar(50) 
as 
SELECT [ID]
      ,[CODE_PRODUIT] as'رقم المنتوج'
	  ,TB_Produit_revente.designation  as'اسم المنتوج'
      ,[QUANTITE] as'الكمية'
      ,TB_ACHAT_PRODUIT_REVENT.[PRICE_ACHAT_HT] as'سعر الشراء HT'
      ,TB_ACHAT_PRODUIT_REVENT.[TVA] as'tva'
      ,TB_ACHAT_PRODUIT_REVENT.[PRICE_ACHAT_TTC] as'سعر الشراء TTC'
      ,[TOTAL_HT] as'المجموع HT'
      ,[TOTAL_TTC] as 'المجموع TTC' 
      ,[REMARQUE] as 'ملاحظة'
      ,[QUANTITE_BEFOR]  as'الكمية السابقة'
      ,[QUANTITE_AFTER]   as'الكمية الكلية'
  FROM [dbo].TB_ACHAT_PRODUIT_REVENT
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_ACHAT_PRODUIT_REVENT.CODE_PRODUIT
  where [ID_FACTURE] = @ID_fctr
















GO
/****** Object:  StoredProcedure [dbo].[GET_DETAILLE_CLIENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROC [dbo].[GET_DETAILLE_CLIENT]
@ID_CLIENT INT
AS
BEGIN
    SET NOCOUNT ON;

    SELECT 
        -- Selecting the correct CodeBarre and designation
        COALESCE(TB_Produit_revente.CodeBarre, TB_PACK_PRODUIT_REVENT.pack_code_barre) AS CodeBarre,
        COALESCE(TB_Produit_revente.designation, TB_PACK_PRODUIT_REVENT.pack_designation) AS designation,
        -- Other columns
        TB_VENTE.QUANTITE_VENTE,
        TB_VENTE.PRIX_VENTE,
        TB_VENTE.PRIX_TOTAL, 
        TB_VENTE.ID,
        TB_FACTURE_VENTE.NMR_FACTURE,
        TB_FACTURE_VENTE.DATE,
        TB_FACTURE_VENTE.HEURE, 
        TB_FACTURE_VENTE.TOTAL_FACURE_TTC,
        TB_FACTURE_VENTE.TOTAL_FACTURE_HT,
        TB_FACTURE_VENTE.TVA,
        TB_FACTURE_VENTE.OLD_SOLD,
        TB_FACTURE_VENTE.VERSEMENT,
        TB_FACTURE_VENTE.NEW_SOLD,
        TB_FACTURE_VENTE.REMISE,
        TB_FACTURE_VENTE.POURSENTAGE_REMISE,
        TB_FACTURE_VENTE.COUNT_ARTICLE,
        TB_FACTURE_VENTE.REMARQUE,
        TB_FACTURE_VENTE.ETAT,
        TB_FACTURE_VENTE.cout_of_fctr,
        TB_FACTURE_VENTE.tmbre,
        TB_FACTURE_VENTE.pricearabe,
        TB_USER.USERR,
        TB_USER.PASS,
        TB_USER.ROLE,
        TB_USER.ETAS,
        TB_OUVERIER.NAME,
        TB_OUVERIER.PRENAME,
        TB_OUVERIER.FONCTION,
        TB_OUVERIER.PHONE,
        TB_CLIENT.NAME  +' '+ TB_CLIENT.PRENAME AS ClientName ,
        TB_CLIENT.PHONE AS ClientPhone,
        TB_CLIENT.FAX,
        TB_CLIENT.EMAIL,
        TB_CLIENT.SOLD_TOTAL,
        TB_CLIENT.SOLD_PAYE,
        TB_CLIENT.SOLD_NON_PAYE,
        TB_CLIENT.ADRESSE,
        TB_CLIENT.Sold_avance,
        TB_CLIENT.MAX_CREDIT,
        TB_CLIENT.NIF,
        TB_CLIENT.RC,
        TB_CLIENT.Nic,
        TB_CLIENT.article,
        TB_CLIENT.originale_name_prename
    FROM TB_VENTE
    INNER JOIN TB_FACTURE_VENTE ON TB_FACTURE_VENTE.NMR_FACTURE = TB_VENTE.ID_FACTURE
    INNER JOIN TB_USER ON TB_USER.ID = TB_FACTURE_VENTE.ID_USER
    INNER JOIN TB_OUVERIER ON TB_OUVERIER.ID = TB_USER.ID_OUVERIER
    LEFT JOIN TB_Produit_revente ON TB_Produit_revente.CodeBarre = TB_VENTE.CODE_BARRE_PRODUIT
    LEFT JOIN TB_PACK_PRODUIT_REVENT ON TB_PACK_PRODUIT_REVENT.pack_code_barre = TB_VENTE.CODE_BARRE_PRODUIT
    INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_FACTURE_VENTE.ID_CLIENT
    WHERE TB_FACTURE_VENTE.ID_CLIENT = @ID_CLIENT;
END















GO
/****** Object:  StoredProcedure [dbo].[get_detailles_produit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_detailles_produit]
@ID_produit nvarchar(50)
as
SELECT [ID] as 'ID'
      ,[OPTION] as 'الخاصية'
      ,[VALEUR] as 'القيمة'
  FROM [dbo].[TB_OPTION_PRODUIT]
  where ID_PRODUIT = @ID_produit 

















GO
/****** Object:  StoredProcedure [dbo].[get_facturantion_on_state_week]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create PROC [dbo].[get_facturantion_on_state_week]
as

SELECT 
    [NMR_FACTURE] AS 'رقم الفاتورة',
    [DATE] AS 'التاريخ',
    CONVERT(VARCHAR(8), [HEURE], 108) AS 'الوقت',
    TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
	Total_ttc AS 'السعر الكلي TTC',
    [VERSEMENT] AS 'السعر المدفوع',
    [REMISE] AS 'الخصم',
    cout_fctr AS 'التكلفة',
    Total_ttc - cout_fctr AS 'الفائدة',
    TB_INFO_CAISSIER.NAME + ' ' + TB_INFO_CAISSIER.PRENAME AS 'القابض'
FROM 
    [dbo].TB_FACTURATION
INNER JOIN 
    TB_CLIENT ON TB_CLIENT.id = TB_FACTURATION.ID_CLIENT
INNER JOIN 
    TB_INFO_CAISSIER ON TB_INFO_CAISSIER.id = TB_FACTURATION.id_caissie
INNER JOIN 
    TB_USER ON TB_USER.id = TB_FACTURATION.ID_USER
INNER JOIN 
    TB_OUVERIER ON TB_OUVERIER.id = TB_USER.ID_OUVERIER
WHERE
    [DATE] BETWEEN DATEADD(day, -7, GETDATE()) AND DATEADD(day, -1, GETDATE());



GO
/****** Object:  StoredProcedure [dbo].[get_facturation_on_state]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
create PROC [dbo].[get_facturation_on_state]
@Date date
AS
SELECT 
    [NMR_FACTURE] AS 'رقم الفاتورة',
    [DATE] AS 'التاريخ',
    CONVERT(VARCHAR(8), [HEURE], 108) AS 'الوقت',
    TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
	Total_ttc AS 'السعر الكلي TTC',
    [VERSEMENT] AS 'السعر المدفوع',
    [REMISE] AS 'الخصم',
    cout_fctr AS 'التكلفة',
    Total_ttc - cout_fctr AS 'الفائدة',
    TB_INFO_CAISSIER.NAME + ' ' + TB_INFO_CAISSIER.PRENAME AS 'القابض'
FROM 
    [dbo].TB_FACTURATION
INNER JOIN 
    TB_CLIENT ON TB_CLIENT.id = TB_FACTURATION.ID_CLIENT
INNER JOIN 
    TB_INFO_CAISSIER ON TB_INFO_CAISSIER.id = TB_FACTURATION.id_caissie
INNER JOIN 
    TB_USER ON TB_USER.id = TB_FACTURATION.ID_USER
INNER JOIN 
    TB_OUVERIER ON TB_OUVERIER.id = TB_USER.ID_OUVERIER
WHERE 
    DATE = @date;




GO
/****** Object:  StoredProcedure [dbo].[get_facturation_on_state_Month]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create PROC [dbo].[get_facturation_on_state_Month]
as
SELECT 
    [NMR_FACTURE] AS 'رقم الفاتورة',
    [DATE] AS 'التاريخ',
    CONVERT(VARCHAR(8), [HEURE], 108) AS 'الوقت',
    TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
	Total_ttc AS 'السعر الكلي TTC',
    [VERSEMENT] AS 'السعر المدفوع',
    [REMISE] AS 'الخصم',
    cout_fctr AS 'التكلفة',
    Total_ttc - cout_fctr AS 'الفائدة',
    TB_INFO_CAISSIER.NAME + ' ' + TB_INFO_CAISSIER.PRENAME AS 'القابض'
FROM 
    [dbo].TB_FACTURATION
INNER JOIN 
    TB_CLIENT ON TB_CLIENT.id = TB_FACTURATION.ID_CLIENT
INNER JOIN 
    TB_INFO_CAISSIER ON TB_INFO_CAISSIER.id = TB_FACTURATION.id_caissie
INNER JOIN 
    TB_USER ON TB_USER.id = TB_FACTURATION.ID_USER
INNER JOIN 
    TB_OUVERIER ON TB_OUVERIER.id = TB_USER.ID_OUVERIER
WHERE
    [DATE] BETWEEN DATEADD(MONTH, -1, GETDATE()) AND DATEADD(day, -1, GETDATE());



GO
/****** Object:  StoredProcedure [dbo].[get_facture_attend]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_facture_attend]
as
SELECT [NMR_FACTURE] as'رقم الفاتورة'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME  as'الزبون'
      ,[TOTAL_FACURE_TTC] as'السعر الكلي TTC'
      ,[TOTAL_FACTURE_HT] as'السعر الكلي HT' 
      ,[TVA] as'TVA' 
  FROM [dbo].[TB_FACTURE_VENTE]
  inner join TB_CLIENT on TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
  inner join TB_USER on TB_USER.id = TB_FACTURE_VENTE.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.id = TB_USER.ID_OUVERIER
  where ETAS ='فاتورة قيد الانتظار'

















GO
/****** Object:  StoredProcedure [dbo].[get_facture_detailles]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_facture_detailles]
as
SELECT [NMR_FACTURE] as'رقم الفاتورة'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME  as'الزبون'
      ,[TOTAL_FACURE_TTC] as'السعر الكلي TTC'
      ,[TOTAL_FACTURE_HT] as'السعر الكلي HT' 
      ,[TVA] as'TVA'
      ,[OLD_SOLD] as'المبلغ القديم'
      ,[VERSEMENT] as'السعر المدفوع'
      ,[NEW_SOLD] as'المبلغ الجديد'
      ,[REMISE] as'الخصم'
      ,[POURSENTAGE_REMISE] as'نسبة الخصم'
      ,[COUNT_ARTICLE] as'عدد المنتجات'
      ,[TB_FACTURE_VENTE].[REMARQUE] as'ملاحظة'
      ,[ETAT] as'الحالة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_FACTURE_VENTE]
  inner join TB_CLIENT on TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
  inner join TB_USER on TB_USER.id = TB_FACTURE_VENTE.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.id = TB_USER.ID_OUVERIER

















GO
/****** Object:  StoredProcedure [dbo].[get_fctr_achat_matier_premier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_fctr_achat_matier_premier]
@ID_facture nvarchar(50)
as
SELECT [NMR_FCTR]
      ,[DATE]
      ,[NMBRE_PRODUIT]
      ,[VERSEMENT]
      ,[TOTAL]
      ,TB_FACTURE_ACHAT.[total_HT]
      ,[Creditprecidenet]
      ,[creditNew]
	  --//////////////////////
      ,TB_FOURNISSUER.[NAME]
      ,TB_FOURNISSUER.[PRENAME]
      ,TB_FOURNISSUER.[PHONE]
      ,TB_FOURNISSUER.[FAX]
      ,TB_FOURNISSUER.[EMAIL]
      ,TB_FOURNISSUER.[SOLD_TOTAL]
      ,TB_FOURNISSUER.[SOLD_PAYE]
      ,TB_FOURNISSUER.[SOLD_NON_PAYE]
      ,TB_FOURNISSUER.[ADRESSE]
      ,TB_FOURNISSUER.[NIF]
      ,TB_FOURNISSUER.[RC]
      ,TB_FOURNISSUER.[Nic]
      ,TB_FOURNISSUER.[article]
      ,TB_FOURNISSUER.[originale_name_prename]
	  --//////////////////////
      ,TB_OUVERIER.[NAME]
      ,TB_OUVERIER.[PRENAME]
      ,TB_OUVERIER.[FONCTION]
      ,TB_OUVERIER.[PHONE]
	  --//////////////////////
      ,TB_USER.[USERR]
      ,TB_USER.[PASS]
      ,TB_USER.[ROLE]  
	  --////////////////////// 
      ,TB_MATIER_PREMIER.CODEBARRE
      ,TB_MATIER_PREMIER.DESIGNATION
      ,[TB_ACHAT].[QUANTITE] 
      ,[QUANTITE_AFTER]
      ,[PRIX_ACHAT_HT]
      ,[TB_ACHAT].[TVA]
      ,[PRIX_ACHAT_TTC]
      ,[TB_ACHAT].[TOTAL_HT]
      ,[TOTAL_TTC]
      ,[TB_ACHAT].[REMARQUE] 
	  --////////////////////// 
  FROM [dbo].[TB_ACHAT]  
  inner join TB_FACTURE_ACHAT on TB_FACTURE_ACHAT.NMR_FCTR = [TB_ACHAT].ID_FACTURE
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT.ID_FRNSR
  inner join TB_MATIER_PREMIER on TB_MATIER_PREMIER.CODEBARRE = [TB_ACHAT].ID_PRODUIT
  inner join TB_USER on TB_USER.ID = TB_FACTURE_ACHAT.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where TB_ACHAT.ID_FACTURE = @ID_facture

















GO
/****** Object:  StoredProcedure [dbo].[get_fctr_on_state]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[get_fctr_on_state]
@Date date
AS
SELECT 
    [NMR_FACTURE] AS 'رقم الفاتورة',
    [DATE] AS 'التاريخ',
    CONVERT(VARCHAR(8), [HEURE], 108) AS 'الوقت',
    TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
    [TOTAL_FACURE_TTC] AS 'السعر الكلي TTC',
    [VERSEMENT] AS 'السعر المدفوع',
    [REMISE] AS 'الخصم',
    cout_of_fctr AS 'التكلفة',
    [TOTAL_FACURE_TTC] - cout_of_fctr AS 'الفائدة',
    TB_INFO_CAISSIER.NAME + ' ' + TB_INFO_CAISSIER.PRENAME AS 'القابض'
FROM 
    [dbo].[TB_FACTURE_VENTE]
INNER JOIN 
    TB_CLIENT ON TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
INNER JOIN 
    TB_INFO_CAISSIER ON TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
INNER JOIN 
    TB_USER ON TB_USER.id = TB_FACTURE_VENTE.ID_USER
INNER JOIN 
    TB_OUVERIER ON TB_OUVERIER.id = TB_USER.ID_OUVERIER
WHERE 
    DATE = @date;




GO
/****** Object:  StoredProcedure [dbo].[get_fctr_on_state_Month]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create PROC [dbo].[get_fctr_on_state_Month]
as
SELECT 
    [NMR_FACTURE] AS 'رقم الفاتورة',
    [DATE] AS 'التاريخ',
    CONVERT(VARCHAR(8), [HEURE], 108) AS 'الوقت',
    TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
    [TOTAL_FACURE_TTC] AS 'السعر الكلي TTC',
    [VERSEMENT] AS 'السعر المدفوع',
    [REMISE] AS 'الخصم',
    cout_of_fctr AS 'التكلفة',
    [TOTAL_FACURE_TTC] - cout_of_fctr AS 'الفائدة',
    TB_INFO_CAISSIER.NAME + ' ' + TB_INFO_CAISSIER.PRENAME AS 'القابض'
FROM 
    [dbo].[TB_FACTURE_VENTE]
INNER JOIN 
    TB_CLIENT ON TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
INNER JOIN 
    TB_INFO_CAISSIER ON TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
INNER JOIN 
    TB_USER ON TB_USER.id = TB_FACTURE_VENTE.ID_USER
INNER JOIN 
    TB_OUVERIER ON TB_OUVERIER.id = TB_USER.ID_OUVERIER
WHERE
    [DATE] BETWEEN DATEADD(MONTH, -1, GETDATE()) AND DATEADD(day, -1, GETDATE());



GO
/****** Object:  StoredProcedure [dbo].[get_fctr_on_state_week]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create PROC [dbo].[get_fctr_on_state_week]
as
SELECT 
    [NMR_FACTURE] AS 'رقم الفاتورة',
    [DATE] AS 'التاريخ',
    CONVERT(VARCHAR(8), [HEURE], 108) AS 'الوقت',
    TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
    [TOTAL_FACURE_TTC] AS 'السعر الكلي TTC',
    [VERSEMENT] AS 'السعر المدفوع',
    [REMISE] AS 'الخصم',
    cout_of_fctr AS 'التكلفة',
    [TOTAL_FACURE_TTC] - cout_of_fctr AS 'الفائدة',
    TB_INFO_CAISSIER.NAME + ' ' + TB_INFO_CAISSIER.PRENAME AS 'القابض'
FROM 
    [dbo].[TB_FACTURE_VENTE]
INNER JOIN 
    TB_CLIENT ON TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
INNER JOIN 
    TB_INFO_CAISSIER ON TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
INNER JOIN 
    TB_USER ON TB_USER.id = TB_FACTURE_VENTE.ID_USER
INNER JOIN 
    TB_OUVERIER ON TB_OUVERIER.id = TB_USER.ID_OUVERIER
WHERE
    [DATE] BETWEEN DATEADD(day, -7, GETDATE()) AND DATEADD(day, -1, GETDATE());



GO
/****** Object:  StoredProcedure [dbo].[get_fctrrr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_fctrrr]
as 
SELECT [ID]
      ,[MacAdress]
      ,[Serial]
      ,[instal_Day]
  FROM [dbo].[TB_MAX_ADRESS]

















GO
/****** Object:  StoredProcedure [dbo].[get_fichier_facture_produit_prevent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[get_fichier_facture_produit_prevent]
as 
SELECT [TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE].[ID] 
      ,[ID_FACTURE] as'رقم الفاتورة'
	  ,TB_FACTURE_ACHAT_PRODUIT_REVENT.DATE 'تاريخ الفاتورة'
	  ,TB_FOURNISSUER.NAME+' '+TB_FOURNISSUER.PRENAME 'مورد الفاتورة'
      ,[REMARQUE] 'ملاحظة'
  FROM [dbo].[TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE]
  inner join TB_FACTURE_ACHAT_PRODUIT_REVENT on TB_FACTURE_ACHAT_PRODUIT_REVENT.NMR_FCTR = [TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE].[ID_FACTURE]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT_PRODUIT_REVENT.ID_FOURNISSEUR
















GO
/****** Object:  StoredProcedure [dbo].[get_frnser_sold]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_frnser_sold]
@id int
as
SELECT [ID]
      ,[NAME]
      ,[PRENAME]
      ,[PHONE]
      ,[FAX]
      ,[EMAIL]
      ,[SOLD_TOTAL]
      ,[SOLD_PAYE]
      ,[SOLD_NON_PAYE]
      ,[ADRESSE]
      ,[NIF]
      ,[RC]
      ,[Nic]
      ,[article]
      ,[originale_name_prename]
  FROM [dbo].[TB_FOURNISSUER]
  where id = @ID

















GO
/****** Object:  StoredProcedure [dbo].[get_historique_Caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_historique_Caissier]
@ID_caissier int ,
@Data date 
as
SELECT [ID]
      ,[ID_CAISSIE]
      ,[DATE]
      ,[HEURE_ENTRE]
      ,[HEURE_SORTIE]
      ,[PRIX_FOND]
      ,[PRIX_CLOTURE]
  FROM [dbo].[TB_HISTORIQUE_CAISSIER]
  where [ID_CAISSIE] = @ID_caissier AND [DATE]=@Data

















GO
/****** Object:  StoredProcedure [dbo].[get_historique_Caissier_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_historique_Caissier_by_date] 
@Data date 
as
SELECT [ID]
      ,[ID_CAISSIE]
      ,[DATE]
      ,[HEURE_ENTRE]
      ,[HEURE_SORTIE]
      ,[PRIX_FOND]
      ,[PRIX_CLOTURE]
  FROM [dbo].[TB_HISTORIQUE_CAISSIER]
  where  [DATE]=@Data

















GO
/****** Object:  StoredProcedure [dbo].[get_historique_caissiera]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_historique_caissiera]
as
SELECT [TB_HISTORIQUE_CAISSIER].[ID]
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME  as'القابض'
      ,[DATE] as'التاريخ'
      ,[HEURE_ENTRE] as'وقت الدخول'
      ,[HEURE_SORTIE] as'وقت الخروج'
      ,[PRIX_FOND] as'ثمن الدخول'
      ,[PRIX_CLOTURE] as'ثمن الخروج'
  FROM [dbo].[TB_HISTORIQUE_CAISSIER]
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_HISTORIQUE_CAISSIER.ID_CAISSIE

















GO
/****** Object:  StoredProcedure [dbo].[get_image_folder]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[get_image_folder]
@id int
AS
SELECT IMAGE
  FROM [dbo].[TB_UPLOAD_FICHIER_FACTURE]
  where ID=@id
















GO
/****** Object:  StoredProcedure [dbo].[get_image_folder_produit_revernet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[get_image_folder_produit_revernet]
@id int
AS
SELECT IMAGE
  FROM [dbo].TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE
  where ID=@id















GO
/****** Object:  StoredProcedure [dbo].[get_Img_fichier_facture_produit_prevent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[get_Img_fichier_facture_produit_prevent]
@ID int
as 
SELECT [TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE].[ID] 
      ,[ID_FACTURE] as'رقم الفاتورة'
	  ,TB_FACTURE_ACHAT_PRODUIT_REVENT.DATE 'تاريخ الفاتورة'
	  ,TB_FOURNISSUER.NAME+' '+TB_FOURNISSUER.PRENAME 'مورد الفاتورة'
      ,[REMARQUE] 'ملاحظة'
  FROM [dbo].[TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE]
  inner join TB_FACTURE_ACHAT_PRODUIT_REVENT on TB_FACTURE_ACHAT_PRODUIT_REVENT.ID_FOURNISSEUR = [TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE].[ID_FACTURE]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT_PRODUIT_REVENT.ID_FOURNISSEUR
  
  where    
  		[TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE].ID=@ID
















GO
/****** Object:  StoredProcedure [dbo].[get_info_Pack_edit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[get_info_Pack_edit]
@CodeBarre nvarchar(50)
as
SELECT [pack_code_barre]
      ,[pack_designation]
      ,[code_barre_produit]
      ,[quantite]
      ,[price_unitair]
      ,[photo]
      ,[id_favoire]
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  left join TB_FAVORIS on TB_FAVORIS.ID = TB_PACK_PRODUIT_REVENT.id_favoire
  where pack_code_barre = @CodeBarre















GO
/****** Object:  StoredProcedure [dbo].[get_info_produit_finaux]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_info_produit_finaux]
@code_barre nvarchar(50)
as
SELECT [CODE_BARRE]
      ,[DESIGNATION]
      ,[QT_PARAMETRAGE]
      ,[UNITE]
      ,[CATEGORIE]
      ,[COUT_DE_PRODUCTION]
      ,[QT_DANS_PACK]
      ,[QT_TOTAL]
      ,[QT_VENTE]
      ,[QT_REST]
      ,[QT_DECHET]
      ,[PRICE_VENTE_HT]
      ,[PRICE_VENTE_TTC]
      ,[TVA]
      ,[PRICE_GROS]
      ,[PRICE_MIN]
      ,[qt_alter]
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  where CODE_BARRE = @code_barre

















GO
/****** Object:  StoredProcedure [dbo].[get_inforamtion]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_inforamtion]
as
SELECT [NAME]
      ,[PRENAME]
      ,[ADRESS]
      ,[ACTIVITY]
      ,[NMR_REGISTRE]
      ,[NMR_MATIER]
      ,[NMR_JIBAI]
      ,[LOGO]
      ,[ID]
      ,[WILAYA]
      ,CompanyName
	  ,Phone
	  ,Message
  FROM [dbo].[TB_PARAMETRE_INFO]

















GO
/****** Object:  StoredProcedure [dbo].[GET_INFORATION_FOR_AFFICHER_PRODUIT_REVENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
    
CREATE PROC [dbo].[GET_INFORATION_FOR_AFFICHER_PRODUIT_REVENT]
@CODE_BARRE NVARCHAR(50)
AS
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,[TB_Produit_revente].Photo 
	  ,[Quantite_rest]/[QT_DANS_PACK] as'الكمية المتبقية بالحزمة'
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille  
  WHERE TB_Produit_revente.CodeBarre = @CODE_BARRE












GO
/****** Object:  StoredProcedure [dbo].[get_information_bon]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_information_bon]
@ID_bon nvarchar(50)
as 
SELECT [NMR_FACTURE]
      ,[DATE]
      ,[HEURE]
      ,[ID_CLIENT]
      ,[TOTAL_FACURE_TTC]
      ,[TOTAL_FACTURE_HT]
      ,[TVA]
      ,[OLD_SOLD]
      ,[VERSEMENT]
      ,[NEW_SOLD]
      ,[REMISE]
      ,[POURSENTAGE_REMISE]
      ,[COUNT_ARTICLE]
      ,[REMARQUE]
      ,[ETAT]
      ,[ID_USER]
      ,[ID_CAISSIER]
      ,[cout_of_fctr]
      ,[tmbre]
      ,[pricearabe]
  FROM [dbo].[TB_FACTURE_VENTE]
  where NMR_FACTURE =@ID_bon

GO
/****** Object:  StoredProcedure [dbo].[get_information_bon_frnsre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_information_bon_frnsre]
@ID int
as
SELECT [TB_HISTORIQUE_FOURNISSEUR].[ID]
      ,[DATE]
      ,TB_FOURNISSUER.NAME +' '+TB_FOURNISSUER.PRENAME as'frnsre'
      ,[PRICE]
      ,[CREDIT_OLD]
      ,[CREDIT_NEW]
      ,[REMARQUE]
  FROM [dbo].[TB_HISTORIQUE_FOURNISSEUR]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_HISTORIQUE_FOURNISSEUR.ID_CLIENT
  where [TB_HISTORIQUE_FOURNISSEUR].ID= @ID

















GO
/****** Object:  StoredProcedure [dbo].[get_information_by_code_Reserve]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[get_information_by_code_Reserve]
    @codeBarre_Reserve NVARCHAR(50)
AS
BEGIN
    SELECT 
        TCBR.[code_barre_produit],
        TPR.[designation],
        TPR.[price_vente1],
        TPR.[price_vente2],
        TPR.[price_min],
        TPR.[Quantite_rest],
        TCBR.[code_barre_reserve],
        TCBR.[id]
    FROM 
        [dbo].[TB_CODE_BARRE_RESERVE] AS TCBR
    INNER JOIN 
        TB_Produit_revente AS TPR
    ON 
        TPR.[CodeBarre] = TCBR.[code_barre_produit]
    WHERE 
        TCBR.[code_barre_reserve] = @codeBarre_Reserve;
END

















GO
/****** Object:  StoredProcedure [dbo].[get_information_by_code_Reserve_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROCEDURE  [dbo].[get_information_by_code_Reserve_pack]
    @codeBarre_Reserve NVARCHAR(50)
AS
BEGIN
    SELECT 
        TCBR.CODE_BARRE_OFFICIAL,
        TPR.pack_designation,
        TPR.price_unitair, 
        TPR.[code_barre_produit],
        TCBR.CODE_BARRE_RESERVER,
        TCBR.[id]
    FROM 
        [dbo].[TB_CODE_BARRE_RESERVER_PACK] AS TCBR
    INNER JOIN 
        TB_PACK_PRODUIT_REVENT AS TPR
    ON 
        TPR.pack_code_barre = TCBR.CODE_BARRE_OFFICIAL
    WHERE 
        TCBR.[CODE_BARRE_RESERVER] = @codeBarre_Reserve;
END
















GO
/****** Object:  StoredProcedure [dbo].[get_information_caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[get_information_caissier]
@id int
as
SELECT [ID]
      ,[NAME]+' '+[PRENAME] as'Name'
      ,[USER-NAME]
      ,[PASSW]
  FROM [dbo].[TB_INFO_CAISSIER]
  where [TB_INFO_CAISSIER].ID =@id




GO
/****** Object:  StoredProcedure [dbo].[GET_INFORMATION_FACTURE_VIERGE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[GET_INFORMATION_FACTURE_VIERGE]
@ID_FACTURE NVARCHAR(50)
AS
SELECT [ID] as'ID'
      ,[NAME] as'الاسم'
      ,[PRIX_UNITE] as'سعر الوحدة'
      ,[QUANTITE] as'الكمية'
      ,[TOTAL] as'السعر الكلي' 
  FROM [dbo].[TB_PRODUIT_OF_FCTR_VIERGE]
	WHERE ID_FACTURE = @ID_FACTURE

















GO
/****** Object:  StoredProcedure [dbo].[get_information_invoise_fct_vierge]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[get_information_invoise_fct_vierge]
@ID_FACTURE NVARCHAR(50)
AS
SELECT [TB_PRODUIT_OF_FCTR_VIERGE].[ID] as'ID'
      ,[TB_PRODUIT_OF_FCTR_VIERGE].[NAME] as'الاسم'
      ,[PRIX_UNITE] as'سعر الوحدة'
      ,[QUANTITE] as'الكمية'
      ,[TOTAL] as'السعر الكلي'
	  ,TB_PRINCIPE_FACTURE.[NMR_FACTURE] as'رقم الفاتورة'
	  ,TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME as'الزبون'
	  ,[TB_PRINCIPE_fACTURE].[DATE] as'التاريخ'
	  ,ROUND([TB_PRINCIPE_fACTURE].[TOTAL_HT],2) as'المبلغ الكلي HT'
	  ,ROUND([TB_PRINCIPE_fACTURE].[TVA],2) as'TVA %'
	  ,ROUND([TB_PRINCIPE_fACTURE].[TMBRE],2) as' % الطابع'
	  ,ROUND([TB_PRINCIPE_fACTURE].[TOTAL_TTC],2) as'المبلغ الكلي TTC'
	  ,ROUND([TB_PRINCIPE_fACTURE].[VERSE],2) as'المدفوع'
	  ,ROUND([TB_PRINCIPE_fACTURE].[REST],2) as'المتبقي'
	  ,TB_PRINCIPE_FACTURE.prix_arabe 
	  ,TB_OUVERIER.NAME+ ' '+TB_OUVERIER.PRENAME as'المستخدم'
	  ,TB_CLIENT.[PHONE] 
      ,TB_CLIENT.[EMAIL]
	  ,TB_CLIENT.[NIF]
      ,TB_CLIENT.[RC]
      ,TB_CLIENT.[Nic]
      ,TB_CLIENT.[article]
      ,TB_CLIENT.[originale_name_prename]
	  ,TB_CLIENT.[ADRESSE] 
  FROM [dbo].[TB_PRODUIT_OF_FCTR_VIERGE]
  inner join TB_PRINCIPE_FACTURE on TB_PRINCIPE_FACTURE.NMR_FACTURE = TB_PRODUIT_OF_FCTR_VIERGE.ID_FACTURE 
  inner join TB_CLIENT on TB_CLIENT.id = [TB_PRINCIPE_fACTURE].[ID_CLIENT]
  inner join TB_USER on TB_USER.id = [TB_PRINCIPE_fACTURE].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
	WHERE ID_FACTURE = @ID_FACTURE
	 


















GO
/****** Object:  StoredProcedure [dbo].[get_information_matier_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_information_matier_revent]
@codeBarre nvarchar(50)
as
SELECT [CodeBarre]
      ,[designation]
      ,[reference]
      ,[id_categories]
      ,[id_stocke]
      ,[id_marque]
      ,TB_UNITE.UNITE as'Unite'
      ,[id_taille]
      ,[id_color]
      ,[id_favoire]
      ,[date_expiration]
      ,[price_achat_HT]
      ,[price_achat_TTC]
      ,[TVA]
      ,[Quantite_TOTAL]
      ,[price_vente1]
      ,[price_vente2]
      ,[price_min]
      ,[vente_apres_expiration]
      ,[stocke_negatif]
      ,[Quantite_vente]
      ,[Quantite_rest]
      ,[Quantite_dechet]
      ,[Photo]
      ,[QT_DANS_PACK]
	  ,Quantite_alert
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID = TB_Produit_revente.id_unite
  where CodeBarre = @codeBarre

















GO
/****** Object:  StoredProcedure [dbo].[get_information_user]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_information_user]
@id int 
as
SELECT TB_USER.ID
      ,[ID_OUVERIER] 
	  ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'Name'
  FROM [dbo].[TB_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where TB_USER.ID =@id




GO
/****** Object:  StoredProcedure [dbo].[get_list_detaille_facture_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_list_detaille_facture_vente] 
as 
SELECT [ID] 
      ,[CODE_BARRE] as'رقم المنتج'
      ,[DESIGNATION] as'اسم المنتج'
      ,[N_COLIS] as'ع حزم'
      ,[COLISSAGE] as'التغليف'
      ,[QTE] as'الكمية'
      ,[PRIC_U] as'سعر وحدة'
      ,[PRIE_TTL] as'السعر الكلي'
      ,[REMISE] as'الخصم'
      ,[PRICE_APRES_REMISE] as'السعر بعد الخصم'
      ,[PRNST] as'نسبة الخصم'
	  ,nmr_fctr as'رقم الفاتورة'
  FROM [dbo].[TB_FACTURATION_VENTE] 

GO
/****** Object:  StoredProcedure [dbo].[get_list_detaille_facture_vente_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_list_detaille_facture_vente_by_date]
@Date date 
as 
SELECT [ID] 
      ,[CODE_BARRE] as'رقم المنتج'
      ,[DESIGNATION] as'اسم المنتج'
      ,[N_COLIS] as'ع حزم'
      ,[COLISSAGE] as'التغليف'
      ,[QTE] as'الكمية'
      ,[PRIC_U] as'سعر وحدة'
      ,[PRIE_TTL] as'السعر الكلي'
      ,[TB_FACTURATION_VENTE].[REMISE] as'الخصم'
      ,[PRICE_APRES_REMISE] as'السعر بعد الخصم'
      ,[PRNST] as'نسبة الخصم'
	  ,nmr_fctr as'رقم الفاتورة'
  FROM [dbo].[TB_FACTURATION_VENTE] 
  inner join TB_FACTURATION on TB_FACTURATION.Nmr_facture = TB_FACTURATION_VENTE.nmr_fctr
  where TB_FACTURATION.date=@Date

GO
/****** Object:  StoredProcedure [dbo].[get_list_fournisseur]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_list_fournisseur]
as
SELECT [ID] as'ID'
      ,[NAME] as'الاسم'
      ,[PRENAME] as'اللقب'
	  ,[ADRESSE] as'العنوان'
      ,[PHONE] as'الهاتف'
      ,[FAX] as'الفاكس'
      ,[EMAIL] as'الإيميل'
      ,[SOLD_TOTAL] as'المبلغ الكلي'
      ,[SOLD_PAYE] as'المبلغ المدفوع'
      ,[SOLD_NON_PAYE] as'المبلغ الغير مدفوع' 
	   ,NIF as 'NIF'
	   ,RC as 'RC'
	   ,Nic as 'Nic'
	   ,article as 'Article'
  FROM [dbo].[TB_FOURNISSUER]

















GO
/****** Object:  StoredProcedure [dbo].[get_list_historique_achat_produit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
--//////////////////////////
create proc [dbo].[get_list_historique_achat_produit]
@ID_Produit nvarchar(50)
as 
SELECT [ID] 
	  ,TB_FACTURE_ACHAT_PRODUIT_REVENT.DATE as'التاريخ' 
      ,[QUANTITE] as'الكمية'
      ,[PRICE_ACHAT_HT] as'سعر الشراء HT'
      ,[TVA] as'TVA'
      ,[PRICE_ACHAT_TTC] as'سعر الشراء TTC'
      ,[TB_ACHAT_PRODUIT_REVENT].[TOTAL_HT] as'السعر الكلي HT'
      ,[TOTAL_TTC] as'السعر الكلي TTC' 
      ,[ID_FACTURE] as'رمز الفاتورة'
      ,[QUANTITE_BEFOR] as'الكمية القديمة في المخزن'
      ,[QUANTITE_AFTER] as'الكمية الجديدة في المخزن'
  FROM [dbo].[TB_ACHAT_PRODUIT_REVENT]
  inner join TB_FACTURE_ACHAT_PRODUIT_REVENT on TB_FACTURE_ACHAT_PRODUIT_REVENT.NMR_FCTR = TB_ACHAT_PRODUIT_REVENT.ID_FACTURE
  where CODE_PRODUIT = @ID_Produit 












GO
/****** Object:  StoredProcedure [dbo].[get_list_historique_vente_produit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
  
--//////////////////////
create proc [dbo].[get_list_historique_vente_produit]
@ID_Produit nvarchar(50)
as 
SELECT [ID],
	  TB_FACTURE_VENTE.DATE as'التاريخ', 
	   TB_FACTURE_VENTE.HEURE as'الوقت'
	  ,[CODE_BARRE_PRODUIT] as 'رقم المنتج'
      ,[QUANTITE_VENTE] as'الكمية المباعة'
      ,[PRIX_VENTE] as'سعر البيع'
      ,[PRIX_TOTAL] as'السعر الكلي'
      ,[ID_FACTURE] as'رقم الفاتورة'  
  FROM [dbo].[TB_VENTE]
  inner join TB_FACTURE_VENTE on TB_FACTURE_VENTE.NMR_FACTURE = [TB_VENTE].ID_FACTURE
  where [CODE_BARRE_PRODUIT] = @ID_Produit 












GO
/****** Object:  StoredProcedure [dbo].[get_list_historique_vente_produit_par_mois]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_list_historique_vente_produit_par_mois]
@ID_Produit nvarchar(50)
as 
SELECT 
    DATEPART(YEAR, TB_FACTURE_VENTE.DATE) AS 'السنة',
    DATEPART(MONTH, TB_FACTURE_VENTE.DATE) AS 'الشهر', 
    SUM([QUANTITE_VENTE]) AS 'الكمية المباعة'
FROM 
    [dbo].[TB_VENTE]
INNER JOIN 
    TB_FACTURE_VENTE ON TB_FACTURE_VENTE.NMR_FACTURE = [TB_VENTE].ID_FACTURE
WHERE 
    [CODE_BARRE_PRODUIT] = @ID_Produit
GROUP BY 
    DATEPART(YEAR, TB_FACTURE_VENTE.DATE),
    DATEPART(MONTH, TB_FACTURE_VENTE.DATE)
ORDER BY 
    DATEPART(YEAR, TB_FACTURE_VENTE.DATE),
    DATEPART(MONTH, TB_FACTURE_VENTE.DATE)








GO
/****** Object:  StoredProcedure [dbo].[get_list_ouverie]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_list_ouverie]
as
SELECT [ID] as'ID'
      ,[NAME] as'اللقب'
      ,[PRENAME] as'الاسم'
      ,[FONCTION] as'المهنة'
      ,[PHONE] as'الهاتف'
  FROM [dbo].[TB_OUVERIER]

















GO
/****** Object:  StoredProcedure [dbo].[get_list_stocke]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_list_stocke]
as
SELECT [ID] as'ID'
      ,[STOCKE] as'اسم المخزن'
  FROM [dbo].[TB_STOCK]

















GO
/****** Object:  StoredProcedure [dbo].[GET_LIST_UPLOAD_FACTURE_ACHAT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[GET_LIST_UPLOAD_FACTURE_ACHAT]
AS
SELECT [ID]
      ,[ID_FACTURE] AS'رقم الفاتورة'
      ,[REMARQUE] AS'ملاحظة' 
  FROM [dbo].[TB_UPLOAD_FICHIER_FACTURE]

















GO
/****** Object:  StoredProcedure [dbo].[get_list_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[get_list_vente]
@ETAS NVARCHAR(50)
AS
BEGIN
    -- استعلام موحد لجلب البيانات بدون تكرار مع فصل التاريخ والوقت
    SELECT DISTINCT
        v.ID AS 'ID',
        CAST(fv.DATE AS DATE)   AS 'التاريخ',  
		CONVERT(VARCHAR(8), fv.HEURE, 108) AS'الوقت' ,
		v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        COALESCE(pr.designation, p.pack_designation, pf.DESIGNATION, pd.DESIGNATION, NULL) AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر البيع',
		COALESCE(pr.price_vente1, p.price_unitair, pf.PRICE_VENTE_TTC, pd.PRICE_DETAILLE, NULL) AS 'سعر المنتج',
        v.PRIX_TOTAL AS 'السعر الكلي',
        fv.NMR_FACTURE AS 'رقم الفاتورة'
    FROM tb_vente v 
    LEFT JOIN 
		TB_Produit_revente pr ON pr.CodeBarre = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_PACK_PRODUIT_REVENT p ON p.pack_code_barre = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_GESTION_PRODUIT_FINAUX pf ON pf.CODE_BARRE = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_PACK_GESTION_PRODUIT_FINAUX pd ON pd.BARCODE_PACK = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_FACTURE_VENTE fv ON fv.NMR_FACTURE = v.ID_FACTURE

    WHERE fv.ETAT = @ETAS
END



GO
/****** Object:  StoredProcedure [dbo].[get_list_vente_By_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[get_list_vente_By_date]
    @DATE DATETIME
AS
BEGIN
    -- جدول مؤقت لتخزين النتائج
    DECLARE @Results TABLE (
        ID INT,
        Date DATETIME,
        [Code-barre] NVARCHAR(50),
        Designation NVARCHAR(255),
        Qt FLOAT,
        [Prixe U] decimal(18, 2),
        [Prixe TTL] decimal(18, 2)
    );

    -- استعلام فرعي لاستخراج code-barre من tb_vente 
    DECLARE @codeBarre NVARCHAR(50);
    DECLARE vente_cursor CURSOR FOR
    SELECT [CODE_BARRE_PRODUIT] FROM tb_vente;

    OPEN vente_cursor;
    FETCH NEXT FROM vente_cursor INTO @codeBarre;

    WHILE @@FETCH_STATUS = 0
    BEGIN
        -- تحقق من وجود code-barre في tb_produit_revent
        IF EXISTS (SELECT 1 FROM TB_Produit_revente WHERE CodeBarre = @codeBarre)
        BEGIN
            -- جلب البيانات من tb_vente و tb_produit_revent
            INSERT INTO @Results
            SELECT 
                v.ID AS 'ID',
                TB_FACTURE_VENTE.DATE as 'التاريخ والوقت',
                v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
                pr.designation AS 'اسم المنتوج',
                v.QUANTITE_VENTE AS 'كمية المنتوج',
                v.PRIX_VENTE AS 'سعر المنتوج',
                v.PRIX_TOTAL AS 'السعر الكلي'
            FROM tb_vente v
            INNER JOIN TB_Produit_revente pr ON pr.CodeBarre = v.CODE_BARRE_PRODUIT 
            INNER JOIN TB_FACTURE_VENTE ON TB_FACTURE_VENTE.NMR_FACTURE = v.ID_FACTURE
            WHERE v.CODE_BARRE_PRODUIT = @codeBarre
            AND TB_FACTURE_VENTE.DATE = @DATE;
        END
        ELSE IF EXISTS (SELECT 1 FROM TB_PACK_PRODUIT_REVENT WHERE pack_code_barre = @codeBarre)
        BEGIN
            -- جلب البيانات من tb_vente و tb_pack
            INSERT INTO @Results
            SELECT 
                v.ID AS 'ID',
                fc.DATE as 'التاريخ والوقت',
                v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
                p.pack_designation AS 'اسم المنتوج',
                v.QUANTITE_VENTE AS 'كمية المنتوج',
                v.PRIX_VENTE AS 'سعر المنتوج',
                v.PRIX_TOTAL AS 'السعر الكلي'
            FROM tb_vente v
            INNER JOIN TB_PACK_PRODUIT_REVENT p ON p.pack_code_barre = v.CODE_BARRE_PRODUIT 
            INNER JOIN TB_FACTURE_VENTE fc ON fc.NMR_FACTURE = v.ID_FACTURE
            WHERE v.CODE_BARRE_PRODUIT = @codeBarre
            AND fc.DATE = @DATE;
        END
        ELSE IF EXISTS (SELECT 1 FROM TB_GESTION_PRODUIT_FINAUX WHERE CODE_BARRE = @codeBarre)
        BEGIN
            -- جلب البيانات من tb_vente و produit_fabrique
            INSERT INTO @Results
            SELECT 
                v.ID AS 'ID',
                fd.DATE as 'التاريخ والوقت',
                v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
                pf.DESIGNATION AS 'اسم المنتوج',
                v.QUANTITE_VENTE AS 'كمية المنتوج',
                v.PRIX_VENTE AS 'سعر المنتوج',
                v.PRIX_TOTAL AS 'السعر الكلي'
            FROM tb_vente v
            INNER JOIN TB_GESTION_PRODUIT_FINAUX pf ON pf.CODE_BARRE = v.CODE_BARRE_PRODUIT 
            INNER JOIN TB_FACTURE_VENTE fd ON fd.NMR_FACTURE = v.ID_FACTURE
            WHERE v.CODE_BARRE_PRODUIT = @codeBarre
            AND fd.DATE = @DATE;
        END
        ELSE IF EXISTS (SELECT 1 FROM TB_PACK_GESTION_PRODUIT_FINAUX WHERE BARCODE_PACK = @codeBarre)
        BEGIN
            -- جلب البيانات من tb_vente و produit_fabrique
            INSERT INTO @Results
            SELECT 
                v.ID AS 'ID',
                fr.DATE as 'التاريخ والوقت',
                v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
                pd.DESIGNATION AS 'اسم المنتوج',
                v.QUANTITE_VENTE AS 'كمية المنتوج',
                v.PRIX_VENTE AS 'سعر المنتوج',
                v.PRIX_TOTAL AS 'السعر الكلي'
            FROM tb_vente v
            INNER JOIN TB_PACK_GESTION_PRODUIT_FINAUX pd ON pd.BARCODE_PACK = v.CODE_BARRE_PRODUIT 
            INNER JOIN TB_FACTURE_VENTE fr ON fr.NMR_FACTURE = v.ID_FACTURE
            WHERE v.CODE_BARRE_PRODUIT = @codeBarre
            AND fr.DATE = @DATE;
        END
        ELSE
        BEGIN
            -- جلب البيانات من tb_vente بدون انضمام
            INSERT INTO @Results
            SELECT 
                [ID] AS 'ID',
                fv.DATE as 'التاريخ والوقت',
                [CODE_BARRE_PRODUIT] AS 'رقم المنتوج',
                NULL AS 'اسم المنتوج',
                [QUANTITE_VENTE] AS 'كمية المنتوج',
                [PRIX_VENTE] AS 'سعر المنتوج',
                [PRIX_TOTAL] AS 'السعر الكلي'
            FROM tb_vente 
            INNER JOIN TB_FACTURE_VENTE fv ON fv.NMR_FACTURE = tb_vente.ID_FACTURE
            WHERE fv.DATE = @DATE;
        END

        FETCH NEXT FROM vente_cursor INTO @codeBarre;
    END

    CLOSE vente_cursor;
    DEALLOCATE vente_cursor;

    -- عرض النتائج
    SELECT * FROM @Results;
END















GO
/****** Object:  StoredProcedure [dbo].[get_list_vente_by_DATEE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[get_list_vente_by_DATEE] 
@Date DATE,
@ETAS nvarchar(50)
AS
BEGIN
SELECT DISTINCT
        v.ID AS 'ID', 
        CAST(fv.DATE AS DATE) AS 'التاريخ', 
		CONVERT(VARCHAR(8), fv.HEURE, 108) AS 'الوقت' ,
        v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        COALESCE(pr.designation, p.pack_designation, pf.DESIGNATION, pd.DESIGNATION, NULL) AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر البيع',
		COALESCE(pr.price_vente1, p.price_unitair, pf.PRICE_VENTE_TTC, pd.PRICE_DETAILLE, NULL) AS 'سعر المنتج',
        v.PRIX_TOTAL AS 'السعر الكلي',
		fv.NMR_FACTURE as'رقم الفاتورة'
    FROM tb_vente v
    LEFT JOIN TB_Produit_revente pr ON pr.CodeBarre = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_PACK_PRODUIT_REVENT p ON p.pack_code_barre = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_GESTION_PRODUIT_FINAUX pf ON pf.CODE_BARRE = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_PACK_GESTION_PRODUIT_FINAUX pd ON pd.BARCODE_PACK = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_FACTURE_VENTE fv ON fv.NMR_FACTURE = v.ID_FACTURE
    WHERE fv.DATE = @Date AND  fv.ETAT = @ETAS
END




GO
/****** Object:  StoredProcedure [dbo].[get_list_vente_credit_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create PROCEDURE [dbo].[get_list_vente_credit_client]
@ETAS nvarchar(50),
@id_client int 
AS
BEGIN
    -- استعلام موحد لجلب البيانات بدون تكرار
    SELECT DISTINCT
        v.ID AS 'ID',
        fv.DATE AS 'التاريخ والوقت',
        v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        COALESCE(pr.designation, p.pack_designation, pf.DESIGNATION, pd.DESIGNATION, NULL) AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر المنتوج',
        v.PRIX_TOTAL AS 'السعر الكلي',
		fv.NMR_FACTURE as'رقم الفاتورة'
    FROM tb_vente v
    LEFT JOIN TB_Produit_revente pr ON pr.CodeBarre = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_PACK_PRODUIT_REVENT p ON p.pack_code_barre = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_GESTION_PRODUIT_FINAUX pf ON pf.CODE_BARRE = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_PACK_GESTION_PRODUIT_FINAUX pd ON pd.BARCODE_PACK = v.CODE_BARRE_PRODUIT
    LEFT JOIN TB_FACTURE_VENTE fv ON fv.NMR_FACTURE = v.ID_FACTURE  
    WHERE  fv.ETAT = @ETAS and fv.ID_CLIENT= @id_client
END







GO
/****** Object:  StoredProcedure [dbo].[get_MATIER_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_MATIER_commande]
@ID_sub_commande nvarchar(50)
as
   SELECT  
    ID,
    TB_MATIER_USE_SUB_CMND.ID_SUB_COMMANDE AS 'id sub',
    CASE 
        WHEN TB_MATIER_USE_SUB_CMND.NAME_MATIER IS NOT NULL THEN TB_MATIER_USE_SUB_CMND.NAME_MATIER 
        ELSE TB_MATIER_USE_SUB_CMND.ID_MATIER 
    END AS 'اسم المنتج',
    QT AS 'الكمية',
    COUT AS 'التكلفة',
    QTDECHET AS 'كمية المخلفات'
FROM [dbo].[TB_MATIER_USE_SUB_CMND]
	left JOIN 
    TB_MATIER_PREMIER ON TB_MATIER_PREMIER.CODEBARRE = TB_MATIER_USE_SUB_CMND.ID_MATIER
	 where TB_MATIER_USE_SUB_CMND.ID_SUB_COMMANDE = @ID_sub_commande
;
















GO
/****** Object:  StoredProcedure [dbo].[get_matier_premier_production_caisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc  [dbo].[get_matier_premier_production_caisse]
as
SELECT [ID] as'ID'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتج النهائي'
      ,[ID_MATIER_PREMIER] as'رقم المادة الاولية'
      ,[QT] as'الكمية'
      ,[QT_DECHET] as'كمية المخلفات'
      ,[PRICE_ACHAT] as'سعر الوحدة'
      ,[PRICE_TTL] as'السعر الكلي'
  FROM [dbo].[TB_MATIER_PREMIER_PRODUCTION_CAISS]

















GO
/****** Object:  StoredProcedure [dbo].[get_my_fctr_data]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_my_fctr_data]
@nmr_fctr nvarchar(50)
as
SELECT [NMR_FACTURE]
      ,[DATE]
      ,[HEURE]
      ,[ID_CLIENT]
      ,[TOTAL_FACURE_TTC]
      ,[TOTAL_FACTURE_HT]
      ,[TVA]
      ,[OLD_SOLD]
      ,[VERSEMENT]
      ,[NEW_SOLD]
      ,[REMISE]
      ,[POURSENTAGE_REMISE]
      ,[COUNT_ARTICLE]
      ,[REMARQUE]
      ,[ETAT]
      ,[ID_USER]
      ,[ID_CAISSIER]
      ,[cout_of_fctr]
      ,[tmbre]
      ,[pricearabe]
  FROM [dbo].[TB_FACTURE_VENTE]
  where NMR_FACTURE =@nmr_fctr




GO
/****** Object:  StoredProcedure [dbo].[GET_NOTIFY]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[GET_NOTIFY]
AS
SELECT [ID] 
      ,[NOTIFICATION] AS'الاشعار'
  FROM [dbo].[TB_NOTIFICATION]















GO
/****** Object:  StoredProcedure [dbo].[get_number_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_number_pack]
@nmbre_product nvarchar(50)
as
SELECT [pack_code_barre]
      ,[pack_designation]
      ,[code_barre_produit]
      ,[quantite]
      ,[price_unitair]
      ,[photo]
      ,[id_favoire]
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  where code_barre_produit = @nmbre_product

















GO
/****** Object:  StoredProcedure [dbo].[get_pack_liee_with_product]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_pack_liee_with_product]
@codebarre_pack nvarchar(50)
as
SELECT [pack_code_barre] 
      ,[code_barre_produit]
      ,TB_Produit_revente.CodeBarre as 'code produit'
	  ,TB_Produit_revente.QT_DANS_PACK as 'Qt on pack'
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_PACK_PRODUIT_REVENT.code_barre_produit
  where TB_PACK_PRODUIT_REVENT.pack_code_barre = @codebarre_pack



GO
/****** Object:  StoredProcedure [dbo].[Get_paramater_tb]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[Get_paramater_tb]
as
SELECT [PRINT_FACTURE]
      ,[PRINT_BON]
      ,[PRINT_BON_A4]
      ,[DONT_PRINT]
  FROM [dbo].[TB_PARAMETRE_INFO]















GO
/****** Object:  StoredProcedure [dbo].[get_parametre_day]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
  
--//////////////////////////////
create proc [dbo].[get_parametre_day]
as 
SELECT  [DAY_AVANT_PEREPRTION]
  FROM [dbo].[TB_PARAMETRE_INFO]
--/////////////////////////////












GO
/****** Object:  StoredProcedure [dbo].[get_Price_and_QT_OLD]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_Price_and_QT_OLD]
@codeBarre nvarchar(50)
as 
SELECT [price_achat_HT]
      ,[price_achat_TTC]
      ,[TVA] 
      ,[Quantite_rest] 
  FROM [dbo].[TB_Produit_revente]
  where [TB_Produit_revente].CodeBarre =@codeBarre







GO
/****** Object:  StoredProcedure [dbo].[GET_PRINCIPE_INVENTAIRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[GET_PRINCIPE_INVENTAIRE]
AS
SELECT [NMR_INVENTAIR] as'رقم الجرد'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,[TOTAL_THEORIQUE] as'الكمية الافتراضية الكلية'
      ,[TOTAL_PHYSIQUE] as'الكمية الحقيقية الكلية'
      ,[MONTANT_ECART] as'الفرق'
      ,[OBSERVATION] as'ملاحظة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_PRINCIPALE_INVENTAIRE]
	inner join TB_USER on TB_USER.ID = TB_PRINCIPALE_INVENTAIRE.ID_USER
	inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER


GO
/****** Object:  StoredProcedure [dbo].[get_reserve_code_all]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_reserve_code_all]
as
SELECT 
		[id]
		,[code_barre_produit]	as'الباركود الاساسي'
        ,[code_barre_reserve] as'الباركود الاحتياطي'
	     ,TB_Produit_revente.designation as'اسم المنتج'
      
  FROM [dbo].[TB_CODE_BARRE_RESERVE]
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_CODE_BARRE_RESERVE.code_barre_produit 








GO
/****** Object:  StoredProcedure [dbo].[get_reserve_code_all_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_reserve_code_all_pack]
as
SELECT [ID]
      ,[CODE_BARRE_OFFICIAL] as'الباركود الاساسي'
      ,[CODE_BARRE_RESERVER] as'الباركود الاحتياطي'
	  ,TB_PACK_PRODUIT_REVENT.pack_designation as'اسم الحزمة'
  FROM [dbo].[TB_CODE_BARRE_RESERVER_PACK]
  inner join TB_PACK_PRODUIT_REVENT on TB_PACK_PRODUIT_REVENT.pack_code_barre = TB_CODE_BARRE_RESERVER_PACK.CODE_BARRE_OFFICIAL 








GO
/****** Object:  StoredProcedure [dbo].[get_stock_matier_premier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_stock_matier_premier]
as
SELECT [CODEBARRE] as'رقم المنتج'
      ,[DESIGNATION] as'اسم المنتج'
      ,REFERENCE as'رقم المرجع'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,ROUND([QUANTITE], 2) as'الكمية الكلية'
      ,ROUND([QUANTITE_REST], 2) as'المتبقية'
      ,ROUND([QUANTITE_USE], 2)  as'الكمية المستعملة'
      ,ROUND([QUANTITE_PACKES], 2) as'الكمية في الحزمة' 
      ,[DATE_PREPARATION] as'تاريخ نهاية الصلاحية' 
      ,[STOCKES_MIN] as'تنبيه' 
  FROM [dbo].[TB_MATIER_PREMIER]
  inner join TB_UNITE on TB_UNITE.ID =[TB_MATIER_PREMIER].UNITE
  inner join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_MATIER_PREMIER].CATEGORIES
  inner join TB_STOCK on TB_STOCK.ID =[TB_MATIER_PREMIER].STOCKES
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_MATIER_PREMIER].MARKE

















GO
/****** Object:  StoredProcedure [dbo].[get_stock_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

 
--//////////////////
CREATE proc [dbo].[get_stock_pack]
as
SELECT [pack_code_barre] as'رقم الحزمة'
      ,[pack_designation] as'اسم الحزمة'
      ,[code_barre_produit] as'رقم المنتج'
      ,TB_Produit_revente.Quantite_rest/TB_Produit_revente.QT_DANS_PACK as'الكمية المتبقية'
      ,[price_unitair] as'سعر الحزمة' 
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_PACK_PRODUIT_REVENT].id_favoire
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre =[TB_PACK_PRODUIT_REVENT].code_barre_produit












GO
/****** Object:  StoredProcedure [dbo].[get_stock_produit_revenet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
     
CREATE proc [dbo].[get_stock_produit_revenet]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj   as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  LEFT join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  LEFT join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  LEFT join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  LEFT join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
--++++++++++++++++++++++++++++++++++











GO
/****** Object:  StoredProcedure [dbo].[get_stock_produit_revenet_for_edit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
   
CREATE proc  [dbo].[get_stock_produit_revenet_for_edit]
@CodeBarre nvarchar(50)
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Photo 
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj  as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
  where CodeBarre = @CodeBarre











GO
/****** Object:  StoredProcedure [dbo].[get_stock_produit_revenet_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_stock_produit_revenet_stock]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع' 
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,TB_MARQUE.Marque as'العلامة' 
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون' 
  FROM [dbo].[TB_Produit_revente]
  inner join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  inner join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  inner join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
















GO
/****** Object:  StoredProcedure [dbo].[get_stock_produit_revenet_stock_1]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_stock_produit_revenet_stock_1]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع' 
      ,[Quantite_TOTAL] as'الكمية الكلية'  
      ,[price_vente2] as'سعر البيع الثاني'
      ,TB_MARQUE.Marque as'العلامة' 
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون' 
  FROM [dbo].[TB_Produit_revente]
  inner join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  inner join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  inner join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
















GO
/****** Object:  StoredProcedure [dbo].[get_stock_produit_revenet_stock_2]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_stock_produit_revenet_stock_2]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع' 
      ,[Quantite_TOTAL] as'الكمية الكلية'  
      ,[price_min] as'سعر البيع الأدنى' 
      ,TB_MARQUE.Marque as'العلامة' 
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون' 
  FROM [dbo].[TB_Produit_revente]
  inner join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  inner join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  inner join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
















GO
/****** Object:  StoredProcedure [dbo].[GET_SUB_COMMANDE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[GET_SUB_COMMANDE] 
AS 
SELECT [TB_SUM_COMMANDE].[ID] as'ID'
      ,TB_COMMANDE.NOM_COMMANDE as'اسم الطلبية'
	  ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME as'الزبون'
      ,[SUB_COMMANDE_TITLE] as'الطلبية'
      ,[QUANTITE] as'الكمية'
      ,[PRIX_UNITAIR] as'سعر الوحدة'
      ,[PRIX_TOTAL] as'السعر الكلي'
      ,[QTE_REST] as'الكمية المتبقية'
      ,[QT_LIVRE] as'الكمية المسلمة'
      ,[price_cout] as'التكلفة'
  FROM [dbo].[TB_SUM_COMMANDE]
  inner join TB_COMMANDE on TB_COMMANDE.ID = TB_SUM_COMMANDE.ID_COMMANDE
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT

















GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facturatnion_state_pack_day_specifiuqe]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_facturatnion_state_pack_day_specifiuqe]
@date date
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QTE) AS الكمية_المباعة
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE = P.pack_code_barre
WHERE 
   Date = @date
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;


GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facturatnion_state_unite_day_specifique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_facturatnion_state_unite_day_specifique]
@date date
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QTE) as الكمية_المباعة,
    P.Quantite_rest as 'الكمية المتبقية'
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE = P.CodeBarre
WHERE 
    DATE = @date-- تصفية مبيعات اليوم
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;


GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facture_state_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_facture_state_pack]
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QTE) AS الكمية_المباعة
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE = P.pack_code_barre
WHERE 
    CONVERT(DATE, F.[DATE]) = CONVERT(DATE, GETDATE()) -- تصفية مبيعات اليوم
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;




GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facture_state_pack_month]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_facture_state_pack_month]
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QTE) AS الكمية_المباعة
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE = P.pack_code_barre
WHERE 
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(day, -7, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;




GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facture_state_pack_weel]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_facture_state_pack_weel]
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QTE) AS الكمية_المباعة
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE = P.pack_code_barre
WHERE 
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(day, -7, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;




GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facture_state_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_facture_state_unite]
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QTE) as الكمية_المباعة
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE = P.CodeBarre
WHERE 
    CONVERT(DATE, F.[DATE]) = CONVERT(DATE, GETDATE()) -- تصفية مبيعات اليوم
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;



GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facture_state_unite_month]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_sum_of_Qt_facture_state_unite_month]
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QTE) as الكمية_المباعة
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE = P.CodeBarre
WHERE   
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(MONTH, -1, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;



GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_facture_state_unite_week]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_facture_state_unite_week]
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QTE) as الكمية_المباعة
FROM 
    TB_FACTURATION_VENTE V
INNER JOIN 
    TB_FACTURATION F ON V.nmr_fctr = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE = P.CodeBarre
WHERE   
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(day, -7, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;



GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_vente_state_pack]
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QUANTITE_VENTE) AS الكمية_المباعة
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE_PRODUIT = P.pack_code_barre
WHERE 
    CONVERT(DATE, F.[DATE]) = CONVERT(DATE, GETDATE()) -- تصفية مبيعات اليوم
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;




GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_pack_day_specifiuqe]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_vente_state_pack_day_specifiuqe]
@date date
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QUANTITE_VENTE) AS الكمية_المباعة
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE_PRODUIT = P.pack_code_barre
WHERE 
   Date = @date
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;


GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_pack_Monthe]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
create proc [dbo].[get_sum_of_Qt_vente_state_pack_Monthe]
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QUANTITE_VENTE) AS الكمية_المباعة
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE_PRODUIT = P.pack_code_barre
WHERE 
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(MONTH, -1, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;



GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_pack_week]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[get_sum_of_Qt_vente_state_pack_week]
as
SELECT 
    P.pack_code_barre AS كود_المنتج,
    P.pack_designation AS اسم_المنتج,
    SUM(V.QUANTITE_VENTE) AS الكمية_المباعة
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_PACK_PRODUIT_REVENT P ON V.CODE_BARRE_PRODUIT = P.pack_code_barre
WHERE 
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(day, -7, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.pack_code_barre, P.pack_designation
ORDER BY 
    الكمية_المباعة DESC;



GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_sum_of_Qt_vente_state_unite]
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QUANTITE_VENTE) as الكمية_المباعة,
    P.Quantite_rest as 'الكمية المتبقية'
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE_PRODUIT = P.CodeBarre
WHERE 
    CONVERT(DATE, F.[DATE]) = CONVERT(DATE, GETDATE()) -- تصفية مبيعات اليوم
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;




GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_unite_day_specifique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_sum_of_Qt_vente_state_unite_day_specifique]
@date date
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QUANTITE_VENTE) as الكمية_المباعة,
    P.Quantite_rest as 'الكمية المتبقية'
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE_PRODUIT = P.CodeBarre
WHERE 
    DATE = @date-- تصفية مبيعات اليوم
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;


GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_unite_Monthe]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
CREATE proc [dbo].[get_sum_of_Qt_vente_state_unite_Monthe]
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QUANTITE_VENTE) as الكمية_المباعة,
    P.Quantite_rest as 'الكمية المتبقية'
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE_PRODUIT = P.CodeBarre
WHERE 
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(MONTH, -1, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;



GO
/****** Object:  StoredProcedure [dbo].[get_sum_of_Qt_vente_state_unite_week]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_sum_of_Qt_vente_state_unite_week]
as
SELECT 
    P.CodeBarre as 'كود المنتج',
    P.designation as 'اسم المنتج',
    SUM(V.QUANTITE_VENTE) as الكمية_المباعة,
    P.Quantite_rest as 'الكمية المتبقية'
FROM 
    TB_VENTE V
INNER JOIN 
    TB_FACTURE_VENTE F ON V.ID_FACTURE = F.NMR_FACTURE
INNER JOIN 
    TB_Produit_revente P ON V.CODE_BARRE_PRODUIT = P.CodeBarre
WHERE 
    CONVERT(DATE, F.[DATE]) BETWEEN CONVERT(DATE, DATEADD(day, -7, GETDATE())) AND CONVERT(DATE, DATEADD(day, -1, GETDATE()))
GROUP BY 
    P.CodeBarre, P.designation, P.Quantite_rest
ORDER BY 
    الكمية_المباعة DESC;



GO
/****** Object:  StoredProcedure [dbo].[get_table_dechet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_table_dechet]
as  
SELECT [ID] as'ID'
      ,TB_MATIER_PREMIER.DESIGNATION as'اسم المادة'
      ,[QT_Dechet] as'كمية المخلفات'
	  ,price_u as'سعر الشراء'
	  ,price_ttl as'سعر المخلفات'
      ,[etas] as'الحالة'
	 
  FROM [dbo].[TB_DECHET_REClage]
  inner join TB_MATIER_PREMIER on TB_MATIER_PREMIER.CODEBARRE = TB_DECHET_REClage.ID_MATIER

















GO
/****** Object:  StoredProcedure [dbo].[GET_TABLE_HISTORIQUE_CLIENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROC [dbo].[GET_TABLE_HISTORIQUE_CLIENT]
AS
WITH CTE AS (
    SELECT
        [TB_HISTORIQUE_CLIENT].ID,
        [DATE],
        TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS الزبون,
        total_amounte AS المبلغ_الكلي,
        [PRICE] AS المبلغ_المدفوع,
        total_amounte - [PRICE] AS المتبقي,
        [CREDIT_OLD] AS المبلغ_القديم_الحالي,
        [CREDIT_NEW] AS المبلغ_الجديد_الحالي,
		[REMARQUE] AS الملاحظة,
        ID_FACTURE AS رقم_التعريف,
        LAG([TB_HISTORIQUE_CLIENT].[CREDIT_NEW], 1, 0) OVER (ORDER BY [TB_HISTORIQUE_CLIENT].ID) AS المبلغ_الجديد_السابق
    FROM
        [dbo].[TB_HISTORIQUE_CLIENT]
    INNER JOIN
        TB_CLIENT ON TB_CLIENT.id = TB_HISTORIQUE_CLIENT.[ID_CLIENT]
)
SELECT
    CTE.ID AS 'ID',
    CTE.[DATE] AS 'التاريخ',
    CTE.الزبون,
    CTE.المبلغ_الكلي,
    CTE.المبلغ_المدفوع,
    CTE.المتبقي,
    CTE.المبلغ_الجديد_السابق AS 'المبلغ القديم',
    CTE.المبلغ_الجديد_السابق + CTE.المتبقي AS 'المبلغ الجديد', 
    CTE.الملاحظة,
    CTE.رقم_التعريف
FROM CTE;
GO
/****** Object:  StoredProcedure [dbo].[get_table_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_table_pack]
as 
SELECT [BARCODE_PACK] as'رقم الحزمة'
      ,[DESIGNATION] as'اسم الحزمة'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتوج'
      ,[QT_DISPONIBLE] as'الكمية المتوفرة'
      ,[PRICE_GROS] as'ثمن الجملة'
      ,[PRICE_DETAILLE] as'ثمن التجزئة'
      ,[PRICE_MIN] as'الثمن الادنى'
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]

















GO
/****** Object:  StoredProcedure [dbo].[get_table_pack_1]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_table_pack_1]
as 
SELECT [BARCODE_PACK] as 'رقم الحزمة'
      ,[DESIGNATION] as'اسم الحزمة'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتوج'
      ,[QT_DISPONIBLE] as'الكمية المتوفرة'
      ,[PRICE_DETAILLE] as'ثمن التجزئة'
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
















GO
/****** Object:  StoredProcedure [dbo].[get_table_pack_2]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_table_pack_2]
as 
SELECT [BARCODE_PACK] as'رقم الحزمة'
      ,[DESIGNATION] as'اسم الحزمة'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتوج'
      ,[QT_DISPONIBLE] as'الكمية المتوفرة'
      ,[PRICE_GROS] as'ثمن الجملة' 
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
















GO
/****** Object:  StoredProcedure [dbo].[get_table_pack_min]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[get_table_pack_min]
as 
SELECT [BARCODE_PACK] as'رقم الحزمة'
      ,[DESIGNATION] as'اسم الحزمة'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتوج'
      ,[QT_DISPONIBLE] as'الكمية المتوفرة' 
      ,[PRICE_MIN] as'الثمن الادنى'
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
















GO
/****** Object:  StoredProcedure [dbo].[get_tb_achat_by_id]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_achat_by_id]
@id_produit nvarchar(50)
as
SELECT [ID] as'ID'
      ,[ID_PRODUIT] as'رمز المنتج'
      ,[QUANTITE] as'الكمية' 
      ,[PRIX_ACHAT_HT] AS 'سعر الشراء HT $',
       [TVA] as'TVA'
      ,[PRIX_ACHAT_TTC] AS 'سعر الشراء TTC $'
  FROM [dbo].[TB_ACHAT]
  where ID_PRODUIT = @id_produit

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_caissier]
as 
SELECT [ID] as'ID'
      ,[NAME] as'اللقب'
      ,[PRENAME] as'الاسم'
      ,[USER-NAME] as'اسم المستخدم'
      ,[PASSW] as'كلمة السر'
  FROM [dbo].[TB_INFO_CAISSIER]

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_Categories]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_Categories]
as
SELECT [ID] as'ID'
      ,CATEGORIES as'الصنف'
  FROM [dbo].TB_CATEGORIES

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_client_tb_remarque]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_client_tb_remarque]
@id_client int
as 
SELECT [TB_REMARQUE_CLIENT].[ID] as'ID'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولفب الزبون'
      ,[REMARQUE_DE_CLIENT] as'الملاحظ'
  FROM [dbo].[TB_REMARQUE_CLIENT]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_REMARQUE_CLIENT.ID_CLIENT
	where ID_CLIENT = @id_client

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_codeBarre_pack_reserver]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_codeBarre_pack_reserver]
@CODE_BARRE_OFFICIAL nvarchar(50)
as
SELECT [ID]
      ,[CODE_BARRE_OFFICIAL] 'المنتح الاساسي'
      ,[CODE_BARRE_RESERVER] 'المنتج الاحتياطي'
  FROM [dbo].[TB_CODE_BARRE_RESERVER_PACK]
  where CODE_BARRE_OFFICIAL = @CODE_BARRE_OFFICIAL

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_codeBarre_resever]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_codeBarre_resever]
@Code_barre_principale nvarchar(50)
as
SELECT [code_barre_produit] as 'رقم المنتووج الاساسي'
      ,[code_barre_reserve] as 'رفم المنتوج الثانوي' 
  FROM [dbo].[TB_CODE_BARRE_RESERVE]
  where code_barre_produit = @Code_barre_principale

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_codeBarre_resever_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_codeBarre_resever_pack]
@CodeBarrePrincipale nvarchar(50)
as
SELECT [ID] 
      ,[CODE_BARRE_OFFICIAL] as'رقم الحزمة الاساسي'
      ,[CODE_BARRE_RESERVER] as'رقم الحزمة الاحتياطي'
  FROM [dbo].[TB_CODE_BARRE_RESERVER_PACK]

















GO
/****** Object:  StoredProcedure [dbo].[get_TB_Coffre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[get_TB_Coffre]
as
SELECT [ID]
      ,[SOLD_ON_COFRE] as'المبلغ في الخزينة'
  FROM [dbo].[TB_COFRE]















GO
/****** Object:  StoredProcedure [dbo].[get_tb_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_commande]
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_depense]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_depense]
as
SELECT TB_DEPENSE.[ID]
      ,[CAUSE_DEPENSE] as'سبب الخسارة'
      ,[VALEURE] as'قيمة الخسارة'
      ,[DATE] as'التاريخ'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_DEPENSE]
  inner join TB_USER on TB_USER.ID = [TB_DEPENSE].USER_ID
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER


















GO
/****** Object:  StoredProcedure [dbo].[get_tb_fctr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_fctr]
as
SELECT [NMR_FCTR] as'رفم الفاتورة'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_PRODUIT] as'عدد المنتجات'
      ,[VERSEMENT] as'الدفع'
      ,[TOTAL] as'المبلغ الكلي TTC'
      ,[total_HT] as'المبلغ الكلي HT'
      ,[Creditprecidenet] as'الديون السابقة'
      ,[creditNew] as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT.ID_FRNSR
  inner join TB_USER on TB_USER.ID = TB_FACTURE_ACHAT.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER


















GO
/****** Object:  StoredProcedure [dbo].[get_tb_fctr_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_tb_fctr_vente]
@id nvarchar(50)
as
SELECT [NMR_FACTURE]
      ,[DATE]
      ,[HEURE]
      ,[ID_CLIENT]
      ,[TOTAL_FACURE_TTC]
      ,[TOTAL_FACTURE_HT]
      ,[TVA]
      ,[OLD_SOLD]
      ,[VERSEMENT]
      ,[NEW_SOLD]
      ,[REMISE]
      ,[POURSENTAGE_REMISE]
      ,[COUNT_ARTICLE]
      ,[REMARQUE]
      ,[ETAT]
      ,[ID_USER]
      ,[ID_CAISSIER]
      ,[cout_of_fctr]
      ,[tmbre]
      ,[pricearabe]
  FROM [dbo].[TB_FACTURE_VENTE]
  where [NMR_FACTURE] = @id



GO
/****** Object:  StoredProcedure [dbo].[get_tb_for_bestha_print]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_tb_for_bestha_print] 
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى' 
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية' 
  FROM [dbo].[TB_Produit_revente]
  LEFT join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  LEFT join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  LEFT join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  LEFT join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 


GO
/****** Object:  StoredProcedure [dbo].[GET_TB_GESTION_PRODUIT_FINAUX]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[GET_TB_GESTION_PRODUIT_FINAUX]
AS
SELECT [CODE_BARRE] AS'رقم المنتج'
      ,[DESIGNATION] AS'اسم المنتج' 
	  ,TB_UNITE.UNITE AS'الوحدة'
      ,TB_CATEGORIES.CATEGORIES AS'الصنف'
      ,[COUT_DE_PRODUCTION] AS'تكلفة الانتاج'
      ,[QT_DANS_PACK] AS'الكمية في الحزمة'
      ,[QT_TOTAL] AS'الكمية الكلية'
      ,[QT_VENTE] AS'الكمية المباعة'
      ,[QT_REST] AS'الكمية المتبقية'
      ,[QT_DECHET] AS'الكمية المفقودة'
      ,[PRICE_VENTE_HT] AS'سعر البيع  HT'
      ,[PRICE_VENTE_TTC] AS'سعر البيع TTC'
      ,[TVA] AS'TVA'
      ,[PRICE_GROS] AS'سعر الجملة'
      ,[PRICE_MIN] AS'السعر الادنى'
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  INNER JOIN TB_CATEGORIES ON TB_CATEGORIES.ID = TB_GESTION_PRODUIT_FINAUX.CATEGORIE
  INNER JOIN TB_UNITE ON TB_UNITE.ID = TB_GESTION_PRODUIT_FINAUX.UNITE

















GO
/****** Object:  StoredProcedure [dbo].[GET_TB_GESTION_PRODUIT_FINAUX_prix_min]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[GET_TB_GESTION_PRODUIT_FINAUX_prix_min]
AS
SELECT [CODE_BARRE] AS'رقم المنتج'
      ,[DESIGNATION] AS'اسم المنتج'  
      ,[QT_DANS_PACK] AS'الكمية في الحزمة'
      ,[QT_TOTAL] AS'الكمية الكلية'
      ,[QT_VENTE] AS'الكمية المباعة'  
      ,[PRICE_MIN] AS'السعر الادنى'
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  INNER JOIN TB_CATEGORIES ON TB_CATEGORIES.ID = TB_GESTION_PRODUIT_FINAUX.CATEGORIE
  INNER JOIN TB_UNITE ON TB_UNITE.ID = TB_GESTION_PRODUIT_FINAUX.UNITE

















GO
/****** Object:  StoredProcedure [dbo].[GET_TB_GESTION_PRODUIT_FINAUX_prix1]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[GET_TB_GESTION_PRODUIT_FINAUX_prix1]
AS
SELECT [CODE_BARRE] AS'رقم المنتج'
      ,[DESIGNATION] AS'اسم المنتج'  
      ,[QT_DANS_PACK] AS'الكمية في الحزمة'
      ,[QT_TOTAL] AS'الكمية الكلية'
      ,[QT_VENTE] AS'الكمية المباعة' 
      ,[PRICE_VENTE_HT] AS'سعر البيع  HT'
      ,[PRICE_VENTE_TTC] AS'سعر البيع TTC'
      ,[TVA] AS'TVA'
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  INNER JOIN TB_CATEGORIES ON TB_CATEGORIES.ID = TB_GESTION_PRODUIT_FINAUX.CATEGORIE
  INNER JOIN TB_UNITE ON TB_UNITE.ID = TB_GESTION_PRODUIT_FINAUX.UNITE

















GO
/****** Object:  StoredProcedure [dbo].[GET_TB_GESTION_PRODUIT_FINAUX_prix2]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[GET_TB_GESTION_PRODUIT_FINAUX_prix2]
AS
SELECT [CODE_BARRE] AS'رقم المنتج'
      ,[DESIGNATION] AS'اسم المنتج'  
      ,[QT_DANS_PACK] AS'الكمية في الحزمة'
      ,[QT_TOTAL] AS'الكمية الكلية'
      ,[QT_VENTE] AS'الكمية المباعة'  
      ,[PRICE_GROS] AS'سعر الجملة'
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  INNER JOIN TB_CATEGORIES ON TB_CATEGORIES.ID = TB_GESTION_PRODUIT_FINAUX.CATEGORIE
  INNER JOIN TB_UNITE ON TB_UNITE.ID = TB_GESTION_PRODUIT_FINAUX.UNITE

















GO
/****** Object:  StoredProcedure [dbo].[get_TB_historique_dechet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
   
 
--++++++++++++++++++++++++++++++++++
create proc [dbo].[get_TB_historique_dechet] 
as
SELECT [TB_HISTORIQUE_DECHET].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,[TIME] as'الوقت'
      ,[CODE_BARRE] as'رقم المنتج'
	  ,TB_Produit_revente.designation as'اسم المنتج'
      ,[QUANTITE] as'الكمية'
      ,[LACAUSE] as'السبب'
      ,TB_OUVERIER.NAME +' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_HISTORIQUE_DECHET]
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_HISTORIQUE_DECHET.CODE_BARRE
  inner join TB_USER on TB_USER.ID = TB_HISTORIQUE_DECHET.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER












GO
/****** Object:  StoredProcedure [dbo].[get_TB_historique_fournisseur]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_TB_historique_fournisseur]
as
SELECT [TB_HISTORIQUE_FOURNISSEUR].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME + ' ' +TB_FOURNISSUER.PRENAME  as'اسم ولقب المورد'
      ,[PRICE] as'الدفع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'ملاحظة'
  FROM [dbo].[TB_HISTORIQUE_FOURNISSEUR]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_HISTORIQUE_FOURNISSEUR.ID_CLIENT

















GO
/****** Object:  StoredProcedure [dbo].[GET_TB_LIVRAISON]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[GET_TB_LIVRAISON]
AS
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE] as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT ;
















GO
/****** Object:  StoredProcedure [dbo].[get_Tb_livraison_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_Tb_livraison_vente]
as
SELECT [TB_LIVRAISON_VENTE].[ID] 
      ,[id_Facture] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[SENDER] as'المرسل'
      ,[RECUPIRATEUR] as'المستلم'
      ,[TYPE_LIV] as'نوع النقل'
      ,[PRICE_LIV] as'سعر النقل'
      ,[INFORMATION_CHAUFEURE] as'معلومات السائق'
      ,[MATRICULE] as'رقم لوحة السيارة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_LIVRAISON_VENTE]
  inner join tb_user on TB_USER.ID = TB_LIVRAISON_VENTE.ID_USER
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_LIVRAISON_VENTE.ID_CAISSIER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER

















GO
/****** Object:  StoredProcedure [dbo].[get_TB_MARQUE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_TB_MARQUE]
as
SELECT [ID] as'ID'
      ,Marque as'العلامة'
  FROM [dbo].TB_MARQUE

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_matier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_matier]
@id_matier_premier nvarchar(50)
as 
SELECT [CODEBARRE]
      ,[DESIGNATION]
      ,[UNITE]
      ,[CATEGORIES]
      ,[STOCKES]
      ,[MARKE]
      ,[QUANTITE]
      ,[QUANTITE_REST]
      ,[QUANTITE_USE]
      ,[QUANTITE_PACKES]
      ,[PHOTO]
      ,[DATE_PREPARATION]
      ,[OBSERVATION]
      ,[STOCKES_MIN]
      ,[PRODUIT_DES_PIECES]
  FROM [dbo].[TB_MATIER_PREMIER]
  where [CODEBARRE] = @id_matier_premier

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_matier_premier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_matier_premier]
@code_bare nvarchar(50)
as
SELECT [CODEBARRE]
      ,[DESIGNATION]
      ,[UNITE]
      ,[CATEGORIES]
      ,[STOCKES]
      ,[MARKE]
      ,[QUANTITE]
      ,[QUANTITE_REST]
      ,[QUANTITE_USE]
      ,[QUANTITE_PACKES]
      ,[PHOTO]
      ,[DATE_PREPARATION]
      ,[OBSERVATION]
      ,[STOCKES_MIN]
      ,[PRODUIT_DES_PIECES]
		   ,PRICE_HT
		   ,PRICE_TTC
		   ,TVA
  FROM [dbo].[TB_MATIER_PREMIER]
  where TB_MATIER_PREMIER.CODEBARRE = @code_bare
















GO
/****** Object:  StoredProcedure [dbo].[get_tb_matier_where_edit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_matier_where_edit]
@nmr_produit nvarchar(50)
as
SELECT [ID] as'ID'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتج النهائي'
      ,[ID_MATIER_PREMIER] as'رقم المادة الاولية'
      ,[QT] as'الكمية'
      ,[QT_DECHET] as'كمية المخلفات'
      ,[PRICE_ACHAT] as'سعر الوحدة'
      ,[PRICE_TTL] as'السعر الكلي'
  FROM [dbo].[TB_MATIER_PREMIER_PRODUCTION]
  where ID_PRODUIT_FINAUX = @nmr_produit

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_remarque_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_remarque_client]
as 
SELECT [TB_REMARQUE_CLIENT].[ID] as'ID'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PHONE as'اسم ولقب الزبون'
      ,[REMARQUE_DE_CLIENT] as'الملاحظة'
  FROM [dbo].[TB_REMARQUE_CLIENT]
  inner join TB_CLIENT on TB_CLIENT.ID  = [TB_REMARQUE_CLIENT].ID_CLIENT

















GO
/****** Object:  StoredProcedure [dbo].[get_TB_routeur_produit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[get_TB_routeur_produit]
as 
SELECT [TB_ROUTOUR_PRODUIT].[ID]
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الساعة'
      ,[CODE_BARRE_PRODUIT] as'رقم المنتج' 
      ,[QT] as'الكمية'
      ,[price_U] as'سعر الوحدة'
      ,[Price_TTl] as'السعر الكلي'
      ,[PRice_achat_ttl] as'سعر الشراء'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
      ,TB_OUVERIER.NAME + ' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_ROUTOUR_PRODUIT]
  inner join TB_USER on TB_USER.ID = TB_ROUTOUR_PRODUIT.ID_USER
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_ROUTOUR_PRODUIT.ID_CAISSIER 
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_ROUTOUR_PRODUIT.CODE_BARRE_PRODUIT
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER









GO
/****** Object:  StoredProcedure [dbo].[get_TB_routeur_produit_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[get_TB_routeur_produit_by_date]
@Date date
as 
SELECT [TB_ROUTOUR_PRODUIT].[ID]
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الساعة'
      ,[CODE_BARRE_PRODUIT] as'رقم المنتج' 
      ,[QT] as'الكمية'
      ,[price_U] as'سعر الوحدة'
      ,[Price_TTl] as'السعر الكلي'
      ,[PRice_achat_ttl] as'سعر الشراء'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
      ,TB_OUVERIER.NAME + ' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_ROUTOUR_PRODUIT]
  inner join TB_USER on TB_USER.ID = TB_ROUTOUR_PRODUIT.ID_USER
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_ROUTOUR_PRODUIT.ID_CAISSIER 
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_ROUTOUR_PRODUIT.CODE_BARRE_PRODUIT
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where [DATE] =@Date









GO
/****** Object:  StoredProcedure [dbo].[get_tb_sub_commande_caisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_sub_commande_caisse]
@id_commande nvarchar(50)
as
SELECT ID 
	  ,[SUB_COMMANDE_TITLE] as'الطلب'
      ,[QUANTITE] as'الكمية'
      ,[PRIX_UNITAIR] as'سعر الوحدة'
      ,[PRIX_TOTAL] as'السعر الكلي'
      ,[price_cout] as'التكلفة'
  FROM [dbo].[TB_SUM_COMMANDE_caise]
  where ID_COMMANDE = @id_commande

















GO
/****** Object:  StoredProcedure [dbo].[get_tb_tools_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tb_tools_commande] 
as
SELECT [ID] as'ID'
      ,[TOOLS] as'الالة'
      ,[ID_COMMANDE] as'رقم الفاتورة'
  FROM [dbo].[TB_TOOLS_COMMANDE_caise]
 
















GO
/****** Object:  StoredProcedure [dbo].[get_tb_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[get_tb_unite]
as
SELECT [ID] as'ID'
      ,[UNITE] as'الوحدة'
  FROM [dbo].[TB_UNITE]

















GO
/****** Object:  StoredProcedure [dbo].[get_TB_USER_RECUPIRATION]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[get_TB_USER_RECUPIRATION]
@Code_REcupiration nvarchar(50)
as
SELECT [ID]
      ,[ID_OUVERIER]
      ,[USERR]
      ,[PASS]
      ,[ROLE]
      ,[ETAS]
      ,[Code_Recupiraiton]
  FROM [dbo].[TB_USER]
  where Code_Recupiraiton =@Code_REcupiration














GO
/****** Object:  StoredProcedure [dbo].[get_tools_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_tools_commande]
@ID_commande nvarchar(50)
as  
SELECT [ID] as 'ID'
      ,[TOOLS] as'الالة'
      ,[ID_COMMANDE] as'رقم الفاتورة'
  FROM [dbo].[TB_TOOLS_COMMANDE]
  WHERE ID_COMMANDE = @ID_commande

















GO
/****** Object:  StoredProcedure [dbo].[get_vente_by_nmr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_vente_by_nmr]
@IDfacrue nvarchar(50)
as
SELECT 
	   [ID] as'ID'
	   ,[CODE_BARRE_PRODUIT] as'رقم المنتوج'
	  --,TB_Produit_revente.designation as'اسم المنتوج'
      ,[TB_VENTE].[QUANTITE_VENTE] as'كمية المنتوج'
      ,[PRIX_VENTE] as'سعر المنتوج'
      ,[PRIX_TOTAL] as'السعر الكلي'  
  FROM [dbo].[TB_VENTE] 
  where ID_FACTURE=@IDfacrue;
















GO
/****** Object:  StoredProcedure [dbo].[get_vente_by_nmrr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_vente_by_nmrr]
@IDfacrue nvarchar(50)
as
SELECT 
	   [ID] as'ID'
	   ,[CODE_BARRE_PRODUIT] as'رقم المنتوج'
	  -- ,TB_Produit_revente.designation as'اسم المنتوج'
      ,[TB_VENTE].[QUANTITE_VENTE] as'كمية المنتوج'
      ,[PRIX_VENTE] as'سعر المنتوج'
      ,[PRIX_TOTAL] as'السعر الكلي'  
  FROM [dbo].[TB_VENTE]  
  where ID_FACTURE=@IDfacrue;
















GO
/****** Object:  StoredProcedure [dbo].[get_vente_dtl]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[get_vente_dtl]
@id_bon nvarchar(50)
as   
    -- استعلام موحد لجلب البيانات بدون تكرار مع فصل التاريخ والوقت
    SELECT DISTINCT
		v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        COALESCE(pr.designation, p.pack_designation, pf.DESIGNATION, pd.DESIGNATION, NULL) AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر البيع',
        v.PRIX_TOTAL AS 'السعر الكلي'
		,[cout] as'التكلفة'
		,[typee] as'النوع'
    FROM tb_vente v 
    LEFT JOIN 
		TB_Produit_revente pr ON pr.CodeBarre = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_PACK_PRODUIT_REVENT p ON p.pack_code_barre = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_GESTION_PRODUIT_FINAUX pf ON pf.CODE_BARRE = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_PACK_GESTION_PRODUIT_FINAUX pd ON pd.BARCODE_PACK = v.CODE_BARRE_PRODUIT
    LEFT JOIN 
		TB_FACTURE_VENTE fv ON fv.NMR_FACTURE = v.ID_FACTURE 
where fv.NMR_FACTURE = @id_bon
GO
/****** Object:  StoredProcedure [dbo].[get_vente_en_attend]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[get_vente_en_attend]
@IDsearch nvarchar(50)
as
SELECT [NMR_FACTURE] as'رقم الفاتورة'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME  as'الزبون'
      ,[TOTAL_FACURE_TTC] as'السعر الكلي TTC'
      ,[TOTAL_FACTURE_HT] as'السعر الكلي HT' 
      ,[TVA] as'TVA' 
  FROM [dbo].[TB_FACTURE_VENTE]
  inner join TB_CLIENT on TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
  inner join TB_USER on TB_USER.id = TB_FACTURE_VENTE.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.id = TB_USER.ID_OUVERIER
 where [TB_FACTURE_VENTE].ETAT LIKE N'%' + @IDsearch + '%'

















GO
/****** Object:  StoredProcedure [dbo].[GetAllFacturesInDesc]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[GetAllFacturesInDesc]
AS
BEGIN
    SELECT NMR_FACTURE
    FROM TB_FACTURE_VENTE
    ORDER BY NMR_FACTURE DESC
END


GO
/****** Object:  StoredProcedure [dbo].[GetLastProductionInfo]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[GetLastProductionInfo]
    @codebare VARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;

    SELECT TOP 1 [ID]
          ,[DATE]
          ,[QT_BEFOR]
          ,[QT_PROUDCTION]
          ,[QT_AFTER]
          ,[COUT_PRODUCTION]
          ,[ID_USER]
          ,[ID_PRODUIT]
    FROM [DB_PRODUCTION_POS].[dbo].[TB_HISTORIQUE_PRODUCTION]
    WHERE [ID_PRODUIT] = @codebare
    ORDER BY [DATE] DESC;
END
















GO
/****** Object:  StoredProcedure [dbo].[GetRepatationRecords]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[GetRepatationRecords]
AS
BEGIN
    SET NOCOUNT ON;

    SELECT [NMR_OPERATION] as'رقم العملية'
          ,[DATE_ENTRE] as'تاريخ البداية'
          ,[TIME] as'الوقت'
          ,[CLIENT] as'اسم الزبون'
          ,[NMR_TEL_] as'رقم الهاتف'
          ,[PROBLEM] as'المشكل'
          ,[PRIX] as'السعر'
          ,[DATE_SORTIE] as'تاريخ الخروج'
          ,[ETAS] as'الحالة'
    FROM [dbo].[TB_repatation];
END;
 



GO
/****** Object:  StoredProcedure [dbo].[GetVenteDetails]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[GetVenteDetails]
    @facteure NVARCHAR(50)
AS
BEGIN
    -- Temporary table to store results
    DECLARE @Results TABLE (
        ID INT,
        [Code-barre] NVARCHAR(50),
        Designation NVARCHAR(255),
        Qt FLOAT,
        [Prixe U] DECIMAL(18, 2),
        [Prixe TTL] DECIMAL(18, 2)
    );

    -- Insert from tb_vente and tb_produit_revent
    INSERT INTO @Results
    SELECT 
        v.ID AS 'ID',
        v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        pr.designation AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر المنتوج',
        v.PRIX_TOTAL AS 'السعر الكلي'
    FROM tb_vente v
    INNER JOIN TB_Produit_revente pr ON pr.CodeBarre = v.CODE_BARRE_PRODUIT
    WHERE v.ID_FACTURE = @facteure;

    -- Insert from tb_vente and tb_pack
    INSERT INTO @Results
    SELECT 
        v.ID AS 'ID',
        v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        p.pack_designation AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر المنتوج',
        v.PRIX_TOTAL AS 'السعر الكلي'
    FROM tb_vente v
    INNER JOIN TB_PACK_PRODUIT_REVENT p ON p.pack_code_barre = v.CODE_BARRE_PRODUIT
    WHERE v.ID_FACTURE = @facteure;

    -- Insert from tb_vente and tb_gestion_produit_finaux
    INSERT INTO @Results
    SELECT 
        v.ID AS 'ID',
        v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        pf.DESIGNATION AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر المنتوج',
        v.PRIX_TOTAL AS 'السعر الكلي'
    FROM tb_vente v
    INNER JOIN TB_GESTION_PRODUIT_FINAUX pf ON pf.CODE_BARRE = v.CODE_BARRE_PRODUIT
    WHERE v.ID_FACTURE = @facteure;

    -- Insert from tb_vente and tb_pack_gestion_produit_finaux
    INSERT INTO @Results
    SELECT 
        v.ID AS 'ID',
        v.CODE_BARRE_PRODUIT AS 'رقم المنتوج',
        pd.DESIGNATION AS 'اسم المنتوج',
        v.QUANTITE_VENTE AS 'كمية المنتوج',
        v.PRIX_VENTE AS 'سعر المنتوج',
        v.PRIX_TOTAL AS 'السعر الكلي'
    FROM tb_vente v
    INNER JOIN TB_PACK_GESTION_PRODUIT_FINAUX pd ON pd.BARCODE_PACK = v.CODE_BARRE_PRODUIT
    WHERE v.ID_FACTURE = @facteure;

    -- Insert from tb_vente without join
    INSERT INTO @Results
    SELECT 
        [ID] AS 'ID',
        [CODE_BARRE_PRODUIT] AS 'رقم المنتوج',
        NULL AS 'اسم المنتوج',
        [QUANTITE_VENTE] AS 'كمية المنتوج',
        [PRIX_VENTE] AS 'سعر المنتوج',
        [PRIX_TOTAL] AS 'السعر الكلي'
    FROM tb_vente
    WHERE ID_FACTURE = @facteure
    AND CODE_BARRE_PRODUIT NOT IN (
        SELECT CodeBarre FROM TB_Produit_revente
        UNION
        SELECT pack_code_barre FROM TB_PACK_PRODUIT_REVENT
        UNION
        SELECT CODE_BARRE FROM TB_GESTION_PRODUIT_FINAUX
        UNION
        SELECT BARCODE_PACK FROM TB_PACK_GESTION_PRODUIT_FINAUX
    );

    -- Display results
    SELECT * FROM @Results;
END















GO
/****** Object:  StoredProcedure [dbo].[historique_cofre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[historique_cofre]
as
SELECT [ID] 
      ,[DATE] as'التاريخ'
      ,[HEURE]  as'الوقت'
      ,[SOLD]  as'المبلغ'
      ,[RAISON] as'السبب'
  FROM [dbo].[TB_HISTORIQUE_COFRE]















GO
/****** Object:  StoredProcedure [dbo].[historique_tracage_caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[historique_tracage_caissier]
AS
BEGIN
    SELECT 
        [TB_HISTORIQUE_CAISSIER].[ID],
        TB_INFO_CAISSIER.NAME + ' ' + TB_INFO_CAISSIER.PRENAME AS 'القابض',
        [DATE] AS 'التاريخ',
        [HEURE_ENTRE] AS 'وقت الدخول',
        [HEURE_SORTIE] AS 'وقت الخروج',
        [PRIX_FOND] AS 'مبلغ الدخول',
        [PRIX_CLOTURE] AS 'المبلغ الاخير'
    FROM 
        [dbo].[TB_HISTORIQUE_CAISSIER]
    INNER JOIN 
        TB_INFO_CAISSIER ON TB_INFO_CAISSIER.ID = [TB_HISTORIQUE_CAISSIER].ID_CAISSIE
    ORDER BY 
        [TB_HISTORIQUE_CAISSIER].[ID] DESC;
END

















GO
/****** Object:  StoredProcedure [dbo].[Insert_AchatProduitReventCaisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE PROCEDURE [dbo].[Insert_AchatProduitReventCaisse]
    @CODE_PRODUIT NVARCHAR(50),
    @QUANTITE FLOAT,
    @PRICE_ACHAT_HT MONEY,
    @TVA FLOAT,
    @PRICE_ACHAT_TTC MONEY,
    @TOTAL_HT MONEY,
    @TOTAL_TTC MONEY,
    @REMARQUE NVARCHAR(MAX),
    @ID_FACTURE NVARCHAR(50),
    @QUANTITE_BEFOR FLOAT,
    @QUANTITE_AFTER FLOAT,
    @TYPE_FACTURE NVARCHAR(50)
AS
BEGIN
    INSERT INTO [dbo].[TB_ACHAT_PRODUIT_REVENT_CAISSE]
           ([CODE_PRODUIT]
           ,[QUANTITE]
           ,[PRICE_ACHAT_HT]
           ,[TVA]
           ,[PRICE_ACHAT_TTC]
           ,[TOTAL_HT]
           ,[TOTAL_TTC]
           ,[REMARQUE]
           ,[ID_FACTURE]
           ,[QUANTITE_BEFOR]
           ,[QUANTITE_AFTER]
           ,[TYPE_FACTURE])
     VALUES
           (@CODE_PRODUIT
           ,@QUANTITE
           ,@PRICE_ACHAT_HT
           ,@TVA
           ,@PRICE_ACHAT_TTC
           ,@TOTAL_HT
           ,@TOTAL_TTC
           ,@REMARQUE
           ,@ID_FACTURE
           ,@QUANTITE_BEFOR
           ,@QUANTITE_AFTER
           ,@TYPE_FACTURE)
END

















GO
/****** Object:  StoredProcedure [dbo].[insert_cassier_info]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_cassier_info]
 @NAME		nvarchar(50)
,@PRENAME	nvarchar(50)
,@USER_NAME nvarchar(50)
,@PASSW		nvarchar(50)
as
INSERT INTO [dbo].[TB_INFO_CAISSIER]
           ([NAME]
           ,[PRENAME]
           ,[USER-NAME]
           ,[PASSW])
     VALUES
           (
			 @NAME		
			,@PRENAME	
			,@USER_NAME 
			,@PASSW		
		   ) 


















GO
/****** Object:  StoredProcedure [dbo].[insert_categories]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_categories]
@CATEGORIES nvarchar(50)
as 
INSERT INTO [dbo].[TB_CATEGORIES]
           ([CATEGORIES])
     VALUES
           (
		   @CATEGORIES
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_code_Barre_reserver_codeBarre_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_code_Barre_reserver_codeBarre_pack]
 @CODE_BARRE_OFFICIAL nvarchar(50)
,@CODE_BARRE_RESERVER nvarchar(50)
as
INSERT INTO [dbo].[TB_CODE_BARRE_RESERVER_PACK]
           ([CODE_BARRE_OFFICIAL]
           ,[CODE_BARRE_RESERVER])
     VALUES
           (
		    @CODE_BARRE_OFFICIAL
		   ,@CODE_BARRE_RESERVER
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_color]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_color]
@Color nvarchar(50)
as
INSERT INTO [dbo].[TB_COLOR]
           ([COLOR])
     VALUES
           (@Color)

















GO
/****** Object:  StoredProcedure [dbo].[INSERT_DECHET]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[INSERT_DECHET]
 @ID_MATIER nvarchar(50)
,@QT_Dechet int
,@etas		nvarchar(50)
,@price_u money
,@price_ttl money
AS
INSERT INTO [dbo].[TB_DECHET_REClage]
           ([ID_MATIER]
           ,[QT_Dechet]
           ,[etas]
		   ,price_u 
		   ,price_ttl)
     VALUES
           (
		     @ID_MATIER 
			,@QT_Dechet 
			,@etas	
			,@price_u
			,@price_ttl
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_dechet_non]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_dechet_non]
 @ID_MATIER nvarchar(50)
,@QT_Dechet int
,@etas		nvarchar(50)
,@price_u money
,@price_ttl money
as
INSERT INTO [dbo].[TB_DECHET]
           ([ID_MATIER]
           ,[QT_Dechet]
           ,[etas]
           ,[price_u]
           ,[price_ttl])
     VALUES
           (
		     @ID_MATIER 
			,@QT_Dechet 
			,@etas	
			,@price_u
			,@price_ttl
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[insert_facture]
 @NMR_FACTURE			nvarchar(50)
,@DATE					date
,@HEURE					time(7)
,@ID_CLIENT				int
,@TOTAL_FACURE_TTC		money
,@TOTAL_FACTURE_HT		money
,@TVA					float
,@OLD_SOLD				money
,@VERSEMENT				money
,@NEW_SOLD				money
,@REMISE				money
,@POURSENTAGE_REMISE	float
,@COUNT_ARTICLE			int
,@REMARQUE				nvarchar(max)
,@ETAT					nvarchar(50)
,@ID_USER				int
,@ID_CAISSIER			int
,@cout_of_fctr			money
as
INSERT INTO [dbo].[TB_FACTURE_VENTE]
           ([NMR_FACTURE]
           ,[DATE]
           ,[HEURE]
           ,[ID_CLIENT]
           ,[TOTAL_FACURE_TTC]
           ,[TOTAL_FACTURE_HT]
           ,[TVA]
           ,[OLD_SOLD]
           ,[VERSEMENT]
           ,[NEW_SOLD]
           ,[REMISE]
           ,[POURSENTAGE_REMISE]
           ,[COUNT_ARTICLE]
           ,[REMARQUE]
           ,[ETAT]
           ,[ID_USER]
           ,[ID_CAISSIER]
		   ,cout_of_fctr)
     VALUES
           (
		     @NMR_FACTURE			
			,@DATE					
			,@HEURE					
			,@ID_CLIENT				
			,@TOTAL_FACURE_TTC		
			,@TOTAL_FACTURE_HT		
			,@TVA					
			,@OLD_SOLD				
			,@VERSEMENT				
			,@NEW_SOLD				
			,@REMISE				
			,@POURSENTAGE_REMISE	
			,@COUNT_ARTICLE			
			,@REMARQUE				
			,@ETAT					
			,@ID_USER				
			,@ID_CAISSIER	
			,@cout_of_fctr		
		   )

















GO
/****** Object:  StoredProcedure [dbo].[Insert_FactureAchatProduitRevent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[Insert_FactureAchatProduitRevent]
    @NMR_FCTR NVARCHAR(50),
    @DATE DATETIME,
    @ID_FOURNISSEUR INT,
    @NMBRE_DE_PRODUIT INT,
    @VERSEMNT MONEY,
    @TOTAL MONEY,
    @ID_USER INT,
    @TOTAL_HT MONEY,
    @CREDIT_PRECEDENT MONEY,
    @CREDIT_AFTER MONEY
AS
BEGIN
    INSERT INTO [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]
           ([NMR_FCTR]
           ,[DATE]
           ,[ID_FOURNISSEUR]
           ,[NMBRE_DE_PRODUIT]
           ,[VERSEMNT]
           ,[TOTAL]
           ,[ID_USER]
           ,[TOTAL_HT]
           ,[CREDIT_PRECEDENT]
           ,[CREDIT_AFTER])
     VALUES
           (@NMR_FCTR
           ,@DATE
           ,@ID_FOURNISSEUR
           ,@NMBRE_DE_PRODUIT
           ,@VERSEMNT
           ,@TOTAL
           ,@ID_USER
           ,@TOTAL_HT
           ,@CREDIT_PRECEDENT
           ,@CREDIT_AFTER)
END

















GO
/****** Object:  StoredProcedure [dbo].[insert_fichier_for_fctr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[insert_fichier_for_fctr]
 @ID_FACTURE nvarchar(50)
,@REMARQUE	nvarchar(50)
,@IMAGE		image
as
INSERT INTO [dbo].[TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE]
           (
		    [ID_FACTURE]
           ,[REMARQUE]
           ,[IMAGE]
		   )
     VALUES
           (
		    @ID_FACTURE
		   ,@REMARQUE	
		   ,@IMAGE		
		   )
















GO
/****** Object:  StoredProcedure [dbo].[insert_folder_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE proc [dbo].[insert_folder_facture]
 @ID_FACTURE  nvarchar(50)
,@REMARQUE	  nvarchar(max)
,@IMAGE		  image 
as
INSERT INTO [dbo].[TB_UPLOAD_FICHIER_FACTURE]
           ( [ID_FACTURE]
           ,[REMARQUE]
           ,[IMAGE])
     VALUES
           (
		      @ID_FACTURE  
			,@REMARQUE	  
			,@IMAGE		  
		   )
















GO
/****** Object:  StoredProcedure [dbo].[insert_historique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[insert_historique]
 @DATE	date
,@HEURE	time(7)
,@SOLD	decimal(19,2)
,@RAISON nvarchar(max)
as
INSERT INTO [dbo].[TB_HISTORIQUE_COFRE]
           ( [DATE]
           ,[HEURE]
           ,[SOLD]
           ,[RAISON])
     VALUES
           ( @DATE	
			,@HEURE	
			,@SOLD	
			,@RAISON
		   )















GO
/****** Object:  StoredProcedure [dbo].[insert_history_caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_history_caissier]
 @ID_CAISSIE	int
,@DATE			date
,@HEURE_ENTRE	time(7)
,@HEURE_SORTIE	time(7)
,@PRIX_FOND		money
,@PRIX_CLOTURE	money
as
INSERT INTO [dbo].[TB_HISTORIQUE_CAISSIER]
           ([ID_CAISSIE]
           ,[DATE]
           ,[HEURE_ENTRE]
           ,[HEURE_SORTIE]
           ,[PRIX_FOND]
           ,[PRIX_CLOTURE])
     VALUES
           (
		     @ID_CAISSIE	
			,@DATE			
			,@HEURE_ENTRE	
			,@HEURE_SORTIE	
			,@PRIX_FOND		
			,@PRIX_CLOTURE	
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_history_frnsre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_history_frnsre]
@DATE			date
,@ID_CLIENT		int
,@PRICE			money
,@CREDIT_OLD	money
,@CREDIT_NEW	money
,@REMARQUE		nvarchar(max)
as
INSERT INTO [dbo].[TB_HISTORIQUE_FOURNISSEUR]
           ([DATE]
           ,[ID_CLIENT]
           ,[PRICE]
           ,[CREDIT_OLD]
           ,[CREDIT_NEW]
           ,[REMARQUE])
     VALUES
           (
		    @DATE		
			,@ID_CLIENT	
			,@PRICE		
			,@CREDIT_OLD
			,@CREDIT_NEW
			,@REMARQUE	
		   )

















GO
/****** Object:  StoredProcedure [dbo].[INSERT_HISTORY_PRODUCTION]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[INSERT_HISTORY_PRODUCTION] 
 @DATE				datetime
,@ID_PRODUIT		nvarchar(50)
,@QT_BEFOR			float
,@QT_PROUDCTION		float
,@QT_AFTER			float
,@COUT_PRODUCTION   money
,@ID_USER			int
AS
INSERT INTO [dbo].[TB_HISTORIQUE_PRODUCTION]
           ([DATE]
           ,[ID_PRODUIT]
           ,[QT_BEFOR]
           ,[QT_PROUDCTION]
           ,[QT_AFTER]
           ,[COUT_PRODUCTION]
           ,[ID_USER])
     VALUES
           ( 
		     @DATE				
			,@ID_PRODUIT		
			,@QT_BEFOR			
			,@QT_PROUDCTION		
			,@QT_AFTER			
			,@COUT_PRODUCTION   
			,@ID_USER			
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_hitorique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[insert_hitorique]
 @REMARQUE  nvarchar(max)
,@DATEE		date
,@Heuree	time(7)
as
INSERT INTO [dbo].[historique_delelte]
           ([datee]
           ,[time]
           ,[remarque])
     VALUES
           (
		   @DATEE	,
		   @Heuree ,
		   @REMARQUE
		   )



GO
/****** Object:  StoredProcedure [dbo].[insert_info_livraison]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE proc [dbo].[insert_info_livraison]
 @ID					int
,@DATE				date
,@NOM_DE_LIV		nvarchar(50)
,@NOM_DE_RECU		nvarchar(50)
,@TYPE_DE_LIV		nvarchar(50)
,@PRIC_DE_LIV		money
,@info_chaufeur		nvarchar(50)
,@info_matricule	nvarchar(50) 
,@id_commande		nvarchar(50)
,@Versement			money
as
SET IDENTITY_INSERT [dbo].[TB_INFO_DE_LIV] on 
INSERT INTO [dbo].[TB_INFO_DE_LIV]
           (
		    ID
		   ,[DATE]
           ,[NOM_DE_LIV]
           ,[NOM_DE_RECU]
           ,[TYPE_DE_LIV]
           ,[PRIC_DE_LIV]
           ,[info_chaufeur]
           ,[info_matricule] 
           ,[id_commande]
		   ,Versement)
     VALUES
           (
		     @ID
		    ,@DATE				
			,@NOM_DE_LIV		
			,@NOM_DE_RECU		
			,@TYPE_DE_LIV		
			,@PRIC_DE_LIV		
			,@info_chaufeur		
			,@info_matricule	 		
			,@id_commande	
			,@Versement	
		   )
SET IDENTITY_INSERT [dbo].[TB_INFO_DE_LIV] OFF 


















GO
/****** Object:  StoredProcedure [dbo].[insert_info_livraison_TYPE_2]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[insert_info_livraison_TYPE_2]
 @DATE				date
,@HEURE				time(7)
,@LIVREURE			nvarchar(50)
,@RECEVEUR			nvarchar(50)
,@ID_COMMANDE		nvarchar(50)
,@VERSEMENT_AVANT	money
,@VERSEMENT_ICI		money
,@TOTAL_LIVRAISON	float
,@LIVRAISON_AVANT	float
,@LIVRAISON_ICI		float
,@CREDIT_AVANT		money
,@CREDIT_AFTER		money
AS
INSERT INTO [dbo].[TB_INFO_LIVRAISON_TYPE_2]
           ([DATE]
           ,[HEURE]
           ,[LIVREURE]
           ,[RECEVEUR]
           ,[ID_COMMANDE]
           ,[VERSEMENT_AVANT]
           ,[VERSEMENT_ICI]
           ,[TOTAL_LIVRAISON]
           ,[LIVRAISON_AVANT]
           ,[LIVRAISON_ICI]
           ,[CREDIT_AVANT]
           ,[CREDIT_AFTER])
     VALUES
           (
		     @DATE				
			,@HEURE				
			,@LIVREURE			
			,@RECEVEUR			
			,@ID_COMMANDE		
			,@VERSEMENT_AVANT	
			,@VERSEMENT_ICI		
			,@TOTAL_LIVRAISON	
			,@LIVRAISON_AVANT	
			,@LIVRAISON_ICI		
			,@CREDIT_AVANT		
			,@CREDIT_AFTER
			)


GO
/****** Object:  StoredProcedure [dbo].[INSERT_INFO_SUB_LIV]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create PROC [dbo].[INSERT_INFO_SUB_LIV]
 @ID_HISTORUQE_LIVRAISON int
,@ID_SUB_COMMANDE       int
,@QUANTITE_LIVRE		int
AS
INSERT INTO [dbo].[TB_HISTORIQUE_SUB_COMMANDE]
           ([ID_HISTORUQE_LIVRAISON]
           ,[ID_SUB_COMMANDE]
           ,[QUANTITE_LIVRE])
     VALUES
           (
		    @ID_HISTORUQE_LIVRAISON  
           ,@ID_SUB_COMMANDE         
           ,@QUANTITE_LIVRE		     
		   )
















GO
/****** Object:  StoredProcedure [dbo].[INSERT_INVENTAIRE_PRINCIPAL]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[INSERT_INVENTAIRE_PRINCIPAL]
 @NMR_INVENTAIR	  nvarchar(50)
,@DATE			  date
,@HEURE			  time(7)
,@TOTAL_THEORIQUE decimal(18,2)
,@TOTAL_PHYSIQUE  decimal(18,2)
,@MONTANT_ECART	  decimal(18,2)
,@OBSERVATION	  nvarchar(max)
,@ID_USER		  int
AS
INSERT INTO [dbo].[TB_PRINCIPALE_INVENTAIRE]
           ([NMR_INVENTAIR]
           ,[DATE]
           ,[HEURE]
           ,[TOTAL_THEORIQUE]
           ,[TOTAL_PHYSIQUE]
           ,[MONTANT_ECART]
           ,[OBSERVATION]
           ,[ID_USER])
     VALUES
           (
		    @NMR_INVENTAIR	  
			,@DATE			  
			,@HEURE			  
			,@TOTAL_THEORIQUE 
			,@TOTAL_PHYSIQUE  
			,@MONTANT_ECART	  
			,@OBSERVATION	  
			,@ID_USER		  
		   )


GO
/****** Object:  StoredProcedure [dbo].[insert_marque]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 

create proc [dbo].[insert_marque]
@Marque nvarchar(50)
as 
INSERT INTO [dbo].TB_MARQUE
           (Marque)
     VALUES
           (
		   @Marque
		   )

















GO
/****** Object:  StoredProcedure [dbo].[INSERT_MATIER_PREMIER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[INSERT_MATIER_PREMIER]
@CODEBARRE				nvarchar(50)
,@DESIGNATION			nvarchar(50)
,@UNITE					int
,@CATEGORIES			int
,@STOCKES				int 
,@MARKE					int 
,@QUANTITE				float 
,@QUANTITE_REST			float 
,@QUANTITE_USE			float 
,@QUANTITE_PACKES		float 
,@PHOTO					image
,@DATE_PREPARATION		date
,@OBSERVATION			nvarchar(max)
,@STOCKES_MIN			int
,@PRODUIT_DES_PIECES	nvarchar(50)
,@reference				nvarchar(50)
,@PRICE_HT				decimal(19,2)
,@PRICE_TTC				decimal(19,2)
,@TVA					decimal(19,2)

AS	
INSERT INTO [dbo].[TB_MATIER_PREMIER]
           ([CODEBARRE]
           ,[DESIGNATION]
           ,[UNITE]
           ,[CATEGORIES]
           ,[STOCKES]
           ,[MARKE]
           ,[QUANTITE]
           ,[QUANTITE_REST]
           ,[QUANTITE_USE]
           ,[QUANTITE_PACKES]
           ,[PHOTO]
           ,[DATE_PREPARATION]
           ,[OBSERVATION]
           ,[STOCKES_MIN]
           ,[PRODUIT_DES_PIECES]
		   ,REFERENCE
		   ,PRICE_HT
		   ,PRICE_TTC
		   ,TVA
		   )
     VALUES
           (
			 @CODEBARRE			
			,@DESIGNATION		
			,@UNITE				
			,@CATEGORIES			
			,@STOCKES			
			,@MARKE				
			,@QUANTITE			
			,@QUANTITE_REST		
			,@QUANTITE_USE		
			,@QUANTITE_PACKES	
			,@PHOTO				
			,@DATE_PREPARATION	
			,@OBSERVATION		
			,@STOCKES_MIN		
			,@PRODUIT_DES_PIECES
			,@reference	
			,@PRICE_HT				
			,@PRICE_TTC				
			,@TVA					
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_matier_premier_for_edit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[insert_matier_premier_for_edit]
 @ID_PRODUIT_FINAUX	nvarchar(50)
,@ID_MATIER_PREMIER	nvarchar(50)
,@Qt					float
,@PRICE_ACHAT		money
,@PRICE_TTL			money
,@QT_DECHET			float
,@delete			nvarchar(50)
as
INSERT INTO [dbo].[TB_MATIER_PREMIER_PRODUCTION]
           ([ID_PRODUIT_FINAUX]
           ,[ID_MATIER_PREMIER]
           ,[QT]
           ,[PRICE_ACHAT]
           ,[PRICE_TTL]
           ,[QT_DECHET]
           ,[delte])
     VALUES
           (
		     @ID_PRODUIT_FINAUX
			,@ID_MATIER_PREMIER
			,@Qt					
			,@PRICE_ACHAT		
			,@PRICE_TTL			
			,@QT_DECHET		
			,@delete	
		   )

















GO
/****** Object:  StoredProcedure [dbo].[INSERT_matier_premier_production_caisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc  [dbo].[INSERT_matier_premier_production_caisse]
 @ID_PRODUIT_FINAUX	nvarchar(50)
,@ID_MATIER_PREMIER	nvarchar(50)
,@Qt					float
,@PRICE_ACHAT		money
,@PRICE_TTL			money
,@QT_DECHET			float
,@delete			nvarchar(50)

AS
INSERT INTO [dbo].[TB_MATIER_PREMIER_PRODUCTION_CAISS]
           ([ID_PRODUIT_FINAUX]
           ,[ID_MATIER_PREMIER]
           ,[QT]
           ,[PRICE_ACHAT]
           ,[PRICE_TTL]
           ,[QT_DECHET]
		   ,delte)
     VALUES
           (
		     @ID_PRODUIT_FINAUX
			,@ID_MATIER_PREMIER
			,@Qt					
			,@PRICE_ACHAT		
			,@PRICE_TTL			
			,@QT_DECHET		
			,@delete	
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_notif]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[insert_notif]
@NOTIFICATION NVARCHAR(MAX)
as 
INSERT INTO [dbo].[TB_NOTIFICATION]
           ([NOTIFICATION])
     VALUES
           (@NOTIFICATION)















GO
/****** Object:  StoredProcedure [dbo].[insert_option_product]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[insert_option_product] 
 @ID_PRODUIT nvarchar(50)
,@OPTION     nvarchar(50)
,@VALEUR     nvarchar(50)
as
INSERT INTO [dbo].[TB_OPTION_PRODUIT]
           ([ID_PRODUIT]
           ,[OPTION]
           ,[VALEUR])
     VALUES
           (
		     @ID_PRODUIT 
			,@OPTION     
			,@VALEUR     
		    )

















GO
/****** Object:  StoredProcedure [dbo].[insert_pack_information]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[insert_pack_information]
 @BARCODE_PACK		nvarchar(50)
,@DESIGNATION		nvarchar(50)
,@ID_PRODUIT_FINAUX nvarchar(50)
,@QT_DISPONIBLE		float
,@PRICE_GROS		money
,@PRICE_DETAILLE	money
,@PRICE_MIN			money
as
INSERT INTO [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
           ([BARCODE_PACK]
           ,[DESIGNATION]
           ,[ID_PRODUIT_FINAUX]
           ,[QT_DISPONIBLE]
           ,[PRICE_GROS]
           ,[PRICE_DETAILLE]
           ,[PRICE_MIN])
     VALUES
           (
		     @BARCODE_PACK		
			,@DESIGNATION		
			,@ID_PRODUIT_FINAUX 
			,@QT_DISPONIBLE		
			,@PRICE_GROS		
			,@PRICE_DETAILLE	
			,@PRICE_MIN			
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_proc_]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_proc_]
 @MacAdress nvarchar(max)
,@Serial	nvarchar(max)
,@instal_Day date
as  
INSERT INTO [dbo].[TB_MAX_ADRESS]
           ([MacAdress]
           ,[Serial]
           ,[instal_Day])
     VALUES
           (
		    @MacAdress 
		   ,@Serial	
		   ,@instal_Day
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_Produit_Matier_premier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_Produit_Matier_premier]
@CODEBARRE			int
,@DESIGNATION		nvarchar(50)
,@UNITE				int
,@CATEGORIES		int
,@STOCKES			int
,@MARKE				int
,@QUANTITE			int
,@QUANTITE_REST		int
,@QUANTITE_USE		int
,@QUANTITE_PACKES	int
,@PHOTO				image
,@DATE_PREPARATION date
,@OBSERVATION		nvarchar(max)
,@STOCKES_MIN		int
,@PRODUIT_DES_PIECES nvarchar(50)
as
INSERT INTO [dbo].[TB_MATIER_PREMIER]
           ([CODEBARRE]
           ,[DESIGNATION]
           ,[UNITE]
           ,[CATEGORIES]
           ,[STOCKES]
           ,[MARKE]
           ,[QUANTITE]
           ,[QUANTITE_REST]
           ,[QUANTITE_USE]
           ,[QUANTITE_PACKES]
           ,[PHOTO]
           ,[DATE_PREPARATION]
           ,[OBSERVATION]
           ,[STOCKES_MIN]
           ,[PRODUIT_DES_PIECES])
     VALUES
           (
		    @CODEBARRE			
			,@DESIGNATION		
			,@UNITE				
			,@CATEGORIES		
			,@STOCKES			
			,@MARKE				
			,@QUANTITE			
			,@QUANTITE_REST		
			,@QUANTITE_USE		
			,@QUANTITE_PACKES	
			,@PHOTO				
			,@DATE_PREPARATION 
			,@OBSERVATION		
			,@STOCKES_MIN		
			,@PRODUIT_DES_PIECES
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_routour_historique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[insert_routour_historique]
 @CODE_BARRE_PRODUIT	nvarchar(50)
,@QT					float
,@ID_CAISSIER			int
,@ID_USER				int
,@DATE					date
,@HEURE					time(7)
,@price_U				money
,@Price_TTl				money
,@PRice_achat_ttl		money
as 
INSERT INTO [dbo].[TB_ROUTOUR_PRODUIT]
           ([CODE_BARRE_PRODUIT]
           ,[QT]
           ,[ID_CAISSIER]
           ,[ID_USER]
           ,[DATE]
           ,[HEURE]
           ,[price_U]
           ,[Price_TTl]
		   ,PRice_achat_ttl
		   )
     VALUES
           (
		    @CODE_BARRE_PRODUIT	
		   ,@QT					
		   ,@ID_CAISSIER			
		   ,@ID_USER				
		   ,@DATE					
		   ,@HEURE					
		   ,@price_U				
		   ,@Price_TTl	
		   ,@PRice_achat_ttl			
		   )
















GO
/****** Object:  StoredProcedure [dbo].[insert_stock_for_facturation]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[insert_stock_for_facturation]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج' 
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj  - [Quantite_rest] as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  LEFT join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  LEFT join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  LEFT join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  LEFT join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
--++++++++++++++++++++++++++++++++++



GO
/****** Object:  StoredProcedure [dbo].[insert_Taille]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[insert_Taille]
@Taille nvarchar(50)
as
INSERT INTO [dbo].[TB_TAILLE]
           ([TAILLE])
     VALUES
           (
		   @Taille
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_TB_Coffre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[insert_TB_Coffre]
@SOLD_ON_COFRE decimal(19,2)
as
 
INSERT INTO [dbo].[TB_COFRE]
           ([SOLD_ON_COFRE])
     VALUES
           (@SOLD_ON_COFRE)















GO
/****** Object:  StoredProcedure [dbo].[insert_tb_depense]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[insert_tb_depense]
@CAUSE_DEPENSE nvarchar(max)
,@VALEURE		money
,@DATE			datetime
,@USER_ID		int
as
INSERT INTO [dbo].[TB_DEPENSE]
           (
		   [CAUSE_DEPENSE]
           ,[VALEURE]
           ,[DATE]
           ,[USER_ID])
     VALUES
           (
		     
			 @CAUSE_DEPENSE 
			,@VALEURE		
			,@DATE			
			,@USER_ID		
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_tb_historique_clien]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[insert_tb_historique_clien]
 @DATE			date
,@ID_CLIENT		int
,@total_amount  money
,@PRICE			money
,@CREDIT_OLD	money
,@CREDIT_NEW	money
,@REMARQUE		nvarchar(50)
,@ID_FACTURE	nvarchar(50)
as
INSERT INTO [dbo].[TB_HISTORIQUE_CLIENT]
           ([DATE]
           ,[ID_CLIENT]
		   ,total_amounte
           ,[PRICE]
           ,[CREDIT_OLD]
           ,[CREDIT_NEW]
           ,[REMARQUE]
		   ,ID_FACTURE)
     VALUES
           (
		     @DATE		
			,@ID_CLIENT	
			,@total_amount
			,@PRICE		
			,@CREDIT_OLD
			,@CREDIT_NEW
			,@REMARQUE	
			,@ID_FACTURE
		   )

















GO
/****** Object:  StoredProcedure [dbo].[INSERT_TB_HISTORIQUE_DEMONTER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 
CREATE PROC  [dbo].[INSERT_TB_HISTORIQUE_DEMONTER]
 @DATE				datetime
,@ID_PRODUIT		nvarchar(50)
,@QT_BEFOR			float
,@QT_PROUDCTION		float
,@QT_AFTER			float
,@COUT_PRODUCTION   money
,@ID_USER			int
AS
INSERT INTO [dbo].TB_HISTORIQUE_DEMONTER
           ([DATE]
           ,[ID_PRODUCTION]
           ,[QT_BEFOR]
           ,QT_PRODUCTION
           ,[QT_AFTER]
           ,[COUT_PRODUCTION]
           ,[ID_USER])
     VALUES
           ( 
		     @DATE				
			,@ID_PRODUIT		
			,@QT_BEFOR			
			,@QT_PROUDCTION		
			,@QT_AFTER			
			,@COUT_PRODUCTION   
			,@ID_USER			
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_TB_MATIER_USE_SUB_CMND]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[insert_TB_MATIER_USE_SUB_CMND]
 @ID_MATIER			nvarchar(50)
,@ID_SUB_COMMANDE	int
,@QT				float
,@COUT				money
,@NAME_MATIER		nvarchar(50)
,@QTDECHET			float
,@delte				nvarchar(50)
as
INSERT INTO [dbo].TB_MATIER_USE_SUB_CMND_caise
           ([ID_MATIER]
           ,[ID_SUB_COMMANDE]
           ,[QT]
           ,[COUT]
           ,[NAME_MATIER]
           ,[QTDECHET]
		   ,delte)
     VALUES
           (
		     @ID_MATIER			
			,@ID_SUB_COMMANDE	
			,@QT				
			,@COUT				
			,@NAME_MATIER		
			,@QTDECHET	
			,@delte
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 

create proc [dbo].[insert_unite]
@Unite nvarchar(50)
as
INSERT INTO [dbo].[TB_UNITE]
           ([UNITE])
     VALUES
           (
		   @Unite
		   )

















GO
/****** Object:  StoredProcedure [dbo].[insert_user_info]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE PROCEDURE [dbo].[insert_user_info]
    @ID_OUVERIER int,
    @USERR nvarchar(50),
    @PASS nvarchar(50),
    @ROLE nvarchar(50),
    @ETAS nvarchar(50),
	@Code_Recupiraiton nvarchar(50),
	@Stock				int,
	@unite						int,
	@categorie			int,
	@marque				int,
	@favoris				int,
	@taille				int,
	@color				int,
	@fournisseure		 int,
	@ouverier			int,
	@users				int,
	@caissier			int,
	@client				int,
	@historique_client	 int,
	@remarque			int,
	@achat				int,
	@facture_achat		int,
	@dossier_fctr_achat	int,
	@historique_frnsre	int,
	@stock_produit		int,
	@pack				int,
	@facture_vente		 int,
	@list_vente			int,
	@liv					int,
	@POS					 int,
	@les_charge			 int,
	@lapie				int,
	@transition_caissier int,
	@state_total			int,
	@benifice			int,
	@serverss			int,
	@facture_info		int
AS
BEGIN
    INSERT INTO [dbo].[TB_USER]
           ([ID_OUVERIER]
           ,[USERR]
           ,[PASS]
           ,[ROLE]
           ,[ETAS]
		   ,Code_Recupiraiton
           ,[Stock]
           ,[unite]
           ,[categorie]
           ,[marque]
           ,[favoris]
           ,[taille]
           ,[color]
           ,[fournisseure]
           ,[ouverier]
           ,[users]
           ,[caissier]
           ,[client]
           ,[historique_client]
           ,[remarque]
           ,[achat]
           ,[facture_achat]
           ,[dossier_fctr_achat]
           ,[historique_frnsre]
           ,[stock_produit]
           ,[pack]
           ,[facture_vente]
           ,[list_vente]
           ,[liv]
           ,[POS]
           ,[les_charge]
           ,[lapie]
           ,[transition_caissier]
           ,[state_total]
           ,[benifice]
           ,[serverss]
           ,[facture_info]
		   )
     VALUES
           (@ID_OUVERIER
           ,@USERR
           ,@PASS
           ,@ROLE
           ,@ETAS
		   ,@Code_Recupiraiton
		   , @Stock				,
			@unite						,
			@categorie			,
			@marque				,
			@favoris				,
			@taille				,
			@color				,
			@fournisseure		 ,
			@ouverier			,
			@users				,
			@caissier			,
			@client				,
			@historique_client	 ,
			@remarque			,
			@achat				,
			@facture_achat		,
			@dossier_fctr_achat	,
			@historique_frnsre	,
			@stock_produit		,
			@pack				,
			@facture_vente		 ,
			@list_vente			,
			@liv					,
			@POS					 ,
			@les_charge			 ,
			@lapie				,
			@transition_caissier ,
			@state_total			,
			@benifice			,
			@serverss			,
			@facture_info		);
END

















GO
/****** Object:  StoredProcedure [dbo].[insert_vente_]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[insert_vente_]
 @CODE_BARRE_PRODUIT nvarchar(50)
,@QUANTITE_VENTE	 float
,@PRIX_VENTE		 money
,@PRIX_TOTAL		 money
,@ID_FACTURE		 nvarchar(50)
,@cout				 money
,@typee nvarchar(50)
as
INSERT INTO [dbo].[TB_VENTE]
           ([CODE_BARRE_PRODUIT]
           ,[QUANTITE_VENTE]
           ,[PRIX_VENTE]
           ,[PRIX_TOTAL]
           ,[ID_FACTURE]
		   ,cout,
		   typee
		   )
     VALUES
           (
		    @CODE_BARRE_PRODUIT 
		   ,@QUANTITE_VENTE	 
		   ,@PRIX_VENTE		 
		   ,@PRIX_TOTAL		 
		   ,@ID_FACTURE
		   ,@cout
		   ,@typee		 
		   )

















GO
/****** Object:  StoredProcedure [dbo].[InsertDetailleInventaire]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[InsertDetailleInventaire]
    @CODEBARRE_PRODUIT NVARCHAR(50),
    @QUANTITE_THERORIQUE DECIMAL(18,2),
    @QUANTITE_PHY DECIMAL(18,2),
    @ECART DECIMAL(18,2),
    @PU DECIMAL(18,2),
    @P_TTL_ECART DECIMAL(18,2),
    @OBSERVATION NVARCHAR(MAX),
    @ID_PRINCIPALE_INVENTAIRE NVARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;
    
    INSERT INTO [dbo].[TB_DETAILLE_INVENTAIRE] 
    (
        [CODEBARRE_PRODUIT], 
        [QUANTITE_THERORIQUE], 
        [QUANTITE_PHY], 
        [ECART], 
        [PU], 
        [P_TTL_ECART], 
        [OBSERVATION], 
        [ID_PRINCIPALE_INVENTAIRE]
    )
    VALUES 
    (
        @CODEBARRE_PRODUIT, 
        @QUANTITE_THERORIQUE, 
        @QUANTITE_PHY, 
        @ECART, 
        @PU, 
        @P_TTL_ECART, 
        @OBSERVATION, 
        @ID_PRINCIPALE_INVENTAIRE
    );
END;

GO
/****** Object:  StoredProcedure [dbo].[InsertFacturation]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[InsertFacturation]
    @Nmr_facture NVARCHAR(50),
    @id_client INT,
    @id_caissie INT,
    @id_user INT,
    @date DATE,
    @heure TIME(7),
    @Total_ttc DECIMAL(18,2),
    @total_ht DECIMAL(18,2),
    @tva DECIMAL(18,2),
    @remise DECIMAL(18,2),
    @pourcentage_remise FLOAT,
    @tembre FLOAT,
    @price_originale DECIMAL(18,2),
    @Count_article INT,
    @ttl_QTT FLOAT,
    @price_arabe NVARCHAR(50),
    @price_fr NVARCHAR(50),
    @type_payment NVARCHAR(50),
    @old_sold DECIMAL(18,2),
    @versement DECIMAL(18,2),
    @new_sold DECIMAL(18,2),
    @remarque NVARCHAR(MAX),
    @cout_fctr DECIMAL(18,2),
    @etas NVARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;

    INSERT INTO [dbo].[TB_FACTURATION]
    (
        [Nmr_facture],
        [id_client],
        [id_caissie],
        [id_user],
        [date],
        [heure],
        [Total_ttc],
        [total_ht],
        [tva],
        [remise],
        [pourcentage_remise],
        [tembre],
        [price_originale],
        [Count_article],
        [ttl_QTT],
        [price_arabe],
        [price_fr],
        [type_payment],
        [old_sold],
        [versement],
        [new_sold],
        [remarque],
        [cout_fctr],
        [etas]
    )
    VALUES
    (
        @Nmr_facture,
        @id_client,
        @id_caissie,
        @id_user,
        @date,
        @heure,
        @Total_ttc,
        @total_ht,
        @tva,
        @remise,
        @pourcentage_remise,
        @tembre,
        @price_originale,
        @Count_article,
        @ttl_QTT,
        @price_arabe,
        @price_fr,
        @type_payment,
        @old_sold,
        @versement,
        @new_sold,
        @remarque,
        @cout_fctr,
        @etas
    );
END


GO
/****** Object:  StoredProcedure [dbo].[InsertFacturationVente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[InsertFacturationVente]
    @CODE_BARRE NVARCHAR(50),
    @DESIGNATION NVARCHAR(50),
    @N_COLIS FLOAT,
    @COLISSAGE FLOAT,
    @QTE FLOAT,
    @PRIC_U DECIMAL(18,2),
    @PRIE_TTL DECIMAL(18,2),
    @REMISE DECIMAL(18,2),
    @PRICE_APRES_REMISE DECIMAL(18,2),
    @PRNST FLOAT,
    @nmr_fctr NVARCHAR(50)
AS
BEGIN
    INSERT INTO [dbo].[TB_FACTURATION_VENTE]
           ([CODE_BARRE]
           ,[DESIGNATION]
           ,[N_COLIS]
           ,[COLISSAGE]
           ,[QTE]
           ,[PRIC_U]
           ,[PRIE_TTL]
           ,[REMISE]
           ,[PRICE_APRES_REMISE]
           ,[PRNST]
           ,[nmr_fctr])
     VALUES
           (@CODE_BARRE
           ,@DESIGNATION
           ,@N_COLIS
           ,@COLISSAGE
           ,@QTE
           ,@PRIC_U
           ,@PRIE_TTL
           ,@REMISE
           ,@PRICE_APRES_REMISE
           ,@PRNST
           ,@nmr_fctr)
END


GO
/****** Object:  StoredProcedure [dbo].[InsertIntoLivraisonVente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE PROCEDURE [dbo].[InsertIntoLivraisonVente]
    @DATE datetime,
    @SENDER nvarchar(50),
    @RECUPIRATEUR nvarchar(50),
    @TYPE_LIV nvarchar(50),
    @PRICE_LIV money,
    @INFORMATION_CHAUFEURE nvarchar(50),
    @MATRICULE nvarchar(50),
    @ID_USER int,
    @ID_CAISSIER int,
    @id_Facture nvarchar(50)
AS
BEGIN
    INSERT INTO [dbo].[TB_LIVRAISON_VENTE]
           ([DATE]
           ,[SENDER]
           ,[RECUPIRATEUR]
           ,[TYPE_LIV]
           ,[PRICE_LIV]
           ,[INFORMATION_CHAUFEURE]
           ,[MATRICULE]
           ,[ID_USER]
           ,[ID_CAISSIER]
           ,[id_Facture])
     VALUES
           (@DATE
           ,@SENDER
           ,@RECUPIRATEUR
           ,@TYPE_LIV
           ,@PRICE_LIV
           ,@INFORMATION_CHAUFEURE
           ,@MATRICULE
           ,@ID_USER
           ,@ID_CAISSIER
           ,@id_Facture)
END

















GO
/****** Object:  StoredProcedure [dbo].[InsertPackProduitRevent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE PROCEDURE [dbo].[InsertPackProduitRevent]
    @pack_code_barre NVARCHAR(50),
    @pack_designation NVARCHAR(50),
    @code_barre_produit NVARCHAR(50),
    @quantite FLOAT,
    @price_unitair MONEY,
    @photo IMAGE,
    @id_favoire INT,
	@photo_code_barre image
AS
BEGIN
    INSERT INTO [dbo].[TB_PACK_PRODUIT_REVENT]
           ([pack_code_barre]
           ,[pack_designation]
           ,[code_barre_produit]
           ,[quantite]
           ,[price_unitair]
           ,[photo]
           ,[id_favoire]
		   ,photo_code_barre)
     VALUES
           (@pack_code_barre
           ,@pack_designation
           ,@code_barre_produit
           ,@quantite
           ,@price_unitair
           ,@photo
           ,@id_favoire
		   ,@photo_code_barre)
END

















GO
/****** Object:  StoredProcedure [dbo].[InsertRepatationRecord]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROCEDURE [dbo].[InsertRepatationRecord]
    @NMR_OPERATION NVARCHAR(50),
    @DATE_ENTRE DATE,
    @TIME TIME(0),
    @CLIENT NVARCHAR(50),
    @NMR_TEL_ NVARCHAR(50),
    @PROBLEM NVARCHAR(MAX),
    @PRIX DECIMAL(18,2), 
    @ETAS NVARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;
    
    INSERT INTO [dbo].[TB_repatation]
        ([NMR_OPERATION], [DATE_ENTRE], [TIME], [CLIENT], [NMR_TEL_], [PROBLEM], [PRIX], [ETAS])
    VALUES
        (@NMR_OPERATION, @DATE_ENTRE, @TIME, @CLIENT, @NMR_TEL_, @PROBLEM, @PRIX, @ETAS);
END;



GO
/****** Object:  StoredProcedure [dbo].[INVOICE_FACTURE_ACHAT_REVENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[INVOICE_FACTURE_ACHAT_REVENT]
@ID_FACTURE NVARCHAR(50)
AS
SELECT [TB_ACHAT_PRODUIT_REVENT].[ID]
      ,[CODE_PRODUIT]
	  -- 
	  ,TB_Produit_revente.designation
      ,[QUANTITE]
      ,[TB_ACHAT_PRODUIT_REVENT].[PRICE_ACHAT_HT]
      ,[TB_ACHAT_PRODUIT_REVENT].[TVA]
      ,[TB_ACHAT_PRODUIT_REVENT].[PRICE_ACHAT_TTC]
      ,[TB_ACHAT_PRODUIT_REVENT].[TOTAL_HT]
      ,[TOTAL_TTC]
      ,TB_ACHAT_PRODUIT_REVENT.[REMARQUE]
      ,[ID_FACTURE]
      ,[QUANTITE_BEFOR]
      ,[QUANTITE_AFTER]
	  -- FACTURE [NMR_FCTR]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[DATE]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[NMBRE_DE_PRODUIT]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[VERSEMNT]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[TOTAL]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[ID_USER]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[TOTAL_HT]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[CREDIT_PRECEDENT]
      ,TB_FACTURE_ACHAT_PRODUIT_REVENT.[CREDIT_AFTER]  
	  --fournisseure
	  ,TB_FOURNISSUER.NAME+' '+TB_FOURNISSUER.PRENAME as'fournisseure'
	  --user
	  ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'User'
  FROM [dbo].[TB_ACHAT_PRODUIT_REVENT]
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_ACHAT_PRODUIT_REVENT.CODE_PRODUIT
  inner join TB_FACTURE_ACHAT_PRODUIT_REVENT on TB_FACTURE_ACHAT_PRODUIT_REVENT.NMR_FCTR = [TB_ACHAT_PRODUIT_REVENT].ID_FACTURE
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT_PRODUIT_REVENT.ID_FOURNISSEUR
  inner join TB_USER on TB_USER.ID = TB_FACTURE_ACHAT_PRODUIT_REVENT.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER















GO
/****** Object:  StoredProcedure [dbo].[invoice_select_detaille_livraison]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 CREATE proc [dbo].[invoice_select_detaille_livraison]
@ID_liv int
as
SELECT [TB_HISTORIQUE_SUB_COMMANDE].[ID]
		,TB_INFO_DE_LIV.[ID]
		,TB_INFO_DE_LIV.[DATE]
		,[NOM_DE_RECU]
		,[TYPE_DE_LIV]
		,[info_chaufeur]
		,[info_matricule] 
		,[PRIC_DE_LIV]
		,TB_INFO_DE_LIV.[Versement] 
		,[NOM_DE_LIV] 
		,[PRIC_DE_LIV]
		,[info_chaufeur]
		,[info_matricule] 
		------------------------------------------------
		,TB_SUM_COMMANDE.SUB_COMMANDE_TITLE as'اسم المنتج' 
		,TB_SUM_COMMANDE.PRIX_UNITAIR 
		,[QUANTITE_LIVRE] as'الكمية' 
		------------------------------------------------
		,TB_COMMANDE.ID
		,TB_COMMANDE.[DATE]
		,[NOM_COMMANDE] 
		,[TYPE_COMMANDE]
		,[COUT_TOTAL] 
		,TB_COMMANDE.[VERSEMENT] as'vss'
		,[QTE]
		,[REMARQUE]
		,[PRICE_TOTAL_HT]
		,[PRICE_TOTAL_TTC]
		,[TVA]
		,[deadline_Date]
		,[etas]
		,[id_user]
		,[TMBER]
		,[PRICE_ARAB]
		,TB_COMMANDE.[historique_Money]
		,TB_COMMANDE.[new_money]
		------------------------------------------------
		,[NAME]
		,[PRENAME]
		,[PHONE]
		,[FAX]
		,[EMAIL]
		,[SOLD_TOTAL]
		,[SOLD_PAYE]
		,[SOLD_NON_PAYE]
		,[ADRESSE]
		,[Sold_avance]
		,[MAX_CREDIT]
		,[NIF]
		,[RC]
		,[Nic]
		,[article]
		,[originale_name_prename]
		------------------------------------------------
  FROM [dbo].[TB_HISTORIQUE_SUB_COMMANDE]
  left join TB_INFO_DE_LIV on TB_INFO_DE_LIV.ID = TB_HISTORIQUE_SUB_COMMANDE.ID_HISTORUQE_LIVRAISON
  left join TB_SUM_COMMANDE on TB_SUM_COMMANDE.id  = TB_HISTORIQUE_SUB_COMMANDE.ID_SUB_COMMANDE 
  left join TB_COMMANDE on TB_COMMANDE.ID  = TB_SUM_COMMANDE.ID_COMMANDE 
  left join TB_CLIENT on TB_CLIENT.ID  = TB_COMMANDE.ID_CLIENT
  where [TB_HISTORIQUE_SUB_COMMANDE].ID_HISTORUQE_LIVRAISON = @ID_liv
 


















GO
/****** Object:  StoredProcedure [dbo].[invoise_get_info_commande_invoise]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[invoise_get_info_commande_invoise]
@ID_facture nvarchar(50)
as
SELECT [TB_SUM_COMMANDE].[ID] 
      ,[SUB_COMMANDE_TITLE]
      ,[QUANTITE]
      ,[PRIX_UNITAIR]
      ,[PRIX_TOTAL]
      ,[QTE_REST]
      ,[QT_LIVRE]
      ,[price_cout]
	  ,TB_COMMANDE.[ID]
	  ,[DATE]
	  ,[NOM_COMMANDE]
	  ,[ID_CLIENT]
	  ,[TYPE_COMMANDE]
	  ,[COUT_TOTAL]
	  ,[VERSEMENT]
	  ,[QTE]
	  ,TB_COMMANDE.[REMARQUE]
	  ,[PRICE_TOTAL_HT]
	  ,[PRICE_TOTAL_TTC]
	  ,[TVA]
	  ,[deadline_Date]
	  ,TB_COMMANDE.[etas] 
	  ,[TMBER]
	  ,[PRICE_ARAB] 
	  ,TB_CLIENT.[NAME]
	  ,TB_CLIENT.[PRENAME]
	  ,TB_CLIENT.[PHONE]
	  ,[FAX]
	  ,[EMAIL]
	  ,[SOLD_TOTAL]
	  ,[SOLD_PAYE]
	  ,[SOLD_NON_PAYE]
	  ,[ADRESSE]
	  ,[Sold_avance]
	  ,[MAX_CREDIT]
	  ,[NIF]
	  ,[RC]
	  ,[Nic]
	  ,[article]
	  ,[originale_name_prename]
	  ,TB_OUVERIER.[NAME]
      ,TB_OUVERIER.[PRENAME]
      ,[FONCTION] 
	  ,TB_COMMANDE.historique_Money
	  ,TB_COMMANDE.new_money
	  ,TB_COMMANDE.Price_en_francais
  FROM [dbo].[TB_SUM_COMMANDE]
  inner join TB_COMMANDE on TB_COMMANDE.ID = TB_SUM_COMMANDE.ID_COMMANDE
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  inner join TB_USER on TB_USER.ID = TB_COMMANDE.id_user
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where [TB_SUM_COMMANDE].ID_COMMANDE = @ID_facture
   

















GO
/****** Object:  StoredProcedure [dbo].[list_detaille_facture_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[list_detaille_facture_vente]
@nmr_facture nvarchar(50)
as 
SELECT [ID] 
      ,[CODE_BARRE] as'رقم المنتج'
      ,[DESIGNATION] as'اسم المنتج'
      ,[N_COLIS] as'ع حزم'
      ,[COLISSAGE] as'التغليف'
      ,[QTE] as'الكمية'
      ,[PRIC_U] as'سعر وحدة'
      ,[PRIE_TTL] as'السعر الكلي'
      ,[REMISE] as'الخصم'
      ,[PRICE_APRES_REMISE] as'السعر بعد الخصم'
      ,[PRNST] as'نسبة الخصم'
	  ,nmr_fctr as'رقم الفاتورة'
  FROM [dbo].[TB_FACTURATION_VENTE]
  where nmr_fctr =@nmr_facture


GO
/****** Object:  StoredProcedure [dbo].[list_facture_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[list_facture_vente]
as
SELECT [Nmr_facture] as'رقم الفاتورة'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'الزبون'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابص'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,[date] as'التاريخ'
      ,[heure] as'الوقت'
      ,[Total_ttc] as'المبلغ الكلي TTC'
      ,[total_ht] as'المبلغ الكلي HT'
      ,[tva] as'TVA'
      ,[remise] as'الخصم'
      ,[pourcentage_remise] as'نسبة الخصم'
      ,[tembre] as'الطابع'
      ,[price_originale] as'السعر الأصلي'
      ,[Count_article] as'عدد المنتجات'
      ,[ttl_QTT] as'الكمية الكلية'
      ,[price_arabe] as'السعر بالعربية'
      ,[price_fr] as'السعر بالفرنسية'
      ,[type_payment] as'نوع الدفع'
      ,[old_sold] as'الديون القديمة'
      ,[versement] as'المدفوع'
      ,[new_sold] as'الديون الجديدة'
      ,[TB_FACTURATION].[remarque] as'الملاحظة'
      ,[cout_fctr] as'التكلفة'
      ,[TB_FACTURATION].[etas] as'الحالة'
  FROM [dbo].[TB_FACTURATION]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_FACTURATION.id_client
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_FACTURATION.id_caissie
  inner join TB_USER on TB_USER.ID = TB_FACTURATION.id_user
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER



GO
/****** Object:  StoredProcedure [dbo].[Liv_facture_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[Liv_facture_vente]
@nmr_Facture1 nvarchar(50)
as
SELECT [TB_LIVRAISON_VENTE].[DATE]
      ,[TB_LIVRAISON_VENTE].[SENDER]
      ,[TB_LIVRAISON_VENTE].[RECUPIRATEUR]
      ,[TB_LIVRAISON_VENTE].[TYPE_LIV]
      ,[TB_LIVRAISON_VENTE].[PRICE_LIV]
      ,[TB_LIVRAISON_VENTE].[INFORMATION_CHAUFEURE]
      ,[TB_LIVRAISON_VENTE].[MATRICULE]  
  FROM [dbo].[TB_LIVRAISON_VENTE] 
  inner join TB_FACTURE_VENTE PS on PS.NMR_FACTURE = [TB_LIVRAISON_VENTE].id_Facture
 where [TB_LIVRAISON_VENTE].ID_FACTURE = @nmr_Facture1

 
















GO
/****** Object:  StoredProcedure [dbo].[Logine_caisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[Logine_caisse]
@ID varchar(50) , @PWD varchar(50)
as
SELECT [ID]
      ,[NAME]
      ,[PRENAME]
      ,[USER-NAME]
      ,[PASSW]
  FROM [dbo].[TB_INFO_CAISSIER]  
	WHERE [USER-NAME]=@ID AND [PASSW]=@PWD

















GO
/****** Object:  StoredProcedure [dbo].[print_facturation]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[print_facturation]
@nmr_facture nvarchar(50)
as
SELECT [Nmr_facture]
      ,TB_CLIENT.[NAME]
      ,TB_CLIENT.[PRENAME]
      ,[PHONE]
      ,[FAX]
      ,[EMAIL]
      ,[SOLD_TOTAL]
      ,[SOLD_PAYE]
      ,[SOLD_NON_PAYE]
      ,[ADRESSE]
      ,[Sold_avance]
      ,[MAX_CREDIT]
      ,[NIF]
      ,[RC]
      ,[Nic]
      ,[article]
      ,[originale_name_prename]
	  --//////////////////////////////////////////
      ,TB_INFO_CAISSIER.[NAME]
      ,TB_INFO_CAISSIER.[PRENAME]
	  --////////////////////////////////////////// 
      ,[date]
      ,[heure]
      ,[Total_ttc]
      ,[total_ht]
      ,[tva]
      ,[TB_FACTURATION_VENTE].[remise]
      ,[pourcentage_remise]
      ,[tembre]
      ,[price_originale]
      ,[Count_article]
      ,[ttl_QTT]
      ,[price_arabe]
      ,[price_fr]
      ,[type_payment]
      ,[old_sold]
      ,[versement]
      ,[new_sold]
      ,[remarque]
      ,[cout_fctr]
      ,[etas] 
	  --///////////////////////////
	  ,[TB_FACTURATION_VENTE].[ID]
      ,[CODE_BARRE]
      ,[DESIGNATION]
      ,[N_COLIS]
      ,[COLISSAGE]
      ,[QTE]
      ,[PRIC_U]
      ,[PRIE_TTL]
      ,[TB_FACTURATION_VENTE].[REMISE]
      ,[PRICE_APRES_REMISE]
      ,[PRNST]
      ,[nmr_fctr]
  FROM [dbo].[TB_FACTURATION_VENTE] 
  inner join TB_FACTURATION on TB_FACTURATION.Nmr_facture = TB_FACTURATION_VENTE.nmr_fctr 
  inner join TB_CLIENT on TB_CLIENT.ID = TB_FACTURATION.id_client
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_FACTURATION.id_caissie
  where TB_FACTURATION_VENTE.nmr_fctr = @nmr_facture


GO
/****** Object:  StoredProcedure [dbo].[print_reciepe_reparation]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[print_reciepe_reparation]
@code_barre nvarchar(50)
as
SELECT [NMR_OPERATION]
      ,[DATE_ENTRE]
      ,[TIME]
      ,[CLIENT]
      ,[NMR_TEL_]
      ,[PROBLEM]
      ,[PRIX]
      ,[DATE_SORTIE]
      ,[ETAS]
	  ,[PICTURE_CODE_BARRE]
  FROM [dbo].[TB_repatation]
  where NMR_OPERATION=@code_barre


GO
/****** Object:  StoredProcedure [dbo].[rectefier_after_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[rectefier_after_vente]
@codebarre nvarchar(50),
@Qt_vente float
as
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke]
      ,[id_marque] =[id_marque]
      ,[id_unite] = [id_unite]
      ,[id_taille] = [id_taille]
      ,[id_color] =[id_color]
      ,[id_favoire] = [id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT] = [price_achat_HT]
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL]
      ,[price_vente1] = [price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] = [price_min]
      ,[vente_apres_expiration] = [vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] =[Quantite_vente] -@Qt_vente
      ,[Quantite_rest] =[Quantite_rest] + @Qt_vente
      ,[Quantite_dechet] = [Quantite_dechet]
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
      ,[Quantite_alert] = [Quantite_alert]
      ,[ihtiyaj] =[ihtiyaj]
      ,[barcodeimage] = [barcodeimage]
 WHERE CodeBarre =@codebarre



GO
/****** Object:  StoredProcedure [dbo].[search_caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_caissier]
@ID_search nvarchar(50)
as
SELECT [ID] as'ID'
      ,[NAME] as'اللقب'
      ,[PRENAME] as'الاسم'
      ,[USER-NAME] as'اسم المستخدم'
      ,[PASSW] as'كلمة السر'
  FROM [dbo].[TB_INFO_CAISSIER]
  where 
  		[NAME] LIKE N'%' + @ID_search + '%'
        OR [PRENAME] LIKE N'%' + @ID_search + '%'
        OR [USER-NAME] LIKE N'%' + @ID_search + '%' 
        OR [PASSW] LIKE N'%' + @ID_search + '%'  
















GO
/****** Object:  StoredProcedure [dbo].[search_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_client]
@ID_search nvarchar(50)
as
SELECT [ID] as'ID'
      ,[NAME] as'الاسم'
      ,[PRENAME] as'اللقب'
	  ,[ADRESSE] as'العنوان'
      ,[PHONE] as'الهاتف'
      ,[FAX] as'الفاكس'
      ,[EMAIL] as'الإيميل'
      ,[SOLD_TOTAL] as'المبلغ الكلي'
      ,[SOLD_PAYE] as'المبلغ المدفوع'
      ,[SOLD_NON_PAYE] as'المبلغ الغير مدفوع'
      ,[Sold_avance] as'مبلغ مسبق' 
	   ,MAX_CREDIT AS 'سقف التأخير'
	   ,NIF as 'NIF'
	   ,RC as 'RC'
	   ,Nic as 'Nic'
	   ,article as 'Article'
  FROM [dbo].[TB_CLIENT]
  where    
  		[NAME] LIKE N'%' + @ID_search + '%'
        OR [PRENAME] LIKE N'%' + @ID_search + '%'
        OR [ADRESSE] LIKE N'%' + @ID_search + '%' 
        OR [PHONE] LIKE N'%' + @ID_search + '%' 
        OR [FAX] LIKE N'%' + @ID_search + '%' 
        OR [EMAIL] LIKE N'%' + @ID_search + '%' 
        OR [SOLD_TOTAL] LIKE N'%' + @ID_search + '%' 
        OR [SOLD_PAYE] LIKE N'%' + @ID_search + '%' 
        OR [SOLD_NON_PAYE] LIKE N'%' + @ID_search + '%' 
        OR MAX_CREDIT LIKE N'%' + @ID_search + '%' 
        OR NIF LIKE N'%' + @ID_search + '%' 
        OR Nic LIKE N'%' + @ID_search + '%' 
        OR article LIKE N'%' + @ID_search + '%'  
        


















GO
/****** Object:  StoredProcedure [dbo].[search_code_barre_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
   
CREATE PROC [dbo].[search_code_barre_produit_revent]
@CODE_BARRE NVARCHAR(50)
AS

SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj  - [Quantite_rest] as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  inner join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  inner join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
  WHERE TB_Produit_revente.CodeBarre LIKE  N'%' + @CODE_BARRE + '%' 
--////////////////////////











GO
/****** Object:  StoredProcedure [dbo].[search_Facture_achat]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_Facture_achat]
@ID_SEARCH nvarchar(50)
as
SELECT [NMR_FCTR] as'رفم الفاتورة'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_PRODUIT] as'عدد المنتجات'
      ,[VERSEMENT] as'الدفع'
      ,[TOTAL] as'المبلغ الكلي TTC'
      ,[total_HT] as'المبلغ الكلي HT'
      ,[Creditprecidenet] as'الديون السابقة'
      ,[creditNew] as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT.ID_FRNSR
  inner join TB_USER on TB_USER.ID = TB_FACTURE_ACHAT.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER  
  where    
  		[NMR_FCTR] LIKE N'%' + @ID_search + '%'
        OR [DATE] LIKE N'%' + @ID_search + '%'
        OR TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME LIKE N'%' + @ID_search + '%' 
        OR [NMBRE_PRODUIT] LIKE N'%' + @ID_search + '%' 
        OR [VERSEMENT] LIKE N'%' + @ID_search + '%' 
        OR [TOTAL] LIKE N'%' + @ID_search + '%' 
        OR [total_HT] LIKE N'%' + @ID_search + '%' 
        OR [Creditprecidenet] LIKE N'%' + @ID_search + '%' 
        OR [creditNew] LIKE N'%' + @ID_search + '%' 
        OR TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%' 
        
        

















GO
/****** Object:  StoredProcedure [dbo].[search_Facture_achat_by_between_Date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_Facture_achat_by_between_Date]
 @StartDate DATE,
 @EndDate DATE 
as
SELECT [NMR_FCTR] as'رفم الفاتورة'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_PRODUIT] as'عدد المنتجات'
      ,[VERSEMENT] as'الدفع'
      ,[TOTAL] as'المبلغ الكلي TTC'
      ,[total_HT] as'المبلغ الكلي HT'
      ,[Creditprecidenet] as'الديون السابقة'
      ,[creditNew] as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT.ID_FRNSR
  inner join TB_USER on TB_USER.ID = TB_FACTURE_ACHAT.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER  
   where [TB_FACTURE_ACHAT].[DATE] BETWEEN @StartDate AND @EndDate;
        
        

















GO
/****** Object:  StoredProcedure [dbo].[search_Facture_achat_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_Facture_achat_by_date]
@date date
as
SELECT [NMR_FCTR] as'رفم الفاتورة'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_PRODUIT] as'عدد المنتجات'
      ,[VERSEMENT] as'الدفع'
      ,[TOTAL] as'المبلغ الكلي TTC'
      ,[total_HT] as'المبلغ الكلي HT'
      ,[Creditprecidenet] as'الديون السابقة'
      ,[creditNew] as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT.ID_FRNSR
  inner join TB_USER on TB_USER.ID = TB_FACTURE_ACHAT.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER  
  where     
        [TB_FACTURE_ACHAT].[DATE] = @date
        
        

















GO
/****** Object:  StoredProcedure [dbo].[search_Facture_achat_by_frnsre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_Facture_achat_by_frnsre]
@frnsreID int
as
SELECT [NMR_FCTR] as'رفم الفاتورة'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_PRODUIT] as'عدد المنتجات'
      ,[VERSEMENT] as'الدفع'
      ,[TOTAL] as'المبلغ الكلي TTC'
      ,[total_HT] as'المبلغ الكلي HT'
      ,[Creditprecidenet] as'الديون السابقة'
      ,[creditNew] as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT.ID_FRNSR
  inner join TB_USER on TB_USER.ID = TB_FACTURE_ACHAT.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER  
  where     
        [TB_FACTURE_ACHAT].ID_FRNSR = @frnsreID
        
        

















GO
/****** Object:  StoredProcedure [dbo].[search_facture_par_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[search_facture_par_client]
@ID_client int
as
SELECT [NMR_FACTURE] as'رقم الفاتورة'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME  as'الزبون'
      ,[TOTAL_FACURE_TTC] as'السعر الكلي TTC'
      ,[TOTAL_FACTURE_HT] as'السعر الكلي HT' 
      ,[TVA] as'TVA'
      ,[OLD_SOLD] as'المبلغ القديم'
      ,[VERSEMENT] as'السعر المدفوع'
      ,[NEW_SOLD] as'المبلغ الجديد'
      ,[REMISE] as'الخصم'
      ,[POURSENTAGE_REMISE] as'نسبة الخصم'
      ,[COUNT_ARTICLE] as'عدد المنتجات'
      ,[TB_FACTURE_VENTE].[REMARQUE] as'ملاحظة'
      ,[ETAT] as'الحالة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_FACTURE_VENTE]
  inner join TB_CLIENT on TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
  inner join TB_USER on TB_USER.id = TB_FACTURE_VENTE.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.id = TB_USER.ID_OUVERIER
  where ID_CLIENT = @ID_client
















GO
/****** Object:  StoredProcedure [dbo].[search_facture_par_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[search_facture_par_date]
@Date date
as
SELECT [NMR_FACTURE] as'رقم الفاتورة'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME  as'الزبون'
      ,[TOTAL_FACURE_TTC] as'السعر الكلي TTC'
      ,[TOTAL_FACTURE_HT] as'السعر الكلي HT' 
      ,[TVA] as'TVA'
      ,[OLD_SOLD] as'المبلغ القديم'
      ,[VERSEMENT] as'السعر المدفوع'
      ,[NEW_SOLD] as'المبلغ الجديد'
      ,[REMISE] as'الخصم'
      ,[POURSENTAGE_REMISE] as'نسبة الخصم'
      ,[COUNT_ARTICLE] as'عدد المنتجات'
      ,[TB_FACTURE_VENTE].[REMARQUE] as'ملاحظة'
      ,[ETAT] as'الحالة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_FACTURE_VENTE]
  inner join TB_CLIENT on TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
  inner join TB_USER on TB_USER.id = TB_FACTURE_VENTE.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.id = TB_USER.ID_OUVERIER
  where DATE = @Date
















GO
/****** Object:  StoredProcedure [dbo].[search_facture_produit_revent_]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[search_facture_produit_revent_]
@ID_search nvarchar(50)
as
SELECT [NMR_FCTR]		 as'رفم الفاتورة'
      ,[DATE]			 as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_DE_PRODUIT]as'عدد المنتجات'
      ,[VERSEMNT]		 as'الدفع'
      ,[TOTAL]			 as'المبلغ الكلي TTC'
      ,[TOTAL_HT]		 as'المبلغ الكلي HT'
      ,[CREDIT_PRECEDENT]as'الديون السابقة'
      ,[CREDIT_AFTER] 	 as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_FOURNISSEUR
  inner join TB_USER on TB_USER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where  
  		[NMR_FCTR] LIKE N'%' + @ID_search + '%'
        OR [DATE] LIKE N'%' + @ID_search + '%'
        OR TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME LIKE N'%' + @ID_search + '%' 
        OR [NMBRE_DE_PRODUIT] LIKE N'%' + @ID_search + '%' 
        OR [VERSEMNT] LIKE N'%' + @ID_search + '%' 
        OR [TOTAL] LIKE N'%' + @ID_search + '%' 
        OR [TOTAL_HT] LIKE N'%' + @ID_search + '%' 
        OR [CREDIT_PRECEDENT] LIKE N'%' + @ID_search + '%' 
        OR [CREDIT_AFTER] LIKE N'%' + @ID_search + '%' 
        OR TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%'  
        















GO
/****** Object:  StoredProcedure [dbo].[search_facture_produit_revent_between_Date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


 
CREATE proc [dbo].[search_facture_produit_revent_between_Date]
@StartDate datetime, @EndDate dateTime 
as
SELECT [NMR_FCTR]		 as'رفم الفاتورة'
      ,[DATE]			 as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_DE_PRODUIT]as'عدد المنتجات'
      ,[VERSEMNT]		 as'الدفع'
      ,[TOTAL]			 as'المبلغ الكلي TTC'
      ,[TOTAL_HT]		 as'المبلغ الكلي HT'
      ,[CREDIT_PRECEDENT]as'الديون السابقة'
      ,[CREDIT_AFTER] 	 as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_FOURNISSEUR
  inner join TB_USER on TB_USER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where CONVERT(DATE, [TB_FACTURE_ACHAT_PRODUIT_REVENT].[DATE]) between @StartDate and @EndDate















GO
/****** Object:  StoredProcedure [dbo].[search_facture_produit_revent_by_Date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


 
CREATE PROCEDURE [dbo].[search_facture_produit_revent_by_Date]
    @Date DATE
AS
BEGIN
    SET NOCOUNT ON;

    SELECT 
        [NMR_FCTR] AS 'رفم الفاتورة',
        [DATE] AS 'التاريخ',
        TB_FOURNISSUER.NAME + ' ' + TB_FOURNISSUER.PRENAME AS 'المورد',
        [NMBRE_DE_PRODUIT] AS 'عدد المنتجات',
        [VERSEMNT] AS 'الدفع',
        [TOTAL] AS 'المبلغ الكلي TTC',
        [TOTAL_HT] AS 'المبلغ الكلي HT',
        [CREDIT_PRECEDENT] AS 'الديون السابقة',
        [CREDIT_AFTER] AS 'الديون الجديدة',
        TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME AS 'المستخدم'
    FROM 
        [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]
    INNER JOIN 
        TB_FOURNISSUER ON TB_FOURNISSUER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_FOURNISSEUR
    INNER JOIN 
        TB_USER ON TB_USER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_USER
    INNER JOIN 
        TB_OUVERIER ON TB_OUVERIER.ID = TB_USER.ID_OUVERIER
    WHERE 
        CONVERT(DATE, [TB_FACTURE_ACHAT_PRODUIT_REVENT].[DATE]) = @Date;
END;
















GO
/****** Object:  StoredProcedure [dbo].[search_facture_produit_revent_by_frnsre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[search_facture_produit_revent_by_frnsre]
@ID_frnsre int
as
SELECT [NMR_FCTR]		 as'رفم الفاتورة'
      ,[DATE]			 as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_DE_PRODUIT]as'عدد المنتجات'
      ,[VERSEMNT]		 as'الدفع'
      ,[TOTAL]			 as'المبلغ الكلي TTC'
      ,[TOTAL_HT]		 as'المبلغ الكلي HT'
      ,[CREDIT_PRECEDENT]as'الديون السابقة'
      ,[CREDIT_AFTER] 	 as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_FOURNISSEUR
  inner join TB_USER on TB_USER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_FOURNISSEUR = @ID_frnsre















GO
/****** Object:  StoredProcedure [dbo].[search_facture_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[search_facture_vente]
@ID_search int
as
SELECT [NMR_FACTURE] as'رقم الفاتورة'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME  as'الزبون'
      ,[TOTAL_FACURE_TTC] as'السعر الكلي TTC'
      ,[TOTAL_FACTURE_HT] as'السعر الكلي HT' 
      ,[TVA] as'TVA'
      ,[OLD_SOLD] as'المبلغ القديم'
      ,[VERSEMENT] as'السعر المدفوع'
      ,[NEW_SOLD] as'المبلغ الجديد'
      ,[REMISE] as'الخصم'
      ,[POURSENTAGE_REMISE] as'نسبة الخصم'
      ,[COUNT_ARTICLE] as'عدد المنتجات'
      ,[TB_FACTURE_VENTE].[REMARQUE] as'ملاحظة'
      ,[ETAT] as'الحالة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_FACTURE_VENTE]
  inner join TB_CLIENT on TB_CLIENT.id = TB_FACTURE_VENTE.ID_CLIENT
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.id = TB_FACTURE_VENTE.ID_CAISSIER
  inner join TB_USER on TB_USER.id = TB_FACTURE_VENTE.ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.id = TB_USER.ID_OUVERIER  
  where    
  		[NMR_FACTURE] LIKE N'%' + @ID_search + '%'
        OR [DATE] LIKE N'%' + @ID_search + '%'
        OR [HEURE] LIKE N'%' + @ID_search + '%' 
        OR TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME LIKE N'%' + @ID_search + '%' 
        OR [TOTAL_FACURE_TTC] LIKE N'%' + @ID_search + '%' 
        OR [TOTAL_FACTURE_HT] LIKE N'%' + @ID_search + '%' 
        OR [TVA] LIKE N'%' + @ID_search + '%' 
        OR [OLD_SOLD] LIKE N'%' + @ID_search + '%' 
        OR [VERSEMENT] LIKE N'%' + @ID_search + '%' 
        OR [NEW_SOLD] LIKE N'%' + @ID_search + '%' 
        OR [REMISE] LIKE N'%' + @ID_search + '%' 
        OR [POURSENTAGE_REMISE] LIKE N'%' + @ID_search + '%' 
        OR [COUNT_ARTICLE] LIKE N'%' + @ID_search + '%'  
        OR [TB_FACTURE_VENTE].[REMARQUE] LIKE N'%' + @ID_search + '%' 
        OR [ETAT] LIKE N'%' + @ID_search + '%'  
        OR TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%'  
        OR TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME LIKE N'%' + @ID_search + '%'  
        
















GO
/****** Object:  StoredProcedure [dbo].[search_fichier_facture_produit_prevent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


create proc [dbo].[search_fichier_facture_produit_prevent]
@ID_Search nvarchar(50)
as 
SELECT [TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE].[ID] 
      ,[ID_FACTURE] as'رقم الفاتورة'
	  ,TB_FACTURE_ACHAT_PRODUIT_REVENT.DATE 'تاريخ الفاتورة'
	  ,TB_FOURNISSUER.NAME+' '+TB_FOURNISSUER.PRENAME 'مورد الفاتورة'
      ,[REMARQUE] 'ملاحظة'
  FROM [dbo].[TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE]
  inner join TB_FACTURE_ACHAT_PRODUIT_REVENT on TB_FACTURE_ACHAT_PRODUIT_REVENT.ID_FOURNISSEUR = [TB_FICHIER_UPLOAAD_FACTURE_PRODUIT_REVENTE].[ID_FACTURE]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_FACTURE_ACHAT_PRODUIT_REVENT.ID_FOURNISSEUR
  
  where    
  		[ID_FACTURE] LIKE N'%' + @ID_search + '%'
        OR TB_FACTURE_ACHAT_PRODUIT_REVENT.DATE LIKE N'%' + @ID_search + '%'
        OR TB_FOURNISSUER.NAME+' '+TB_FOURNISSUER.PRENAME LIKE N'%' + @ID_search + '%' 
        OR [REMARQUE] LIKE N'%' + @ID_search + '%'  
















GO
/****** Object:  StoredProcedure [dbo].[search_fournisseur]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_fournisseur]
@fournisseur nvarchar(50)
as
SELECT [ID] as'ID'
      ,[NAME] as'الاسم'
      ,[PRENAME] as'اللقب'
	  ,[ADRESSE] as'العنوان'
      ,[PHONE] as'الهاتف'
      ,[FAX] as'الفاكس'
      ,[EMAIL] as'الإيميل'
      ,[SOLD_TOTAL] as'المبلغ الكلي'
      ,[SOLD_PAYE] as'المبلغ المدفوع'
      ,[SOLD_NON_PAYE] as'المبلغ الغير مدفوع' 
	   ,NIF as 'NIF'
	   ,RC as 'RC'
	   ,Nic as 'Nic'
	   ,article as 'Article'
  FROM [dbo].[TB_FOURNISSUER]
  where [NAME] LIKE N'%' + @fournisseur + '%'
		OR [PRENAME] LIKE N'%' + @fournisseur + '%'
		OR [ADRESSE] LIKE N'%' + @fournisseur + '%'
		OR [PHONE] LIKE N'%' + @fournisseur + '%'
		OR [FAX] LIKE N'%' + @fournisseur + '%'
		OR [EMAIL] LIKE N'%' + @fournisseur + '%'
		OR [SOLD_TOTAL] LIKE N'%' + @fournisseur + '%'
		OR [SOLD_PAYE] LIKE N'%' + @fournisseur + '%'
		OR [SOLD_NON_PAYE] LIKE N'%' + @fournisseur + '%'
		OR NIF LIKE N'%' + @fournisseur + '%'
		OR RC LIKE N'%' + @fournisseur + '%'
		OR Nic LIKE N'%' + @fournisseur + '%'
		OR article LIKE N'%' + @fournisseur + '%'
















GO
/****** Object:  StoredProcedure [dbo].[search_gestion_produit_by_code_barre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_gestion_produit_by_code_barre]
@codeBarre nvarchar(50)
AS
SELECT [CODE_BARRE] AS'رقم المنتج'
      ,[DESIGNATION] AS'اسم المنتج' 
	  ,TB_UNITE.UNITE AS'الوحدة'
      ,TB_CATEGORIES.CATEGORIES AS'الصنف'
      ,[COUT_DE_PRODUCTION] AS'تكلفة الانتاج'
      ,[QT_DANS_PACK] AS'الكمية في الحزمة'
      ,[QT_TOTAL] AS'الكمية الكلية'
      ,[QT_VENTE] AS'الكمية المباعة'
      ,[QT_REST] AS'الكمية المتبقية'
      ,[QT_DECHET] AS'الكمية المفقودة'
      ,[PRICE_VENTE_HT] AS'سعر البيع  HT'
      ,[PRICE_VENTE_TTC] AS'سعر البيع TTC'
      ,[TVA] AS'TVA'
      ,[PRICE_GROS] AS'سعر الجملة'
      ,[PRICE_MIN] AS'السعر الادنى'
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  INNER JOIN TB_CATEGORIES ON TB_CATEGORIES.ID = TB_GESTION_PRODUIT_FINAUX.CATEGORIE
  INNER JOIN TB_UNITE ON TB_UNITE.ID = TB_GESTION_PRODUIT_FINAUX.UNITE
  where CODE_BARRE = @codeBarre 
















GO
/****** Object:  StoredProcedure [dbo].[search_gestion_produit_finaux_by_name]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[search_gestion_produit_finaux_by_name]
@IDsearch nvarchar(50)
AS
SELECT [CODE_BARRE] AS'رقم المنتج'
      ,[DESIGNATION] AS'اسم المنتج' 
	  ,TB_UNITE.UNITE AS'الوحدة'
      ,TB_CATEGORIES.CATEGORIES AS'الصنف'
      ,[COUT_DE_PRODUCTION] AS'تكلفة الانتاج'
      ,[QT_DANS_PACK] AS'الكمية في الحزمة'
      ,[QT_TOTAL] AS'الكمية الكلية'
      ,[QT_VENTE] AS'الكمية المباعة'
      ,[QT_REST] AS'الكمية المتبقية'
      ,[QT_DECHET] AS'الكمية المفقودة'
      ,[PRICE_VENTE_HT] AS'سعر البيع  HT'
      ,[PRICE_VENTE_TTC] AS'سعر البيع TTC'
      ,[TVA] AS'TVA'
      ,[PRICE_GROS] AS'سعر الجملة'
      ,[PRICE_MIN] AS'السعر الادنى'
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  INNER JOIN TB_CATEGORIES ON TB_CATEGORIES.ID = TB_GESTION_PRODUIT_FINAUX.CATEGORIE
  INNER JOIN TB_UNITE ON TB_UNITE.ID = TB_GESTION_PRODUIT_FINAUX.UNITE
  where DESIGNATION like @IDsearch 
















GO
/****** Object:  StoredProcedure [dbo].[search_get_dechet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_get_dechet]
@ID_search nvarchar(50)
as
SELECT [ID] as'ID'
      ,TB_MATIER_PREMIER.DESIGNATION as'اسم المادة'
      ,[PRICE_U] as'سعر الشراء'
      ,[QT_dechet] as'كمية المخلفات'
      ,[price_ttl] as'سعر المخلفات'
      ,[etas] as'الحالة'
  FROM [dbo].[TB_DECHET]
  inner join TB_MATIER_PREMIER on TB_MATIER_PREMIER.CODEBARRE = [TB_DECHET].ID_MATIER 
  where    
  		TB_MATIER_PREMIER.DESIGNATION LIKE N'%' + @ID_search + '%'
        OR [PRICE_U] LIKE N'%' + @ID_search + '%'
        OR [QT_dechet] LIKE N'%' + @ID_search + '%' 
        OR [price_ttl] LIKE N'%' + @ID_search + '%' 
        OR [etas] LIKE N'%' + @ID_search + '%'  
        

















GO
/****** Object:  StoredProcedure [dbo].[search_get_historique_Caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_get_historique_Caissier]
@ID_caissier int  
as
SELECT [ID]
      ,[ID_CAISSIE]
      ,[DATE]
      ,[HEURE_ENTRE]
      ,[HEURE_SORTIE]
      ,[PRIX_FOND]
      ,[PRIX_CLOTURE]
  FROM [dbo].[TB_HISTORIQUE_CAISSIER]
  where [ID_CAISSIE] = @ID_caissier  

















GO
/****** Object:  StoredProcedure [dbo].[search_get_reserve_code_all]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[search_get_reserve_code_all]
@ID_Search nvarchar(50)
as
SELECT 
		[id]
		,[code_barre_produit]	as'الباركود الاساسي'
        ,[code_barre_reserve] as'الباركود الاحتياطي'
	     ,TB_Produit_revente.designation as'اسم المنتج' 
  FROM [dbo].[TB_CODE_BARRE_RESERVE]
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_CODE_BARRE_RESERVE.code_barre_produit 
where 
  		    [code_barre_produit]  =  @ID_search  
		  OR [code_barre_reserve] =   @ID_search  
		  OR TB_Produit_revente.designation =  @ID_search  







GO
/****** Object:  StoredProcedure [dbo].[search_get_reserve_code_all_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[search_get_reserve_code_all_pack]
@ID_Search nvarchar(50)
as
SELECT [ID]
      ,[CODE_BARRE_OFFICIAL] as'الباركود الاساسي'
      ,[CODE_BARRE_RESERVER] as'الباركود الاحتياطي'
	  ,TB_PACK_PRODUIT_REVENT.pack_designation as'اسم الحزمة'
  FROM [dbo].[TB_CODE_BARRE_RESERVER_PACK]
  inner join TB_PACK_PRODUIT_REVENT on TB_PACK_PRODUIT_REVENT.pack_code_barre = TB_CODE_BARRE_RESERVER_PACK.CODE_BARRE_OFFICIAL 
where 
  		    [code_barre_produit]  =  @ID_search  
		  OR [CODE_BARRE_RESERVER] =  @ID_search  
		  OR TB_PACK_PRODUIT_REVENT.pack_designation =   @ID_search  







GO
/****** Object:  StoredProcedure [dbo].[search_get_table_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[search_get_table_pack]
@IDsearch nvarchar(50)
as 
SELECT [BARCODE_PACK] as'رقم الحزمة'
      ,[DESIGNATION] as'اسم الحزمة'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتوج'
      ,[QT_DISPONIBLE] as'الكمية المتوفرة'
      ,[PRICE_GROS] as'ثمن الجملة'
      ,[PRICE_DETAILLE] as'ثمن التجزئة'
      ,[PRICE_MIN] as'الثمن الادنى'
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
  where     DESIGNATION like N'%' + @IDsearch + '%' 

















GO
/****** Object:  StoredProcedure [dbo].[search_get_table_pack_by_code_barre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_get_table_pack_by_code_barre]
@IDsearch nvarchar(50)
as 
SELECT [BARCODE_PACK] as'رقم الحزمة'
      ,[DESIGNATION] as'اسم الحزمة'
      ,[ID_PRODUIT_FINAUX] as'رقم المنتوج'
      ,[QT_DISPONIBLE] as'الكمية المتوفرة'
      ,[PRICE_GROS] as'ثمن الجملة'
      ,[PRICE_DETAILLE] as'ثمن التجزئة'
      ,[PRICE_MIN] as'الثمن الادنى'
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
  where BARCODE_PACK like @IDsearch

















GO
/****** Object:  StoredProcedure [dbo].[search_get_tb_depense]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_get_tb_depense]
@ID_search nvarchar(50)
as
SELECT TB_DEPENSE.[ID]
      ,[CAUSE_DEPENSE] as'سبب الخسارة'
      ,[VALEURE] as'قيمة الخسارة'
      ,[DATE] as'التاريخ'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_DEPENSE]
  inner join TB_USER on TB_USER.ID = [TB_DEPENSE].USER_ID
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER 
  where    
  		[CAUSE_DEPENSE] LIKE N'%' + @ID_search + '%'
        OR [VALEURE] LIKE N'%' + @ID_search + '%'
        OR [DATE] LIKE N'%' + @ID_search + '%' 
        OR [PHONE] LIKE N'%' + @ID_search + '%' 
        OR TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%'  
        

















GO
/****** Object:  StoredProcedure [dbo].[SEARCH_HISTORIQUE_BY_CLIENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[SEARCH_HISTORIQUE_BY_CLIENT]
@ID_CLIENT INT
AS  
SELECT [TB_HISTORIQUE_CLIENT].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'الزبون'
      ,[PRICE] as'المبلغ المدفوع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'الملاحظة'
  FROM [dbo].[TB_HISTORIQUE_CLIENT]
  inner join TB_CLIENT on TB_CLIENT.id = TB_HISTORIQUE_CLIENT.[ID_CLIENT]
  WHERE [ID_CLIENT]=@ID_CLIENT

















GO
/****** Object:  StoredProcedure [dbo].[search_historique_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_historique_client]
@ID_search nvarchar(50)
AS
SELECT [TB_HISTORIQUE_CLIENT].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'الزبون'
      ,[PRICE] as'المبلغ المدفوع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'الملاحظة'
  FROM [dbo].[TB_HISTORIQUE_CLIENT]
  inner join TB_CLIENT on TB_CLIENT.id = TB_HISTORIQUE_CLIENT.[ID_CLIENT]
  where    
  		[DATE] LIKE N'%' + @ID_search + '%'
        OR TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME LIKE N'%' + @ID_search + '%'
        OR [PRICE] LIKE N'%' + @ID_search + '%' 
        OR [CREDIT_OLD] LIKE N'%' + @ID_search + '%' 
        OR [CREDIT_NEW] LIKE N'%' + @ID_search + '%' 
        OR [REMARQUE] LIKE N'%' + @ID_search + '%'  
        

















GO
/****** Object:  StoredProcedure [dbo].[SEARCH_HISTORIQUE_CLIENT_BY_DATE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[SEARCH_HISTORIQUE_CLIENT_BY_DATE]
@DATE DATE
AS 
SELECT [TB_HISTORIQUE_CLIENT].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'الزبون'
      ,[PRICE] as'المبلغ المدفوع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'الملاحظة'
  FROM [dbo].[TB_HISTORIQUE_CLIENT]
  inner join TB_CLIENT on TB_CLIENT.id = TB_HISTORIQUE_CLIENT.[ID_CLIENT]
  WHERE [DATE]=@DATE
















GO
/****** Object:  StoredProcedure [dbo].[SEARCH_HISTORY_BY_FOURNISSEUR]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[SEARCH_HISTORY_BY_FOURNISSEUR]
@ID_FOURNISSEUR INT
AS
SELECT [TB_HISTORIQUE_FOURNISSEUR].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME + ' ' +TB_FOURNISSUER.PRENAME  as'اسم ولقب المورد'
      ,[PRICE] as'الدفع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'ملاحظة'
  FROM [dbo].[TB_HISTORIQUE_FOURNISSEUR]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_HISTORIQUE_FOURNISSEUR.ID_CLIENT
  WHERE ID_CLIENT  = @ID_FOURNISSEUR
















GO
/****** Object:  StoredProcedure [dbo].[SEARCH_HISTORY_PAR_DATE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[SEARCH_HISTORY_PAR_DATE]
@DATE DATE 
AS
SELECT [TB_HISTORIQUE_FOURNISSEUR].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME + ' ' +TB_FOURNISSUER.PRENAME  as'اسم ولقب المورد'
      ,[PRICE] as'الدفع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'ملاحظة'
  FROM [dbo].[TB_HISTORIQUE_FOURNISSEUR]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = TB_HISTORIQUE_FOURNISSEUR.ID_CLIENT
  WHERE [DATE]  = @DATE
















GO
/****** Object:  StoredProcedure [dbo].[SEARCH_matier_premier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[SEARCH_matier_premier]
@ID_search nvarchar(50)
as
SELECT [CODEBARRE]
      ,[DESIGNATION]
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,[QUANTITE]
      ,[QUANTITE_REST]
      ,[QUANTITE_USE]
      ,[QUANTITE_PACKES]
      ,[PHOTO]
      ,[DATE_PREPARATION]
      ,[OBSERVATION]
      ,[STOCKES_MIN]
      ,[PRODUIT_DES_PIECES]
      ,[REFERENCE]
  FROM [dbo].[TB_MATIER_PREMIER]
  inner join TB_UNITE on TB_UNITE.ID =[TB_MATIER_PREMIER].UNITE
  inner join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_MATIER_PREMIER].CATEGORIES
  inner join TB_STOCK on TB_STOCK.ID =[TB_MATIER_PREMIER].STOCKES
  inner join TB_MARQUE on TB_MARQUE.ID =[TB_MATIER_PREMIER].MARKE  
  where    
  		TB_UNITE.UNITE = @ID_search  
  		OR TB_CATEGORIES.CATEGORIES = @ID_search  
  		OR TB_STOCK.STOCKE = @ID_search  
  		OR TB_MARQUE.Marque = @ID_search  
  		OR [REFERENCE] = @ID_search  
  		OR [DESIGNATION] LIKE N'%' + @ID_search + '%' 
        OR [CODEBARRE] = @ID_search  
        


















GO
/****** Object:  StoredProcedure [dbo].[search_on_history_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_on_history_client]
@ID_search nvarchar(50)
as
SELECT 
        [TB_HISTORIQUE_CLIENT].[ID] AS 'ID',
        [DATE] AS 'التاريخ',
        TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
        [PRICE] AS 'المبلغ المدفوع',
        [CREDIT_OLD] AS 'المبلغ القديم',
        [CREDIT_NEW] AS 'المبلغ الجديد',
        [REMARQUE] AS 'الملاحظة'
    FROM 
        [dbo].[TB_HISTORIQUE_CLIENT]
    INNER JOIN 
        TB_CLIENT ON TB_CLIENT.id = TB_HISTORIQUE_CLIENT.[ID_CLIENT]
	where
		TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME LIKE N'%' + @ID_search + '%'
        OR [PRICE] LIKE N'%' + @ID_search + '%'
        OR [CREDIT_OLD] LIKE N'%' + @ID_search + '%' 
        OR [CREDIT_NEW] LIKE N'%' + @ID_search + '%' 
















GO
/****** Object:  StoredProcedure [dbo].[search_on_history_frnsr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_on_history_frnsr]
@ID_search nvarchar(50)
as
	SELECT [TB_HISTORIQUE_FOURNISSEUR].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME + ' ' +TB_FOURNISSUER.PRENAME  as'اسم ولقب المورد'
      ,[PRICE] as'الدفع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'ملاحظة'
  FROM [dbo].[TB_HISTORIQUE_FOURNISSEUR]
  INNER JOIN 
        TB_FOURNISSUER ON TB_FOURNISSUER.id = [TB_HISTORIQUE_FOURNISSEUR].[ID_CLIENT]
	where
		TB_FOURNISSUER.NAME + ' ' +TB_FOURNISSUER.PRENAME  LIKE N'%' + @ID_search + '%'
        OR [PRICE] LIKE N'%' + @ID_search + '%'
        OR [CREDIT_OLD] LIKE N'%' + @ID_search + '%' 
        OR [CREDIT_NEW] LIKE N'%' + @ID_search + '%' 
















GO
/****** Object:  StoredProcedure [dbo].[search_ouverier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_ouverier]
@ID_search nvarchar(50)
as
SELECT [ID] as'ID'
      ,[NAME] as'اللقب'
      ,[PRENAME] as'الاسم'
      ,[FONCTION] as'المهنة'
      ,[PHONE] as'الهاتف'
  FROM [dbo].[TB_OUVERIER] 
  where 
  		[NAME] LIKE N'%' + @ID_search + '%'
        OR [PRENAME] LIKE N'%' + @ID_search + '%'
        OR [FONCTION] LIKE N'%' + @ID_search + '%' 
        OR [PHONE] LIKE N'%' + @ID_search + '%'  
















GO
/****** Object:  StoredProcedure [dbo].[search_pack_prevent_by_code_Barre_Pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

  
--//////////////////
CREATE procedure [dbo].[search_pack_prevent_by_code_Barre_Pack]
@CodeBarre nvarchar(50)
as
SELECT [pack_code_barre] as'رقم الحزمة'
      ,[pack_designation] as'اسم الحزمة'
      ,[code_barre_produit] as'رقم المنتج'
      ,TB_Produit_revente.Quantite_rest/TB_Produit_revente.QT_DANS_PACK as'الكمية المتبقية'
      ,[quantite] as'الكمية'
      ,[price_unitair] as'سعر الحزمة' 
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_PACK_PRODUIT_REVENT].id_favoire
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre =[TB_PACK_PRODUIT_REVENT].code_barre_produit
  where [pack_code_barre] = @CodeBarre











GO
/****** Object:  StoredProcedure [dbo].[search_pack_prevent_by_code_Barre_U]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

 
--//////////////////
CREATE proc [dbo].[search_pack_prevent_by_code_Barre_U]
@CodeBarre nvarchar(50)
as
SELECT [pack_code_barre] as'رقم الحزمة'
      ,[pack_designation] as'اسم الحزمة'
      ,[code_barre_produit] as'رقم المنتج'
      ,TB_Produit_revente.Quantite_rest/TB_Produit_revente.QT_DANS_PACK as'الكمية المتبقية'
      ,[quantite] as'الكمية'
      ,[price_unitair] as'سعر الحزمة' 
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_PACK_PRODUIT_REVENT].id_favoire
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre =[TB_PACK_PRODUIT_REVENT].code_barre_produit
  where code_barre_produit = @CodeBarre











GO
/****** Object:  StoredProcedure [dbo].[search_pack_produit_revent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE procedure [dbo].[search_pack_produit_revent]
@ID_search nvarchar(50)
as
SELECT [pack_code_barre] as'رقم الحزمة'
      ,[pack_designation] as'اسم الحزمة'
      ,[code_barre_produit] as'رقم المنتج'
      ,TB_Produit_revente.Quantite_rest/TB_Produit_revente.QT_DANS_PACK as'الكمية المتبقية'
      ,[quantite] as'الكمية'
      ,[price_unitair] as'سعر الحزمة' 
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_PACK_PRODUIT_REVENT].id_favoire
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre =[TB_PACK_PRODUIT_REVENT].code_barre_produit
   where    
  		[pack_code_barre]  LIKE N'%' + @ID_search + '%'  
  		OR [pack_designation]  LIKE N'%' + @ID_search + '%'  
  		OR [code_barre_produit]  LIKE N'%' + @ID_search + '%'  
  		OR TB_Produit_revente.Quantite_rest/TB_Produit_revente.QT_DANS_PACK  LIKE N'%' + @ID_search + '%'  
  		OR [quantite]  LIKE N'%' + @ID_search + '%'  
  		OR [price_unitair] LIKE N'%' + @ID_search + '%'  
  		OR TB_FAVORIS.FAVOIRE LIKE N'%' + @ID_search + '%'  



GO
/****** Object:  StoredProcedure [dbo].[search_principale_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc  [dbo].[search_principale_facture]
@ID_Search nvarchar(50)
as
SELECT [TB_PRINCIPE_fACTURE].[NMR_FACTURE] as'رقم الفاتورة'
      ,TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME as'الزبون'
      ,[TB_PRINCIPE_fACTURE].[DATE] as'التاريخ'
      ,ROUND([TOTAL_HT],2) as'المبلغ الكلي HT'
      ,ROUND([TVA],2) as'TVA %'
      ,ROUND([TMBRE],2) as' % الطابع'
      ,ROUND([TOTAL_TTC],2) as'المبلغ الكلي TTC'
      ,ROUND([VERSE],2) as'المدفوع'
      ,ROUND([REST],2) as'المتبقي'
      ,TB_OUVERIER.NAME+ ' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_PRINCIPE_fACTURE]
  inner join TB_CLIENT on TB_CLIENT.id = [TB_PRINCIPE_fACTURE].[ID_CLIENT]
  inner join TB_USER on TB_USER.id = [TB_PRINCIPE_fACTURE].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where 
  		  [TB_PRINCIPE_fACTURE].[NMR_FACTURE]  LIKE N'%' + @ID_search + '%' 
		  OR TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME  LIKE N'%' + @ID_search + '%' 
		  OR [TB_PRINCIPE_fACTURE].[DATE]  LIKE N'%' + @ID_search + '%' 
		  OR TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME  LIKE N'%' + @ID_search + '%' 
		  OR [TOTAL_HT]  LIKE N'%' + @ID_search + '%' 
		  OR [TMBRE]  LIKE N'%' + @ID_search + '%' 
		  OR [TOTAL_TTC]  LIKE N'%' + @ID_search + '%' 
		  OR [VERSE]  LIKE N'%' + @ID_search + '%' 
		  OR [REST]  LIKE N'%' + @ID_search + '%' 
		  OR TB_OUVERIER.NAME+ ' '+TB_OUVERIER.PRENAME  LIKE N'%' + @ID_search + '%'  
















GO
/****** Object:  StoredProcedure [dbo].[search_principale_facture_by_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc  [dbo].[search_principale_facture_by_client]
@ID_Search int
as
SELECT [TB_PRINCIPE_fACTURE].[NMR_FACTURE] as'رقم الفاتورة'
      ,TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME as'الزبون'
      ,[TB_PRINCIPE_fACTURE].[DATE] as'التاريخ'
      ,ROUND([TOTAL_HT],2) as'المبلغ الكلي HT'
      ,ROUND([TVA],2) as'TVA %'
      ,ROUND([TMBRE],2) as' % الطابع'
      ,ROUND([TOTAL_TTC],2) as'المبلغ الكلي TTC'
      ,ROUND([VERSE],2) as'المدفوع'
      ,ROUND([REST],2) as'المتبقي'
      ,TB_OUVERIER.NAME+ ' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_PRINCIPE_fACTURE]
  inner join TB_CLIENT on TB_CLIENT.id = [TB_PRINCIPE_fACTURE].[ID_CLIENT]
  inner join TB_USER on TB_USER.id = [TB_PRINCIPE_fACTURE].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where 
  		  [TB_PRINCIPE_fACTURE].ID_CLIENT =  @ID_search   
















GO
/****** Object:  StoredProcedure [dbo].[search_principale_facture_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc  [dbo].[search_principale_facture_by_date]
@ID_Search date
as
SELECT [TB_PRINCIPE_fACTURE].[NMR_FACTURE] as'رقم الفاتورة'
      ,TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME as'الزبون'
      ,[TB_PRINCIPE_fACTURE].[DATE] as'التاريخ'
      ,ROUND([TOTAL_HT],2) as'المبلغ الكلي HT'
      ,ROUND([TVA],2) as'TVA %'
      ,ROUND([TMBRE],2) as' % الطابع'
      ,ROUND([TOTAL_TTC],2) as'المبلغ الكلي TTC'
      ,ROUND([VERSE],2) as'المدفوع'
      ,ROUND([REST],2) as'المتبقي'
      ,TB_OUVERIER.NAME+ ' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_PRINCIPE_fACTURE]
  inner join TB_CLIENT on TB_CLIENT.id = [TB_PRINCIPE_fACTURE].[ID_CLIENT]
  inner join TB_USER on TB_USER.id = [TB_PRINCIPE_fACTURE].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where 
  		  [TB_PRINCIPE_fACTURE].DATE =  @ID_search   
















GO
/****** Object:  StoredProcedure [dbo].[search_PRINCIPE_INVENTAIRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create PROC [dbo].[search_PRINCIPE_INVENTAIRE]
@ID_search nvarchar(50)
AS
SELECT [NMR_INVENTAIR] as'رقم الجرد'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,[TOTAL_THEORIQUE] as'الكمية الافتراضية الكلية'
      ,[TOTAL_PHYSIQUE] as'الكمية الحقيقية الكلية'
      ,[MONTANT_ECART] as'الفرق'
      ,[OBSERVATION] as'ملاحظة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_PRINCIPALE_INVENTAIRE]
	inner join TB_USER on TB_USER.ID = TB_PRINCIPALE_INVENTAIRE.ID_USER
	inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
where    
  		[NMR_INVENTAIR] LIKE N'%' + @ID_search + '%'
        OR [DATE] LIKE N'%' + @ID_search + '%'
        OR [HEURE] LIKE N'%' + @ID_search + '%'
        OR [TOTAL_THEORIQUE] LIKE N'%' + @ID_search + '%'
        OR [TOTAL_PHYSIQUE] LIKE N'%' + @ID_search + '%'
        OR [MONTANT_ECART] LIKE N'%' + @ID_search + '%'
        OR [OBSERVATION] LIKE N'%' + @ID_search + '%'
        OR TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%'

GO
/****** Object:  StoredProcedure [dbo].[search_PRINCIPE_INVENTAIRE_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create PROC [dbo].[search_PRINCIPE_INVENTAIRE_by_date]
@ID_search date
AS
SELECT [NMR_INVENTAIR] as'رقم الجرد'
      ,[DATE] as'التاريخ'
      ,[HEURE] as'الوقت'
      ,[TOTAL_THEORIQUE] as'الكمية الافتراضية الكلية'
      ,[TOTAL_PHYSIQUE] as'الكمية الحقيقية الكلية'
      ,[MONTANT_ECART] as'الفرق'
      ,[OBSERVATION] as'ملاحظة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_PRINCIPALE_INVENTAIRE]
	inner join TB_USER on TB_USER.ID = TB_PRINCIPALE_INVENTAIRE.ID_USER
	inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
where    
  		 [DATE] = @ID_search  

GO
/****** Object:  StoredProcedure [dbo].[search_produit_revente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[search_produit_revente]
@ID_search nvarchar(50)
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
    where    
  		TB_UNITE.UNITE  LIKE N'%' + @ID_search + '%'  
  		OR TB_CATEGORIES.CATEGORIES  LIKE N'%' + @ID_search + '%'  
  		OR TB_STOCK.STOCKE  LIKE N'%' + @ID_search + '%'  
  		OR TB_MARQUE.Marque  LIKE N'%' + @ID_search + '%'  
  		OR [REFERENCE]  LIKE N'%' + @ID_search + '%'  
  		OR [DESIGNATION] LIKE N'%' + @ID_search + '%'  
  		OR [CodeBarre] LIKE N'%' + @ID_search + '%'  















GO
/****** Object:  StoredProcedure [dbo].[search_produit_revente_on_fctr]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

create proc [dbo].[search_produit_revente_on_fctr]
@ID_search nvarchar(50)
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج' 
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj  - [Quantite_rest] as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
    where    
  		TB_UNITE.UNITE  LIKE N'%' + @ID_search + '%'  
  		OR TB_CATEGORIES.CATEGORIES  LIKE N'%' + @ID_search + '%'  
  		OR TB_STOCK.STOCKE  LIKE N'%' + @ID_search + '%'  
  		OR TB_MARQUE.Marque  LIKE N'%' + @ID_search + '%'  
  		OR [REFERENCE]  LIKE N'%' + @ID_search + '%'  
  		OR [DESIGNATION] LIKE N'%' + @ID_search + '%'  
  		OR [CodeBarre] LIKE N'%' + @ID_search + '%'  



GO
/****** Object:  StoredProcedure [dbo].[search_produit_revente_repture_stock]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
create proc [dbo].[search_produit_revente_repture_stock]
@ID_search float
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj  - [Quantite_rest] as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille 
    where    Quantite_rest <=  @ID_search















GO
/****** Object:  StoredProcedure [dbo].[search_recycle_dechet]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[search_recycle_dechet]
@ID_search nvarchar(50)
as
SELECT [ID] as'ID'
      ,TB_MATIER_PREMIER.DESIGNATION as'اسم المادة'
      ,[QT_Dechet] as'كمية المخلفات'
	  ,price_u as'سعر الشراء'
	  ,price_ttl as'سعر المخلفات'
      ,[etas] as'الحالة' 
  FROM [dbo].[TB_DECHET_REClage]
  inner join TB_MATIER_PREMIER on TB_MATIER_PREMIER.CODEBARRE = TB_DECHET_REClage.ID_MATIER 
  where    
  		 
  		TB_MATIER_PREMIER.DESIGNATION  LIKE N'%' + @ID_search + '%'   
  		OR [QT_Dechet]  LIKE N'%' + @ID_search + '%'   
  		OR price_u  LIKE N'%' + @ID_search + '%'  
  		OR price_ttl  LIKE N'%' + @ID_search + '%'  
  		OR [etas]  LIKE N'%' + @ID_search + '%'  
        


















GO
/****** Object:  StoredProcedure [dbo].[SEARCH_REPT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[SEARCH_REPT]
@ID_search NVARCHAR(50)
AS
BEGIN
    SET NOCOUNT ON;

    SELECT [NMR_OPERATION] as'رقم العملية'
          ,[DATE_ENTRE] as'تاريخ البداية'
          ,[TIME] as'الوقت'
          ,[CLIENT] as'اسم الزبون'
          ,[NMR_TEL_] as'رقم الهاتف'
          ,[PROBLEM] as'المشكل'
          ,[PRIX] as'السعر'
          ,[DATE_SORTIE] as'تاريخ الخروج'
          ,[ETAS] as'الحالة'
    FROM [dbo].[TB_repatation]
  where  
  		[NMR_OPERATION] LIKE N'%' + @ID_search + '%'
        OR [CLIENT] LIKE N'%' + @ID_search + '%'
END;

GO
/****** Object:  StoredProcedure [dbo].[search_select_versement_ouverier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_select_versement_ouverier]
@ID_search nvarchar(50)
as
SELECT [TB_VERSEMNT_OUVERIER].[ID] as'ID'
      ,[TB_VERSEMNT_OUVERIER].[DATE] as'التاريخ'
      ,TB_OUVERIER.NAME + ' '+TB_OUVERIER.PRENAME as'العامل'
      ,[PRICE_PAYER] as'المبلغ'
      ,[REMARQUE] as'ملاحظة'
  FROM [TB_VERSEMNT_OUVERIER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = [TB_VERSEMNT_OUVERIER].[ID_OUVERIER] 
  where    
  		[TB_VERSEMNT_OUVERIER].[DATE] LIKE N'%' + @ID_search + '%'
        OR TB_OUVERIER.NAME + ' '+TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%'
        OR [PRICE_PAYER] LIKE N'%' + @ID_search + '%' 
        OR [PHONE] LIKE N'%' + @ID_search + '%' 
        OR [REMARQUE] LIKE N'%' + @ID_search + '%'  
        
















GO
/****** Object:  StoredProcedure [dbo].[Search_stock_Alert]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[Search_stock_Alert]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj  as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille
  where [Quantite_rest]<=Quantite_alert


GO
/****** Object:  StoredProcedure [dbo].[Search_stock_Controle_prix_Détail]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[Search_stock_Controle_prix_Détail]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj   as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille
  where [price_vente1] < [price_achat_TTC]  


GO
/****** Object:  StoredProcedure [dbo].[Search_stock_Controle_prix_Gros]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[Search_stock_Controle_prix_Gros]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj   as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille
  where [price_vente2] < [price_achat_TTC]  


GO
/****** Object:  StoredProcedure [dbo].[Search_stock_Controle_prix_min]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[Search_stock_Controle_prix_min]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj  as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille
  where [price_min] < [price_achat_TTC]  


GO
/****** Object:  StoredProcedure [dbo].[Search_stock_exagere]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[Search_stock_exagere]
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj   as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille
  where [Quantite_rest]> ihtiyaj


GO
/****** Object:  StoredProcedure [dbo].[Search_stock_negative]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[Search_stock_negative] 
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille
  where [Quantite_rest]<0


GO
/****** Object:  StoredProcedure [dbo].[Search_stock_Null]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[Search_stock_Null] 
as
SELECT [CodeBarre] as'رمز المنتج'
      ,[designation] as'اسم المنتج'
      ,[reference] as'رقم المرجع'
      ,TB_CATEGORIES.CATEGORIES as'الصنف'
      ,TB_STOCK.STOCKE as'المخزن'
      ,TB_MARQUE.Marque as'العلامة'
      ,TB_UNITE.UNITE as'الوحدة'
      ,TB_TAILLE.TAILLE as'القياس'
      ,TB_COLOR.COLOR as'اللون'
      ,TB_FAVORIS.FAVOIRE as'المفضلة'
      ,[date_expiration] as'تاريخ انتهاء الصلاحية'
      ,[price_achat_HT] as'سعر الشراء HT'
      ,[price_achat_TTC] as'سعر الشراء TTC'
      ,[TVA] as'TVA'
      ,[Quantite_TOTAL] as'الكمية الكلية' 
      ,[price_vente1] as'سعر البيع الأول'
      ,[price_vente2] as'سعر البيع الثاني'
      ,[price_min] as'سعر البيع الأدنى'
      ,[vente_apres_expiration] as'البيع بعد انتهاء الصلاحية'
      ,[stocke_negatif] as'البيع بعد -'
      ,[Quantite_vente] as'الكمبة المباعة'
      ,[Quantite_rest] as'الكمية المتبقية'
      ,[Quantite_dechet] as'الكمية المرمية' 
      ,[QT_DANS_PACK] as'الكمية في الحزمة'
	  ,Quantite_alert as 'كمية التنبيه'
	  ,ihtiyaj   as 'كمية الاحتياج' 
  FROM [dbo].[TB_Produit_revente]
  left join TB_UNITE on TB_UNITE.ID =[TB_Produit_revente].id_unite
  left join TB_CATEGORIES on TB_CATEGORIES.ID =[TB_Produit_revente].id_categories
  left join TB_STOCK on TB_STOCK.ID =[TB_Produit_revente].id_stocke
  left join TB_MARQUE on TB_MARQUE.ID =[TB_Produit_revente].id_marque
  left join TB_COLOR on TB_COLOR.ID =[TB_Produit_revente].id_color
  left join TB_FAVORIS on TB_FAVORIS.ID =[TB_Produit_revente].id_favoire
  left join TB_TAILLE on TB_TAILLE.ID =[TB_Produit_revente].id_taille
  where [Quantite_rest]=0


GO
/****** Object:  StoredProcedure [dbo].[search_TB_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_TB_commande]
@ID_Search nvarchar(50)
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  where 
  		  [TB_COMMANDE].[ID]  LIKE N'%' + @ID_search + '%' 
		  OR [TB_COMMANDE].[ID]  LIKE N'%' + @ID_search + '%' 
		  OR [NOM_COMMANDE]  LIKE N'%' + @ID_search + '%' 
		  OR TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME  LIKE N'%' + @ID_search + '%' 
		  OR [TYPE_COMMANDE]  LIKE N'%' + @ID_search + '%' 
		  OR [COUT_TOTAL]  LIKE N'%' + @ID_search + '%' 
		  OR [VERSEMENT]  LIKE N'%' + @ID_search + '%' 
		  OR [QTE]  LIKE N'%' + @ID_search + '%' 
		  OR [PRICE_TOTAL_HT]  LIKE N'%' + @ID_search + '%' 
		  OR [PRICE_TOTAL_TTC]  LIKE N'%' + @ID_search + '%' 
		  OR [TVA]  LIKE N'%' + @ID_search + '%' 
		  OR [deadline_Date]  LIKE N'%' + @ID_search + '%' 
		  OR [etas]  LIKE N'%' + @ID_search + '%'  
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_commande_between_Date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_TB_commande_between_Date]
@startDate Date
,@endDate Date
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  where 
  		  [TB_COMMANDE].DATE  between @startDate and @endDate  
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_commande_by_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_TB_commande_by_client]
@ID_Client int 
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  where 
  		  [TB_COMMANDE].ID_CLIENT  = @ID_Client
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_commande_bY_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_TB_commande_bY_date]
@ID_Search Date
as
SELECT [TB_COMMANDE].[ID] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[NOM_COMMANDE] as'اسم الطلبية'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[TYPE_COMMANDE] as'نوع الطلبية'
      ,[COUT_TOTAL] as'التكلفة الاجمالية'
      ,[VERSEMENT] as'المبلغ المدفوع'
      ,[QTE] as'الكمية'
      ,[PRICE_TOTAL_HT] as'السعر الكلي HT'
      ,[PRICE_TOTAL_TTC] as'السعر الكلي TTC'
      ,[TVA] as'TVA'
      ,[deadline_Date] as'التاريخ الأقصى'
      ,[etas] as'الحالة'
	  ,REMARQUE as'النوع'
  FROM [dbo].[TB_COMMANDE]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_COMMANDE.ID_CLIENT
  where 
  		  [TB_COMMANDE].DATE  = @ID_search   
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_HISTORIQUE_DEMONTER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc  [dbo].[search_TB_HISTORIQUE_DEMONTER]
@ID_search nvarchar(50)
as 
SELECT TB_HISTORIQUE_DEMONTER.[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,QT_PRODUCTION as'الكمية المصنوعة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].TB_HISTORIQUE_DEMONTER
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = TB_HISTORIQUE_DEMONTER.[ID_PRODUCTION]
  inner join TB_USER on TB_USER.ID = TB_HISTORIQUE_DEMONTER.[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where TB_GESTION_PRODUIT_FINAUX.DESIGNATION like @ID_search
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_HISTORIQUE_DEMONTER_by_code_baree]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc  [dbo].[search_TB_HISTORIQUE_DEMONTER_by_code_baree]
@ID_search nvarchar(50)
as 
SELECT TB_HISTORIQUE_DEMONTER.[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,QT_PRODUCTION as'الكمية المصنوعة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].TB_HISTORIQUE_DEMONTER
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = TB_HISTORIQUE_DEMONTER.[ID_PRODUCTION]
  inner join TB_USER on TB_USER.ID = TB_HISTORIQUE_DEMONTER.[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where TB_GESTION_PRODUIT_FINAUX.CODE_BARRE like @ID_search
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_HISTORIQUE_DEMONTER_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc  [dbo].[search_TB_HISTORIQUE_DEMONTER_by_date]
@ID_search date
as 
SELECT TB_HISTORIQUE_DEMONTER.[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,QT_PRODUCTION as'الكمية المصنوعة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].TB_HISTORIQUE_DEMONTER
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = TB_HISTORIQUE_DEMONTER.[ID_PRODUCTION]
  inner join TB_USER on TB_USER.ID = TB_HISTORIQUE_DEMONTER.[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where DATE like @ID_search
















GO
/****** Object:  StoredProcedure [dbo].[search_tb_history_production]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_tb_history_production]
@IDsearch nvarchar(50)
as 
SELECT [TB_HISTORIQUE_PRODUCTION].[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,[QT_PROUDCTION] as'الكمية المصنوعة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_HISTORIQUE_PRODUCTION]
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = [TB_HISTORIQUE_PRODUCTION].[ID_PRODUIT]
  inner join TB_USER on TB_USER.ID = [TB_HISTORIQUE_PRODUCTION].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER 
  where TB_GESTION_PRODUIT_FINAUX.DESIGNATION like @IDsearch 

















GO
/****** Object:  StoredProcedure [dbo].[search_tb_history_production_by_code_barre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_tb_history_production_by_code_barre]
@IDsearch nvarchar(50)
as 
SELECT [TB_HISTORIQUE_PRODUCTION].[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,[QT_PROUDCTION] as'الكمية المصنوعة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_HISTORIQUE_PRODUCTION]
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = [TB_HISTORIQUE_PRODUCTION].[ID_PRODUIT]
  inner join TB_USER on TB_USER.ID = [TB_HISTORIQUE_PRODUCTION].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER 
  where TB_GESTION_PRODUIT_FINAUX.CODE_BARRE like @IDsearch 

















GO
/****** Object:  StoredProcedure [dbo].[search_tb_history_production_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_tb_history_production_by_date]
@IDsearch date
as 
SELECT [TB_HISTORIQUE_PRODUCTION].[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,[QT_PROUDCTION] as'الكمية المصنوعة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_HISTORIQUE_PRODUCTION]
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = [TB_HISTORIQUE_PRODUCTION].[ID_PRODUIT]
  inner join TB_USER on TB_USER.ID = [TB_HISTORIQUE_PRODUCTION].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER 
  where [DATE] like @IDsearch 

















GO
/****** Object:  StoredProcedure [dbo].[search_tb_liv]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_tb_liv]
@Search nvarchar(50)
as
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE]		as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV	as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU	as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV	as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV	as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE		as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  
  where    
  		   TB_INFO_DE_LIV.[DATE]		LIKE N'%' + @Search + '%'
        OR TB_INFO_DE_LIV.NOM_DE_LIV	LIKE N'%' + @Search + '%'
        OR TB_INFO_DE_LIV.NOM_DE_RECU	LIKE N'%' + @Search + '%' 
        OR TB_INFO_DE_LIV.TYPE_DE_LIV	LIKE N'%' + @Search + '%' 
        OR TB_INFO_DE_LIV.PRIC_DE_LIV	LIKE N'%' + @Search + '%' 
        OR TB_Commande.NOM_COMMANDE		LIKE N'%' + @Search + '%' 
        OR TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME  LIKE N'%' + @Search + '%' 
        
















GO
/****** Object:  StoredProcedure [dbo].[search_tb_liv_between_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_tb_liv_between_date]
@startDate datetime,
@endDate datetime
as
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE]		as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV	as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU	as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV	as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV	as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE		as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  
  where TB_INFO_DE_LIV.[DATE]  between @startDate and @endDate
        
















GO
/****** Object:  StoredProcedure [dbo].[search_tb_liv_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_tb_liv_by_date]
@Date datetime
as
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE]		as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV	as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU	as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV	as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV	as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE		as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  
  where TB_INFO_DE_LIV.[DATE] = @Date
        
















GO
/****** Object:  StoredProcedure [dbo].[search_tb_liv_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_tb_liv_client]
@IDCLiet int
as
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE]		as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV	as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU	as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV	as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV	as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE		as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  
  where      TB_Commande.ID_CLIENT  = @IDCLiet
        
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_livraison]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[search_TB_livraison]
@ID_search nvarchar(50)
AS
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE] as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  where 
  		NOM_DE_LIV LIKE N'%' + @ID_search + '%'
        OR NOM_DE_RECU LIKE N'%' + @ID_search + '%'
        OR TYPE_DE_LIV LIKE N'%' + @ID_search + '%' 
        OR PRIC_DE_LIV LIKE N'%' + @ID_search + '%' 
        OR NOM_COMMANDE LIKE N'%' + @ID_search + '%' 
        OR TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME LIKE N'%' + @ID_search + '%' 
        
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_livraison_between_Date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[search_TB_livraison_between_Date]
 @StartDate DATE,
 @EndDate DATE
AS
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE] as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  where TB_INFO_DE_LIV.[DATE] BETWEEN @StartDate AND @EndDate;
        
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_livraison_by_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[search_TB_livraison_by_client]
@ID_Client int
AS
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE] as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  where TB_COMMANDE.ID_CLIENT = @ID_Client
        
















GO
/****** Object:  StoredProcedure [dbo].[search_TB_livraison_by_Date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create PROC [dbo].[search_TB_livraison_by_Date]
@Date Date
AS
SELECT TB_INFO_DE_LIV.[ID]
	  ,TB_INFO_DE_LIV.[DATE] as'التاريخ'
      ,TB_INFO_DE_LIV.NOM_DE_LIV as 'اسم المسلّم' 
	  ,TB_INFO_DE_LIV.NOM_DE_RECU as 'اسم المستلم'
	  ,TB_INFO_DE_LIV.TYPE_DE_LIV as 'نوع التسليم' 
	  ,TB_INFO_DE_LIV.PRIC_DE_LIV as 'ثمن التوصيل'
      ,TB_Commande.NOM_COMMANDE as 'اسم الطلبية'
	  ,TB_CLIENT.NAME +' ' + TB_CLIENT.PRENAME as 'اسم ولقب الزبون'  
  FROM [dbo].TB_INFO_DE_LIV 
  INNER JOIN TB_Commande ON TB_Commande.ID = TB_INFO_DE_LIV.id_commande  	  
  INNER JOIN TB_CLIENT ON TB_CLIENT.ID = TB_Commande.ID_CLIENT 
  where TB_INFO_DE_LIV.[DATE] = @Date
        
















GO
/****** Object:  StoredProcedure [dbo].[search_Tb_livraison_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_Tb_livraison_vente]
@ID_search nvarchar(50)
as
SELECT [TB_LIVRAISON_VENTE].[ID] 
      ,[id_Facture] as'رقم الطلبية'
      ,[DATE] as'التاريخ'
      ,[SENDER] as'المرسل'
      ,[RECUPIRATEUR] as'المستلم'
      ,[TYPE_LIV] as'نوع النقل'
      ,[PRICE_LIV] as'سعر النقل'
      ,[INFORMATION_CHAUFEURE] as'معلومات السائق'
      ,[MATRICULE] as'رقم لوحة السيارة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_LIVRAISON_VENTE]
  inner join tb_user on TB_USER.ID = TB_LIVRAISON_VENTE.ID_USER
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_LIVRAISON_VENTE.ID_CAISSIER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER  
  where    
  		[id_Facture] LIKE N'%' + @ID_search + '%'
        OR [DATE] LIKE N'%' + @ID_search + '%'
        OR [SENDER] LIKE N'%' + @ID_search + '%' 
        OR [RECUPIRATEUR] LIKE N'%' + @ID_search + '%' 
        OR [TYPE_LIV] LIKE N'%' + @ID_search + '%' 
        OR [PRICE_LIV] LIKE N'%' + @ID_search + '%' 
        OR [INFORMATION_CHAUFEURE] LIKE N'%' + @ID_search + '%' 
        OR [MATRICULE] LIKE N'%' + @ID_search + '%' 
        OR TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME  LIKE N'%' + @ID_search + '%' 
        OR TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME LIKE N'%' + @ID_search + '%'  
        


















GO
/****** Object:  StoredProcedure [dbo].[search_Tb_livraison_vente_by_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_Tb_livraison_vente_by_client]
@ID_search int
as
SELECT [TB_LIVRAISON_VENTE].[ID] 
      ,[id_Facture] as'رقم الطلبية'
      ,[TB_LIVRAISON_VENTE].[DATE] as'التاريخ'
      ,[SENDER] as'المرسل'
      ,[RECUPIRATEUR] as'المستلم'
      ,[TYPE_LIV] as'نوع النقل'
      ,[PRICE_LIV] as'سعر النقل'
      ,[INFORMATION_CHAUFEURE] as'معلومات السائق'
      ,[MATRICULE] as'رقم لوحة السيارة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_LIVRAISON_VENTE]
  inner join tb_user on TB_USER.ID = TB_LIVRAISON_VENTE.ID_USER
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_LIVRAISON_VENTE.ID_CAISSIER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER  
  inner join TB_FACTURE_VENTE on TB_FACTURE_VENTE.NMR_FACTURE = [TB_LIVRAISON_VENTE].id_Facture  
  where    
  		 TB_FACTURE_VENTE.ID_CLIENT = @ID_search
        


















GO
/****** Object:  StoredProcedure [dbo].[search_Tb_livraison_vente_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_Tb_livraison_vente_by_date]
@ID_search date
as
SELECT [TB_LIVRAISON_VENTE].[ID] 
      ,[id_Facture] as'رقم الطلبية'
      ,[TB_LIVRAISON_VENTE].[DATE] as'التاريخ'
      ,[SENDER] as'المرسل'
      ,[RECUPIRATEUR] as'المستلم'
      ,[TYPE_LIV] as'نوع النقل'
      ,[PRICE_LIV] as'سعر النقل'
      ,[INFORMATION_CHAUFEURE] as'معلومات السائق'
      ,[MATRICULE] as'رقم لوحة السيارة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابض'
  FROM [dbo].[TB_LIVRAISON_VENTE]
  inner join tb_user on TB_USER.ID = TB_LIVRAISON_VENTE.ID_USER
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_LIVRAISON_VENTE.ID_CAISSIER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER  
  inner join TB_FACTURE_VENTE on TB_FACTURE_VENTE.NMR_FACTURE = [TB_LIVRAISON_VENTE].id_Facture  
  where    
  		 [TB_LIVRAISON_VENTE].[DATE] = @ID_search
        


















GO
/****** Object:  StoredProcedure [dbo].[search_tb_remarque_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[search_tb_remarque_client]
@Search nvarchar(50)
as 
SELECT [TB_REMARQUE_CLIENT].[ID] as'ID'
      ,TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME as'اسم ولقب الزبون'
      ,[REMARQUE_DE_CLIENT] as'الملاحظة'
  FROM [dbo].[TB_REMARQUE_CLIENT]
  inner join TB_CLIENT on TB_CLIENT.ID  = [TB_REMARQUE_CLIENT].ID_CLIENT
  where 
  TB_CLIENT.NAME +' '+TB_CLIENT.PRENAME LIKE N'%' + @Search + '%' 
  OR [REMARQUE_DE_CLIENT] LIKE N'%' + @Search + '%'

















GO
/****** Object:  StoredProcedure [dbo].[search_tb_transite_cheque]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[search_tb_transite_cheque]
@ID_search nvarchar(50)
as
SELECT [TB_TRANSITE_CHEQUE].[ID]
      ,[NMR_CHEQUE] as'رقم الشيك' 
      ,[DATE_TRANSITE] as'تاريخ العملية'
	  ,TB_Client.NAME_PRENAME as'الزبون'
      ,[TB_TRANSITE_CHEQUE].[REMARQUE] as'الملاحظة'
	  ,TB_CHEQUE.amount as'المبلغ'
  FROM [dbo].[TB_TRANSITE_CHEQUE]
INNER JOIN TB_CHEQUE ON TB_CHEQUE.NMR_CHEQU = [TB_TRANSITE_CHEQUE].[NMR_CHEQUE] 
INNER JOIN TB_Client ON TB_Client.ID = [TB_TRANSITE_CHEQUE].[ID_CLIENT] 
	where  [NMR_CHEQUE] LIKE N'%' + @ID_search + '%'
  		OR [DATE_TRANSITE]  LIKE N'%' + @ID_search + '%'
  		OR TB_Client.NAME_PRENAME LIKE N'%' + @ID_search + '%'
  		OR [TB_TRANSITE_CHEQUE].[REMARQUE] LIKE N'%' + @ID_search + '%'



GO
/****** Object:  StoredProcedure [dbo].[search_tb_transite_cheque_by_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[search_tb_transite_cheque_by_client]
@ID_search int
as
SELECT [TB_TRANSITE_CHEQUE].[ID]
      ,[NMR_CHEQUE] as'رقم الشيك' 
      ,[DATE_TRANSITE] as'تاريخ العملية'
	  ,TB_Client.NAME_PRENAME as'الزبون'
      ,[TB_TRANSITE_CHEQUE].[REMARQUE] as'الملاحظة'
	  ,TB_CHEQUE.amount as'المبلغ'
  FROM [dbo].[TB_TRANSITE_CHEQUE]
INNER JOIN TB_CHEQUE ON TB_CHEQUE.NMR_CHEQU = [TB_TRANSITE_CHEQUE].[NMR_CHEQUE] 
INNER JOIN TB_Client ON TB_Client.ID = [TB_TRANSITE_CHEQUE].[ID_CLIENT] 
	where  [TB_TRANSITE_CHEQUE].[ID_CLIENT]  = @ID_search



GO
/****** Object:  StoredProcedure [dbo].[search_upload_fichier_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_upload_fichier_facture]
@ID_search nvarchar(50)
AS
SELECT [ID]
      ,[ID_FACTURE] AS'رقم الفاتورة'
      ,[REMARQUE] AS'ملاحظة' 
  FROM [dbo].[TB_UPLOAD_FICHIER_FACTURE] 
  where    
  		[ID_FACTURE] LIKE N'%' + @ID_search + '%'
        OR [REMARQUE] LIKE N'%' + @ID_search + '%' 
        
















GO
/****** Object:  StoredProcedure [dbo].[search_user]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[search_user]
@ID_search nvarchar(50)
as
SELECT [TB_USER].[ID]
      ,TB_OUVERIER.NAME +' '+ TB_OUVERIER.PRENAME as'الاسم واللقب'
      ,[USERR] as'اسم المستخدم'
      ,[PASS] as'كلمة المرور'
      ,[ROLE] as'نوع الحساب'
      ,[ETAS] as'الحالة'
  FROM [dbo].[TB_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
    where 
  		TB_OUVERIER.NAME +' '+ TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%'
        OR [USERR] LIKE N'%' + @ID_search + '%'
        OR [PASS] LIKE N'%' + @ID_search + '%' 
        OR [ROLE] LIKE N'%' + @ID_search + '%' 
        OR [ETAS] LIKE N'%' + @ID_search + '%'  
        

















GO
/****** Object:  StoredProcedure [dbo].[SearchBetweenTwoDates]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE PROCEDURE [dbo].[SearchBetweenTwoDates]
    @StartDate DATE,
    @EndDate DATE
AS
BEGIN
    SELECT 
        [TB_HISTORIQUE_CLIENT].[ID] AS 'ID',
        [DATE] AS 'التاريخ',
        TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME AS 'الزبون',
        [PRICE] AS 'المبلغ المدفوع',
        [CREDIT_OLD] AS 'المبلغ القديم',
        [CREDIT_NEW] AS 'المبلغ الجديد',
        [REMARQUE] AS 'الملاحظة'
    FROM 
        [dbo].[TB_HISTORIQUE_CLIENT]
    INNER JOIN 
        TB_CLIENT ON TB_CLIENT.id = TB_HISTORIQUE_CLIENT.[ID_CLIENT]
    WHERE 
        [DATE] BETWEEN @StartDate AND @EndDate;
END;
















GO
/****** Object:  StoredProcedure [dbo].[SearchBetweenTwoDates_historique_frnsre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[SearchBetweenTwoDates_historique_frnsre]
    @StartDate DATE,
    @EndDate DATE
AS
BEGIN 
	SELECT [TB_HISTORIQUE_FOURNISSEUR].[ID] as'ID'
      ,[DATE] as'التاريخ'
      ,TB_FOURNISSUER.NAME + ' ' +TB_FOURNISSUER.PRENAME  as'اسم ولقب المورد'
      ,[PRICE] as'الدفع'
      ,[CREDIT_OLD] as'المبلغ القديم'
      ,[CREDIT_NEW] as'المبلغ الجديد'
      ,[REMARQUE] as'ملاحظة'
  FROM [dbo].[TB_HISTORIQUE_FOURNISSEUR]
  INNER JOIN 
        TB_FOURNISSUER ON TB_FOURNISSUER.id = [TB_HISTORIQUE_FOURNISSEUR].[ID_CLIENT]
    WHERE 
        [DATE] BETWEEN @StartDate AND @EndDate;
END;
















GO
/****** Object:  StoredProcedure [dbo].[searche_list_Categories]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[searche_list_Categories]
@ID_search varchar(50)
as
SELECT [ID] as'ID'
      ,[CATEGORIES] as'الصنف'
  FROM [dbo].[TB_CATEGORIES]
  where 
  		[CATEGORIES] LIKE N'%' + @ID_search + '%'
















GO
/****** Object:  StoredProcedure [dbo].[searche_list_Marque]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO






create proc [dbo].[searche_list_Marque]
@ID_search varchar(50)
as
SELECT [ID] as'ID'
      ,Marque as'الصنف'
  FROM [dbo].TB_MARQUE
  where 
  		Marque LIKE N'%' + @ID_search + '%'
















GO
/****** Object:  StoredProcedure [dbo].[searche_list_stocke]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[searche_list_stocke]
@ID_search varchar(50)
as
SELECT [ID] as'ID'
      ,[STOCKE] as'اسم المخزن'
  FROM [dbo].[TB_STOCK]
  where 
  		[STOCKE] LIKE N'%' + @ID_search + '%'
















GO
/****** Object:  StoredProcedure [dbo].[searche_list_unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[searche_list_unite]
@ID_search varchar(50)
as
SELECT [ID] as'ID'
      ,[UNITE] as'الوحدة'
  FROM [dbo].[TB_UNITE]
  where 
  		[UNITE] LIKE N'%' + @ID_search + '%'
















GO
/****** Object:  StoredProcedure [dbo].[searh_facture_vente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[searh_facture_vente]
@ID_search nvarchar(50)
as 
SELECT [Nmr_facture] as'رقم الفاتورة'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'الزبون'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابص'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,[date] as'التاريخ'
      ,[heure] as'الوقت'
      ,[Total_ttc] as'المبلغ الكلي TTC'
      ,[total_ht] as'المبلغ الكلي HT'
      ,[tva] as'TVA'
      ,[remise] as'الخصم'
      ,[pourcentage_remise] as'نسبة الخصم'
      ,[tembre] as'الطابع'
      ,[price_originale] as'السعر الأصلي'
      ,[Count_article] as'عدد المنتجات'
      ,[ttl_QTT] as'الكمية الكلية'
      ,[price_arabe] as'السعر بالعربية'
      ,[price_fr] as'السعر بالفرنسية'
      ,[type_payment] as'نوع الدفع'
      ,[old_sold] as'الديون القديمة'
      ,[versement] as'المدفوع'
      ,[new_sold] as'الديون الجديدة'
      ,[TB_FACTURATION].[remarque] as'الملاحظة'
      ,[cout_fctr] as'التكلفة'
      ,[TB_FACTURATION].[etas] as'الحالة'
  FROM [dbo].[TB_FACTURATION]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_FACTURATION.id_client
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_FACTURATION.id_caissie
  inner join TB_USER on TB_USER.ID = TB_FACTURATION.id_user
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME LIKE N'%' + @ID_search + '%'
        OR [date] LIKE N'%' + @ID_search + '%'
        OR [heure] LIKE N'%' + @ID_search + '%' 
        OR TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME LIKE N'%' + @ID_search + '%' 
        OR TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME LIKE N'%' + @ID_search + '%' 
        OR [heure] LIKE N'%' + @ID_search + '%' 
        OR [Total_ttc] LIKE N'%' + @ID_search + '%' 
        OR [total_ht] LIKE N'%' + @ID_search + '%' 
        OR [remise] LIKE N'%' + @ID_search + '%' 
        OR [pourcentage_remise] LIKE N'%' + @ID_search + '%' 
        OR [TB_FACTURATION].[remarque] LIKE N'%' + @ID_search + '%' 
        OR [cout_fctr] LIKE N'%' + @ID_search + '%'  

GO
/****** Object:  StoredProcedure [dbo].[searh_facture_vente_by_client]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[searh_facture_vente_by_client]
@ID_client nvarchar(50)
as 
SELECT [Nmr_facture] as'رقم الفاتورة'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'الزبون'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابص'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,[date] as'التاريخ'
      ,[heure] as'الوقت'
      ,[Total_ttc] as'المبلغ الكلي TTC'
      ,[total_ht] as'المبلغ الكلي HT'
      ,[tva] as'TVA'
      ,[remise] as'الخصم'
      ,[pourcentage_remise] as'نسبة الخصم'
      ,[tembre] as'الطابع'
      ,[price_originale] as'السعر الأصلي'
      ,[Count_article] as'عدد المنتجات'
      ,[ttl_QTT] as'الكمية الكلية'
      ,[price_arabe] as'السعر بالعربية'
      ,[price_fr] as'السعر بالفرنسية'
      ,[type_payment] as'نوع الدفع'
      ,[old_sold] as'الديون القديمة'
      ,[versement] as'المدفوع'
      ,[new_sold] as'الديون الجديدة'
      ,[TB_FACTURATION].[remarque] as'الملاحظة'
      ,[cout_fctr] as'التكلفة'
      ,[TB_FACTURATION].[etas] as'الحالة'
  FROM [dbo].[TB_FACTURATION]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_FACTURATION.id_client
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_FACTURATION.id_caissie
  inner join TB_USER on TB_USER.ID = TB_FACTURATION.id_user
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where [TB_FACTURATION].id_client =@ID_client

GO
/****** Object:  StoredProcedure [dbo].[searh_facture_vente_by_date]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[searh_facture_vente_by_date]
@Date nvarchar(50)
as 
SELECT [Nmr_facture] as'رقم الفاتورة'
      ,TB_CLIENT.NAME+' '+TB_CLIENT.PRENAME as'الزبون'
      ,TB_INFO_CAISSIER.NAME+' '+TB_INFO_CAISSIER.PRENAME as'القابص'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
      ,[date] as'التاريخ'
      ,[heure] as'الوقت'
      ,[Total_ttc] as'المبلغ الكلي TTC'
      ,[total_ht] as'المبلغ الكلي HT'
      ,[tva] as'TVA'
      ,[remise] as'الخصم'
      ,[pourcentage_remise] as'نسبة الخصم'
      ,[tembre] as'الطابع'
      ,[price_originale] as'السعر الأصلي'
      ,[Count_article] as'عدد المنتجات'
      ,[ttl_QTT] as'الكمية الكلية'
      ,[price_arabe] as'السعر بالعربية'
      ,[price_fr] as'السعر بالفرنسية'
      ,[type_payment] as'نوع الدفع'
      ,[old_sold] as'الديون القديمة'
      ,[versement] as'المدفوع'
      ,[new_sold] as'الديون الجديدة'
      ,[TB_FACTURATION].[remarque] as'الملاحظة'
      ,[cout_fctr] as'التكلفة'
      ,[TB_FACTURATION].[etas] as'الحالة'
  FROM [dbo].[TB_FACTURATION]
  inner join TB_CLIENT on TB_CLIENT.ID = TB_FACTURATION.id_client
  inner join TB_INFO_CAISSIER on TB_INFO_CAISSIER.ID = TB_FACTURATION.id_caissie
  inner join TB_USER on TB_USER.ID = TB_FACTURATION.id_user
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  where [TB_FACTURATION].date =@Date

GO
/****** Object:  StoredProcedure [dbo].[SELECT_ALL_INFORMATION_PRODUIT_PREVENT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[SELECT_ALL_INFORMATION_PRODUIT_PREVENT]
@code_barre nvarchar(50)
as
SELECT [CodeBarre]
      ,[designation]
      ,[reference]
      ,[id_categories]
      ,[id_stocke]
      ,[id_marque]
      ,[id_unite]
      ,[id_taille]
      ,[id_color]
      ,[id_favoire]
      ,[date_expiration]
      ,[price_achat_HT]
      ,[price_achat_TTC]
      ,[TVA]
      ,[Quantite_TOTAL]
      ,[price_vente1]
      ,[price_vente2]
      ,[price_min]
      ,[vente_apres_expiration]
      ,[stocke_negatif]
      ,[Quantite_vente]
      ,[Quantite_rest]
      ,[Quantite_dechet]
      ,[Photo]
      ,[QT_DANS_PACK]
  FROM [dbo].[TB_Produit_revente]
  where CodeBarre = @code_barre
















GO
/****** Object:  StoredProcedure [dbo].[select_benifice_state]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[select_benifice_state]
AS
SELECT 
    [CodeBarre] AS 'رقم المنتج',
    [designation] AS 'اسم المنتج',
    CASE 
        WHEN price_achat_TTC = 0 THEN 'سعر الشراء 0'
        ELSE (([price_vente1] - price_achat_TTC) / NULLIF(price_achat_TTC, 0)) * 100 
    END AS 'هامش الربح للسعر الاول',
    CASE 
        WHEN price_achat_TTC = 0 THEN 'سعر الشراء 0'
        ELSE (([price_vente2] - price_achat_TTC) / NULLIF(price_achat_TTC, 0)) * 100 
    END AS 'هامش الربح للسعر الثاني',
    CASE 
        WHEN price_achat_TTC = 0 THEN 'سعر الشراء 0'
        ELSE (([price_min] - price_achat_TTC) / NULLIF(price_achat_TTC, 0)) * 100 
    END AS 'هامش الربح للسعر الثالث'
FROM 
    [TB_Produit_revente]







GO
/****** Object:  StoredProcedure [dbo].[SELECT_COUNT_PRODUIT]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[SELECT_COUNT_PRODUIT]
AS
SELECT 
[CodeBarre] as'رقم المنتج'
, [designation] as'اسم المنتج'
, ([price_vente1] - price_achat_TTC / price_achat_TTC) * 100 AS 'هامش الربح للسعر الاول',
(price_vente2 - price_achat_TTC / price_achat_TTC) * 100 AS 'هامش الربح للسعر الثاني',
(price_min - price_achat_TTC / price_achat_TTC) * 100 AS 'هامش الربح للسعر الثالث'
FROM [TB_Produit_revente]







GO
/****** Object:  StoredProcedure [dbo].[select_detaille_livraison]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_detaille_livraison]
@ID_liv int
as
SELECT [TB_HISTORIQUE_SUB_COMMANDE].[ID]
      ,[ID_HISTORUQE_LIVRAISON] as'رقم التوصيل'
	  ,TB_SUM_COMMANDE.SUB_COMMANDE_TITLE as'اسم المنتج' 
      ,[QUANTITE_LIVRE] as'الكمية'
  FROM [dbo].[TB_HISTORIQUE_SUB_COMMANDE]
  left join TB_INFO_DE_LIV on TB_INFO_DE_LIV.ID = TB_HISTORIQUE_SUB_COMMANDE.ID_HISTORUQE_LIVRAISON
  left join TB_SUM_COMMANDE on TB_SUM_COMMANDE.id  = TB_HISTORIQUE_SUB_COMMANDE.ID_SUB_COMMANDE
  where [TB_HISTORIQUE_SUB_COMMANDE].ID_HISTORUQE_LIVRAISON = @ID_liv
















GO
/****** Object:  StoredProcedure [dbo].[select_facture_produit_revente]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_facture_produit_revente]
as
SELECT [NMR_FCTR]		 as'رفم الفاتورة'
      ,[DATE]			 as'التاريخ'
      ,TB_FOURNISSUER.NAME +' ' +TB_FOURNISSUER.PRENAME as'المورد'
      ,[NMBRE_DE_PRODUIT]as'عدد المنتجات'
      ,[VERSEMNT]		 as'الدفع'
      ,[TOTAL]			 as'المبلغ الكلي TTC'
      ,[TOTAL_HT]		 as'المبلغ الكلي HT'
      ,[CREDIT_PRECEDENT]as'الديون السابقة'
      ,[CREDIT_AFTER] 	 as'الديون الجديدة'
      ,TB_OUVERIER.NAME + ' ' + TB_OUVERIER.PRENAME  as'المستخدم'
  FROM [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]
  inner join TB_FOURNISSUER on TB_FOURNISSUER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_FOURNISSEUR
  inner join TB_USER on TB_USER.ID = [TB_FACTURE_ACHAT_PRODUIT_REVENT].ID_USER
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER

















GO
/****** Object:  StoredProcedure [dbo].[select_info]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_info]
@codeBarre nvarchar(50)
as
SELECT [CODEBARRE]
      ,[DESIGNATION]
      ,[UNITE]
      ,[CATEGORIES]
      ,TB_STOCK.STOCKE
      ,TB_MARQUE.Marque
      ,[QUANTITE]
      ,[QUANTITE_REST]
      ,[QUANTITE_USE]
      ,[QUANTITE_PACKES]
      ,[PHOTO]
      ,[DATE_PREPARATION]
      ,[OBSERVATION]
      ,[STOCKES_MIN]
      ,[PRODUIT_DES_PIECES]
	  ,REFERENCE
  FROM [dbo].[TB_MATIER_PREMIER]
  LEFT JOIN TB_MARQUE ON TB_MARQUE.ID = TB_MATIER_PREMIER.MARKE
  LEFT JOIN TB_STOCK ON TB_STOCK.ID = TB_MATIER_PREMIER.STOCKES
  where TB_MATIER_PREMIER.CODEBARRE = @codeBarre

















GO
/****** Object:  StoredProcedure [dbo].[select_matier_caisse]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[select_matier_caisse]
AS
BEGIN
   SELECT  
    ID,
    TB_MATIER_USE_SUB_CMND_caise.ID_SUB_COMMANDE AS 'ر.ط',
	TB_MATIER_USE_SUB_CMND_caise.ID_MATIER 'ر,م' ,
    CASE 
        WHEN TB_MATIER_USE_SUB_CMND_caise.NAME_MATIER IS NOT NULL THEN TB_MATIER_USE_SUB_CMND_caise.NAME_MATIER 
        ELSE TB_MATIER_USE_SUB_CMND_caise.ID_MATIER 
    END AS 'المنتج',
    QT AS 'الكمية',
    COUT AS 'التكلفة',
    QTDECHET AS 'كم مخ',
	delte as 'إ,ت'
	
FROM 
    [dbo].[TB_MATIER_USE_SUB_CMND_caise]
left JOIN 
    TB_MATIER_PREMIER ON TB_MATIER_PREMIER.CODEBARRE = TB_MATIER_USE_SUB_CMND_caise.ID_MATIER;

END

















GO
/****** Object:  StoredProcedure [dbo].[select_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_pack]
@ID_PRODUIT_FINAUX nvarchar(50)
as
SELECT [BARCODE_PACK]
      ,[DESIGNATION]
      ,[ID_PRODUIT_FINAUX]
      ,[QT_DISPONIBLE]
      ,[PRICE_GROS]
      ,[PRICE_DETAILLE]
      ,[PRICE_MIN]
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
   where [ID_PRODUIT_FINAUX] = @ID_PRODUIT_FINAUX

















GO
/****** Object:  StoredProcedure [dbo].[select_Pack_all]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[select_Pack_all]
@code_barre nvarchar(50)
as 
SELECT [pack_code_barre]
      ,[pack_designation]
      ,[code_barre_produit]
      ,[quantite]
      ,[price_unitair]
      ,[photo]
      ,[id_favoire]
	  ,photo_code_barre
  FROM [dbo].[TB_PACK_PRODUIT_REVENT] 
  where [pack_code_barre] = @code_barre
















GO
/****** Object:  StoredProcedure [dbo].[select_pack_info]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_pack_info]
@codeBare nvarchar(50)
as
SELECT [pack_code_barre]
      ,[pack_designation]
      ,[code_barre_produit]
      ,[quantite]
      ,[price_unitair]
      ,[TB_PACK_PRODUIT_REVENT].[photo]
      ,[TB_PACK_PRODUIT_REVENT].[id_favoire]
	  ,TB_Produit_revente.price_achat_TTC
	  ,TB_Produit_revente.QT_DANS_PACK
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = TB_PACK_PRODUIT_REVENT.code_barre_produit
  where pack_code_barre = @codeBare

















GO
/****** Object:  StoredProcedure [dbo].[select_pack_produit_finaux_by_Unite]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_pack_produit_finaux_by_Unite]
@codeBare nvarchar(50)
as 
SELECT [BARCODE_PACK]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[DESIGNATION]
      ,[ID_PRODUIT_FINAUX]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[PRICE_GROS]
      ,[PRICE_DETAILLE]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[PRICE_MIN]
      ,[QT_DISPONIBLE]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[picture]
	  ,TB_GESTION_PRODUIT_FINAUX.COUT_DE_PRODUCTION
	  ,TB_GESTION_PRODUIT_FINAUX.QT_DANS_PACK
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX] 
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = [TB_PACK_GESTION_PRODUIT_FINAUX].[ID_PRODUIT_FINAUX]
  where [TB_PACK_GESTION_PRODUIT_FINAUX].[ID_PRODUIT_FINAUX] = @codeBare
















GO
/****** Object:  StoredProcedure [dbo].[select_pack_Produit_finaux_info]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_pack_Produit_finaux_info]
@codeBare nvarchar(50)
as 
SELECT [BARCODE_PACK]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[DESIGNATION]
      ,[ID_PRODUIT_FINAUX]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[PRICE_GROS]
      ,[PRICE_DETAILLE]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[PRICE_MIN]
      ,[QT_DISPONIBLE]
      ,[TB_PACK_GESTION_PRODUIT_FINAUX].[picture]
      ,TB_GESTION_PRODUIT_FINAUX.COUT_DE_PRODUCTION
      ,TB_GESTION_PRODUIT_FINAUX.QT_DANS_PACK
	  ,TB_GESTION_PRODUIT_FINAUX.CODE_BARRE
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = TB_PACK_GESTION_PRODUIT_FINAUX.ID_PRODUIT_FINAUX 
  where BARCODE_PACK = @codeBare

















GO
/****** Object:  StoredProcedure [dbo].[select_pack_revent_by_code_barre_produit]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_pack_revent_by_code_barre_produit]
@codeBarreProduit nvarchar(50)
as 
SELECT [pack_code_barre]
      ,[pack_designation]
      ,[code_barre_produit]
      ,[quantite]
      ,[price_unitair]
      ,[TB_PACK_PRODUIT_REVENT].[photo]
      ,[TB_PACK_PRODUIT_REVENT].[id_favoire]
	  ,TB_Produit_revente.price_achat_TTC as 'achatttc'
	  ,TB_Produit_revente.QT_DANS_PACK as 'qt_pack'
  FROM [dbo].[TB_PACK_PRODUIT_REVENT]
  inner join TB_Produit_revente on TB_Produit_revente.CodeBarre = [TB_PACK_PRODUIT_REVENT].code_barre_produit
  where code_barre_produit = @codeBarreProduit

















GO
/****** Object:  StoredProcedure [dbo].[select_principale_facture]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_principale_facture]
as
SELECT [TB_PRINCIPE_fACTURE].[NMR_FACTURE] as'رقم الفاتورة'
      ,TB_CLIENT.NAME + ' ' + TB_CLIENT.PRENAME as'الزبون'
      ,[TB_PRINCIPE_fACTURE].[DATE] as'التاريخ'
      ,ROUND([TOTAL_HT],2) as'المبلغ الكلي HT'
      ,ROUND([TVA],2) as'TVA %'
      ,ROUND([TMBRE],2) as' % الطابع'
      ,ROUND([TOTAL_TTC],2) as'المبلغ الكلي TTC'
      ,ROUND([VERSE],2) as'المدفوع'
      ,ROUND([REST],2) as'المتبقي'
      ,TB_OUVERIER.NAME+ ' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_PRINCIPE_fACTURE]
  inner join TB_CLIENT on TB_CLIENT.id = [TB_PRINCIPE_fACTURE].[ID_CLIENT]
  inner join TB_USER on TB_USER.id = [TB_PRINCIPE_fACTURE].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER

















GO
/****** Object:  StoredProcedure [dbo].[select_produit_fabrique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_produit_fabrique]
@codeBarre Nvarchar(50)
as
SELECT [CODE_BARRE]
      ,[DESIGNATION]
      ,[QT_PARAMETRAGE]
      ,[UNITE]
      ,[CATEGORIE]
      ,[COUT_DE_PRODUCTION]
      ,[QT_DANS_PACK]
      ,[QT_TOTAL]
      ,[QT_VENTE]
      ,[QT_REST]
      ,[QT_DECHET]
      ,[PRICE_VENTE_HT]
      ,[PRICE_VENTE_TTC]
      ,[TVA]
      ,[PRICE_GROS]
      ,[PRICE_MIN]
      ,[qt_alter]
      ,[refereence]
      ,[picture]
  FROM [dbo].[TB_GESTION_PRODUIT_FINAUX]
  where CODE_BARRE = @codeBarre

















GO
/****** Object:  StoredProcedure [dbo].[select_produit_of_principe_with_id]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_produit_of_principe_with_id]
@ID nvarchar(50)
as
SELECT [ID] as'ID'
      ,[NAME] as'الاسم'
      ,ROUND([PRIX_UNITE], 2) as'سعر الوحدة'
      ,[QUANTITE] as'الكمية'
      ,ROUND([TOTAL], 2) as'المجموع'
      ,[ID_FACTURE] as'رقم الفاتورة'
  FROM [dbo].TB_PRODUIT_OF_FCTR_VIERGE
  where [ID_FACTURE]= @ID
















GO
/****** Object:  StoredProcedure [dbo].[select_table_fav]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_table_fav]
as
SELECT [ID] as'الرقم'
      ,[FAVOIRE] as'المفضلة'
  FROM [dbo].[TB_FAVORIS]

















GO
/****** Object:  StoredProcedure [dbo].[select_TB_color]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 create proc [dbo].[select_TB_color]
 as
 SELECT [ID] as'ID'
      ,[COLOR] as'اللون'
  FROM [dbo].[TB_COLOR]

















GO
/****** Object:  StoredProcedure [dbo].[select_tb_fav]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_tb_fav]
as
SELECT [ID] as'الرقم'
      ,[FAVOIRE] as'المفضلة'
  FROM [dbo].[TB_FAVORIS]

















GO
/****** Object:  StoredProcedure [dbo].[select_TB_HISTORIQUE_DEMONTER]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_TB_HISTORIQUE_DEMONTER]
as 
SELECT TB_HISTORIQUE_DEMONTER.[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,QT_PRODUCTION as'الكمية الملغاة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].TB_HISTORIQUE_DEMONTER
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = TB_HISTORIQUE_DEMONTER.[ID_PRODUCTION]
  inner join TB_USER on TB_USER.ID = TB_HISTORIQUE_DEMONTER.[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER
















GO
/****** Object:  StoredProcedure [dbo].[select_tb_history_production]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_tb_history_production]
as 
SELECT [TB_HISTORIQUE_PRODUCTION].[ID] as'ID'
      ,[DATE] as'التاريخ' 
      ,TB_GESTION_PRODUIT_FINAUX.DESIGNATION as'رقم المنتوج'
      ,[QT_BEFOR] as'الكمية السابقة'
      ,[QT_PROUDCTION] as'الكمية المصنوعة'
      ,[QT_AFTER] as'الكمية الجديدة'
      ,[COUT_PRODUCTION] as'تكلفة الصناعة'
      ,TB_OUVERIER.NAME+' '+TB_OUVERIER.PRENAME as'المستخدم'
  FROM [dbo].[TB_HISTORIQUE_PRODUCTION]
  inner join TB_GESTION_PRODUIT_FINAUX on TB_GESTION_PRODUIT_FINAUX.CODE_BARRE = [TB_HISTORIQUE_PRODUCTION].[ID_PRODUIT]
  inner join TB_USER on TB_USER.ID = [TB_HISTORIQUE_PRODUCTION].[ID_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER

















GO
/****** Object:  StoredProcedure [dbo].[select_tb_pack_pf_where]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_tb_pack_pf_where]
@ID_PRODUIT_FINAUX nvarchar(50)
as
SELECT [BARCODE_PACK]
      ,[DESIGNATION]
      ,[ID_PRODUIT_FINAUX]
      ,[PRICE_GROS]
      ,[PRICE_DETAILLE]
      ,[PRICE_MIN]
      ,[QT_DISPONIBLE]
  FROM [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
  where [ID_PRODUIT_FINAUX]=@ID_PRODUIT_FINAUX

















GO
/****** Object:  StoredProcedure [dbo].[select_tb_sub_commande]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_tb_sub_commande]
@Id_commannd nvarchar(50)
as
SELECT [ID] as'ID'
      ,[ID_COMMANDE] as'رقم الطلبية'
      ,[SUB_COMMANDE_TITLE] as'اسم الطلبية'
      ,[QUANTITE] as'الكمية'
      ,[PRIX_UNITAIR] as'سعر الوحدة'
      ,[PRIX_TOTAL] as'السعر الكلي'
      ,[QTE_REST] as'الكمية المتبقية'
      ,[QT_LIVRE] as'الكمية المرسلة'
      ,[price_cout] as'التكلفة'
  FROM [dbo].[TB_SUM_COMMANDE]
  where ID_COMMANDE = @Id_commannd

















GO
/****** Object:  StoredProcedure [dbo].[select_tb_taille]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[select_tb_taille]
as
SELECT [ID] as'ID'
      ,[TAILLE] as'القياس'
  FROM [dbo].[TB_TAILLE]

















GO
/****** Object:  StoredProcedure [dbo].[select_user_]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_user_]
as
SELECT [TB_USER].[ID]
      ,TB_OUVERIER.NAME +' '+ TB_OUVERIER.PRENAME as'الاسم واللقب'
      ,[USERR] as'اسم المستخدم'
      ,[PASS] as'كلمة المرور'
      ,[ROLE] as'نوع الحساب'
      ,[ETAS] as'الحالة'
  FROM [dbo].[TB_USER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = TB_USER.ID_OUVERIER

















GO
/****** Object:  StoredProcedure [dbo].[select_versement_ouverier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[select_versement_ouverier]
as
SELECT [TB_VERSEMNT_OUVERIER].[ID] as'ID'
      ,[TB_VERSEMNT_OUVERIER].[DATE] as'التاريخ'
      ,TB_OUVERIER.NAME + ' '+TB_OUVERIER.PRENAME as'العامل'
      ,[PRICE_PAYER] as'المبلغ'
      ,[REMARQUE] as'ملاحظة'
  FROM [TB_VERSEMNT_OUVERIER]
  inner join TB_OUVERIER on TB_OUVERIER.ID = [TB_VERSEMNT_OUVERIER].[ID_OUVERIER]

















GO
/****** Object:  StoredProcedure [dbo].[sp_GetclientSums]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[sp_GetclientSums]
AS
BEGIN
    SELECT 
        (SELECT Sum(SOLD_PAYE) FROM TB_CLIENT) AS Sum_SOLD_PAYE,
        (SELECT Sum(SOLD_NON_PAYE) FROM TB_CLIENT) AS Sum_SOLD_NON_PAYE;
END;
















GO
/****** Object:  StoredProcedure [dbo].[sp_GetFournisseurSums]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[sp_GetFournisseurSums]
AS
BEGIN
    SELECT 
        (SELECT Sum(SOLD_PAYE) FROM TB_FOURNISSUER) AS Sum_SOLD_PAYE,
        (SELECT Sum(SOLD_NON_PAYE) FROM TB_FOURNISSUER) AS Sum_SOLD_NON_PAYE;
END;

















GO
/****** Object:  StoredProcedure [dbo].[sp_InsertVersementOuvrier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 

CREATE PROCEDURE [dbo].[sp_InsertVersementOuvrier]
    @DATE			DATETIME,
    @ID_OUVERIER INT,
    @PRICE_PAYER MONEY,
    @REMARQUE		NVARCHAR(MAX),
	@User_ID	int
AS
BEGIN
    SET NOCOUNT ON;

    INSERT INTO [dbo].[TB_VERSEMNT_OUVERIER]
           ([DATE], [ID_OUVERIER], [PRICE_PAYER], [REMARQUE],User_I)
     VALUES
           (@DATE, @ID_OUVERIER, @PRICE_PAYER, @REMARQUE,@User_ID);
END

















GO
/****** Object:  StoredProcedure [dbo].[SP_LOGIN]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[SP_LOGIN] 
@ID varchar(50) , @PWD varchar(50)
AS 
SELECT [TB_USER].[ID]
      ,TB_OUVERIER.NAME
	  ,TB_OUVERIER.PRENAME
      ,[USERR]
      ,[PASS]
      ,[ROLE]
      ,[ETAS]
  FROM [dbo].[TB_USER] 
  INNER JOIN TB_OUVERIER ON TB_OUVERIER.ID = TB_USER.ID_OUVERIER
  
WHERE [USERR]=@ID AND [PASS]=@PWD
  


















GO
/****** Object:  StoredProcedure [dbo].[sp_UpdateIDClientCount]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[sp_UpdateIDClientCount]
AS
BEGIN
    -- Step 1: Create the ID_client_Count table if it does not exist
    IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='ID_client_Count' AND xtype='U')
    BEGIN
        CREATE TABLE ID_client_Count (
            ID_client INT PRIMARY KEY,
            Total_Count INT
        );
    END;

    -- Clear the table before inserting new data
    TRUNCATE TABLE ID_client_Count;

    -- Step 2: Count occurrences in table_commande
    WITH CommandeCounts AS (
        SELECT ID_client, COUNT(*) AS Count_commande
        FROM TB_COMMANDE
        GROUP BY ID_client
    ),

    -- Step 3: Count occurrences in tb_facture_vente
    FactureCounts AS (
        SELECT ID_client, COUNT(*) AS Count_facture
        FROM tb_facture_vente
        GROUP BY ID_client
    ),

    -- Step 4: Combine counts and sum them
    CombinedCounts AS (
        SELECT
            COALESCE(c.ID_client, f.ID_client) AS ID_client,
            COALESCE(c.Count_commande, 0) + COALESCE(f.Count_facture, 0) AS Total_Count
        FROM CommandeCounts c
        FULL OUTER JOIN FactureCounts f ON c.ID_client = f.ID_client
    ),

    -- Step 5: Join with TB_Client to filter only existing clients
    FilteredCounts AS (
        SELECT cc.ID_client, cc.Total_Count
        FROM CombinedCounts cc
        INNER JOIN TB_Client tc ON cc.ID_client = tc.ID
    )

    -- Step 6: Insert the results into ID_client_Count table
    INSERT INTO ID_client_Count (ID_client, Total_Count)
    SELECT ID_client, Total_Count
    FROM FilteredCounts
    ORDER BY Total_Count DESC;


	 SELECT tc.NAME+' '+tc.PRENAME as'الزبون'
	 , ic.Total_Count as'عدد التعاملات'
    FROM ID_client_Count ic
    INNER JOIN TB_Client tc ON ic.ID_client = tc.ID
    ORDER BY ic.Total_Count DESC;
END;

--exec sp_UpdateIDClientCount
















GO
/****** Object:  StoredProcedure [dbo].[sp_UpdateIDClientCount_frnsre]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROCEDURE [dbo].[sp_UpdateIDClientCount_frnsre]
AS
BEGIN
    -- Step 1: Create the ID_client_Count table if it does not exist
    IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='ID_frnsre_count' AND xtype='U')
    BEGIN
        CREATE TABLE ID_frnsre_count (
            ID_frnsre INT PRIMARY KEY,
            Total_Count INT
        );
    END;

    -- Clear the table before inserting new data
    TRUNCATE TABLE ID_frnsre_count;

    -- Step 2: Count occurrences in table_commande
    WITH CommandeCounts AS (
        SELECT ID_FRNSR, COUNT(*) AS Count_commande
        FROM TB_FACTURE_ACHAT
        GROUP BY ID_FRNSR
    ),

    -- Step 3: Count occurrences in tb_facture_vente
    FactureCounts AS (
        SELECT ID_FOURNISSEUR, COUNT(*) AS Count_facture
        FROM TB_FACTURE_ACHAT_PRODUIT_REVENT
        GROUP BY ID_FOURNISSEUR
    ),

    -- Step 4: Combine counts and sum them
    CombinedCounts AS (
        SELECT
            COALESCE(c.ID_FRNSR, f.ID_FOURNISSEUR) AS ID_frnsre,
            COALESCE(c.Count_commande, 0) + COALESCE(f.Count_facture, 0) AS Total_Count
        FROM CommandeCounts c
        FULL OUTER JOIN FactureCounts f ON c.ID_FRNSR = f.ID_FOURNISSEUR
    ),

    -- Step 5: Join with TB_Client to filter only existing clients
    FilteredCounts AS (
        SELECT cc.ID_frnsre, cc.Total_Count
        FROM CombinedCounts cc
        INNER JOIN TB_FOURNISSUER tc ON cc.ID_frnsre = tc.ID
    )

    -- Step 6: Insert the results into ID_client_Count table
    INSERT INTO ID_frnsre_count(ID_frnsre, Total_Count)
    SELECT ID_frnsre, Total_Count
    FROM FilteredCounts
    ORDER BY Total_Count DESC;


	 SELECT tc.NAME+' '+tc.PRENAME as'المورد'
	 , ic.Total_Count as'عدد التعاملات'
    FROM ID_frnsre_count ic
    INNER JOIN TB_FOURNISSUER tc ON ic.ID_frnsre = tc.ID
    ORDER BY ic.Total_Count DESC;
END;

--exec sp_UpdateIDClientCount
















GO
/****** Object:  StoredProcedure [dbo].[sp_UpdateVersementOuvrier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



 

create PROCEDURE [dbo].[sp_UpdateVersementOuvrier]
    @ID INT,
    @DATE DATETIME,
    @ID_OUVERIER INT,
    @PRICE_PAYER MONEY,
    @REMARQUE NVARCHAR(MAX),
    @User_ID INT
AS
BEGIN
    SET NOCOUNT ON;

    UPDATE [dbo].[TB_VERSEMNT_OUVERIER]
    SET [DATE] = @DATE,
        [ID_OUVERIER] = @ID_OUVERIER,
        [PRICE_PAYER] = @PRICE_PAYER,
        [REMARQUE] = @REMARQUE,
        User_I = @User_ID
    WHERE [ID] = @ID;
END

















GO
/****** Object:  StoredProcedure [dbo].[tb_reserve_code]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[tb_reserve_code]
@Code_barre_principale nvarchar(50)
as
SELECT 
	   id 		
	  ,[code_barre_produit] as 'رقم المنتووج الاساسي'
      ,[code_barre_reserve] as 'رفم المنتوج الثانوي'
  FROM [dbo].[TB_CODE_BARRE_RESERVE]
  where code_barre_produit = @Code_barre_principale
















GO
/****** Object:  StoredProcedure [dbo].[update_cassier_info]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_cassier_info]
@ID			nvarchar(50)
,@NAME		nvarchar(50)
,@PRENAME	nvarchar(50)
,@USER_NAME nvarchar(50)
,@PASSW		nvarchar(50) 
as
UPDATE [dbo].[TB_INFO_CAISSIER]
   SET [NAME] = @NAME
      ,[PRENAME] = @PRENAME
      ,[USER-NAME] = @USER_NAME
      ,[PASSW] = @PASSW
 WHERE ID =@ID

















GO
/****** Object:  StoredProcedure [dbo].[update_client_payment]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_client_payment]
@ID int ,
@Solde_verse money,
@credit_new money,
@credit_total money
as
UPDATE [dbo].[TB_CLIENT]
   SET [NAME] = [NAME]
      ,[PRENAME] = [PRENAME]
      ,[PHONE] =[PHONE]
      ,[FAX] = [FAX]
      ,[EMAIL] = [EMAIL]
      ,[SOLD_TOTAL] = [SOLD_TOTAL]+@credit_total
      ,[SOLD_PAYE] = [SOLD_PAYE]+@Solde_verse
      ,[SOLD_NON_PAYE] = @credit_new
      ,[ADRESSE] = [ADRESSE]
      ,[Sold_avance] = [Sold_avance]
      ,[MAX_CREDIT] = [MAX_CREDIT]
      ,[NIF] = [NIF]
      ,[RC] = [RC]
      ,[Nic] = [Nic]
      ,[article] = [article]
      ,[originale_name_prename] = [originale_name_prename]
 WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[update_client_payment_]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_client_payment_]
@ID int ,
@Solde_verse money
as
UPDATE [dbo].[TB_CLIENT]
   SET [NAME] = [NAME]
      ,[PRENAME] = [PRENAME]
      ,[PHONE] =[PHONE]
      ,[FAX] = [FAX]
      ,[EMAIL] = [EMAIL]
      ,[SOLD_TOTAL] = [SOLD_TOTAL]
      ,[SOLD_PAYE] = [SOLD_PAYE]+@Solde_verse
      ,[SOLD_NON_PAYE] =[SOLD_NON_PAYE]- @Solde_verse
      ,[ADRESSE] = [ADRESSE]
      ,[Sold_avance] = [Sold_avance]
      ,[MAX_CREDIT] = [MAX_CREDIT]
      ,[NIF] = [NIF]
      ,[RC] = [RC]
      ,[Nic] = [Nic]
      ,[article] = [article]
      ,[originale_name_prename] = [originale_name_prename]
 WHERE ID = @ID
















GO
/****** Object:  StoredProcedure [dbo].[update_client_payment_avance]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_client_payment_avance]
@ID int ,
@avance money 
as
UPDATE [dbo].[TB_CLIENT]
   SET [NAME] = [NAME]
      ,[PRENAME] = [PRENAME]
      ,[PHONE] =[PHONE]
      ,[FAX] = [FAX]
      ,[EMAIL] = [EMAIL]
      ,[SOLD_TOTAL] = [SOLD_TOTAL]
      ,[SOLD_PAYE] = [SOLD_PAYE]
      ,[SOLD_NON_PAYE] = [SOLD_NON_PAYE]
      ,[ADRESSE] = [ADRESSE]
      ,[Sold_avance] = @avance
      ,[MAX_CREDIT] = [MAX_CREDIT]
      ,[NIF] = [NIF]
      ,[RC] = [RC]
      ,[Nic] = [Nic]
      ,[article] = [article]
      ,[originale_name_prename] = [originale_name_prename]
 WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[update_code_baree_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create proc [dbo].[update_code_baree_pack]
@code_barre nvarchar(50)
,@image_code image 
as
UPDATE [dbo].[TB_PACK_PRODUIT_REVENT]
   SET  [photo_code_barre] = @image_code
 WHERE pack_code_barre =@code_barre

GO
/****** Object:  StoredProcedure [dbo].[update_color_name]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[update_color_name]
@id int
,@Color nvarchar(50)
as
UPDATE [dbo].[TB_COLOR]
   SET [COLOR] =@Color
 WHERE TB_COLOR.ID = @id 
















GO
/****** Object:  StoredProcedure [dbo].[update_Depense]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_Depense]
@ID				int
,@CAUSE_DEPENSE nvarchar(max)
,@VALEURE		money
,@DATE			datetime
,@USER_ID		int
as
UPDATE [dbo].[TB_DEPENSE]
   SET [CAUSE_DEPENSE] = @CAUSE_DEPENSE
      ,[VALEURE] = @VALEURE
      ,[DATE] = @DATE
      ,[USER_ID] = @USER_ID
 WHERE ID = @ID

















GO
/****** Object:  StoredProcedure [dbo].[update_facture_achat]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE proc [dbo].[update_facture_achat]
 @NMR_FCTR			nvarchar(50)
,@DATE				datetime
,@ID_FOURNISSEUR		int
,@NMBRE_DE_PRODUIT	int
,@VERSEMNT			decimal(19,2)
,@TOTAL				decimal(19,2) 
,@TOTAL_HT			decimal(19,2)
,@CREDIT_PRECEDENT	decimal(19,2)
,@CREDIT_AFTER		decimal(19,2)
as
UPDATE [dbo].[TB_FACTURE_ACHAT_PRODUIT_REVENT]
   SET [NMR_FCTR] =			@NMR_FCTR			
      ,[DATE] =				@DATE				
      ,[ID_FOURNISSEUR] =	@ID_FOURNISSEUR	
      ,[NMBRE_DE_PRODUIT] = @NMBRE_DE_PRODUIT	
      ,[VERSEMNT] =			@VERSEMNT			
      ,[TOTAL] =			@TOTAL				
      ,[ID_USER] =			[ID_USER]			
      ,[TOTAL_HT] =			@TOTAL_HT			
      ,[CREDIT_PRECEDENT] = @CREDIT_PRECEDENT	
      ,[CREDIT_AFTER] =		@CREDIT_AFTER		
 WHERE NMR_FCTR =@NMR_FCTR;














GO
/****** Object:  StoredProcedure [dbo].[update_favoire]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_favoire]
@id int , @Fav nvarchar(50)
as
UPDATE [dbo].[TB_FAVORIS]
   SET [FAVOIRE] = @Fav
 WHERE TB_FAVORIS.ID = @id

















GO
/****** Object:  StoredProcedure [dbo].[update_history_caissier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[update_history_caissier]
 @ID int
,@HEURE_SORTIE	time(7) 
,@PRIX_CLOTURE	money
as
UPDATE [dbo].[TB_HISTORIQUE_CAISSIER]
   SET [ID_CAISSIE] = [ID_CAISSIE]
      ,[DATE] = [DATE]
      ,[HEURE_ENTRE] = [HEURE_ENTRE]
      ,[HEURE_SORTIE] = @HEURE_SORTIE
      ,[PRIX_FOND] = [PRIX_FOND]
      ,[PRIX_CLOTURE] = [PRIX_CLOTURE]+@PRIX_CLOTURE
 WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[update_proc]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





create proc [dbo].[update_proc]
@ID int
,@MacAdress nvarchar(max)
,@Serial	nvarchar(max)
,@instal_Day date
as  

UPDATE [dbo].[TB_MAX_ADRESS]
   SET [MacAdress] = @MacAdress
      ,[Serial] = @Serial
      ,[instal_Day] = @instal_Day
 WHERE ID = @ID 

















GO
/****** Object:  StoredProcedure [dbo].[update_QT_apres_routour]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE proc [dbo].[update_QT_apres_routour]
@codBarre nvarchar(50),
@QT float
as 
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke]
      ,[id_marque] = [id_marque]
      ,[id_unite] = [id_unite]
      ,[id_taille] = [id_taille]
      ,[id_color] = [id_color]
      ,[id_favoire] = [id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT] =[price_achat_HT]
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL]
      ,[price_vente1] =[price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] = [price_min]
      ,[vente_apres_expiration] =[vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] =[Quantite_vente]-@QT
      ,[Quantite_rest] = [Quantite_rest]+@QT
      ,[Quantite_dechet] = [Quantite_dechet]
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] =[QT_DANS_PACK]
 WHERE CodeBarre =@codBarre
















GO
/****** Object:  StoredProcedure [dbo].[update_QT_dans_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE proc [dbo].[update_QT_dans_pack]
@codBarre nvarchar(50),
@QT float
as 
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke]
      ,[id_marque] = [id_marque]
      ,[id_unite] = [id_unite]
      ,[id_taille] = [id_taille]
      ,[id_color] = [id_color]
      ,[id_favoire] = [id_favoire]
      ,[date_expiration] = [date_expiration]
      ,[price_achat_HT] =[price_achat_HT]
      ,[price_achat_TTC] = [price_achat_TTC]
      ,[TVA] = [TVA]
      ,[Quantite_TOTAL] = [Quantite_TOTAL]
      ,[price_vente1] =[price_vente1]
      ,[price_vente2] = [price_vente2]
      ,[price_min] = [price_min]
      ,[vente_apres_expiration] =[vente_apres_expiration]
      ,[stocke_negatif] = [stocke_negatif]
      ,[Quantite_vente] =[Quantite_vente]
      ,[Quantite_rest] = [Quantite_rest]
      ,[Quantite_dechet] = [Quantite_dechet]
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] =@QT
 WHERE CodeBarre =@codBarre












GO
/****** Object:  StoredProcedure [dbo].[update_qt_pack]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_qt_pack]
@ID_PRODUIT_FINAUX	nvarchar(50) ,
@number_update float
as
UPDATE [dbo].[TB_PACK_GESTION_PRODUIT_FINAUX]
   SET [BARCODE_PACK] = [BARCODE_PACK]
      ,[DESIGNATION] = [DESIGNATION]
      ,[ID_PRODUIT_FINAUX] = [ID_PRODUIT_FINAUX]
      ,[QT_DISPONIBLE] = [QT_DISPONIBLE] + @number_update
      ,[PRICE_GROS] = [PRICE_GROS]
      ,[PRICE_DETAILLE] = [PRICE_DETAILLE]
      ,[PRICE_MIN] = [PRICE_MIN]
 WHERE [ID_PRODUIT_FINAUX] = @ID_PRODUIT_FINAUX

















GO
/****** Object:  StoredProcedure [dbo].[update_QT_produit_prevent]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

 
--///////////////////////

CREATE proc [dbo].[update_QT_produit_prevent]
 @CodeBarre			nvarchar(50)
,@date_expiration	date
,@price_achat_HT	money
,@price_achat_TTC	money
,@TVA				float
,@Quantite_shop		float 
,@price_vente1		money
,@price_vente2		money
,@price_min			money
,@Quantite_alert	float
,@ihtiyaj	float
as
UPDATE [dbo].[TB_Produit_revente]
   SET [CodeBarre] = [CodeBarre]
      ,[designation] = [designation]
      ,[reference] = [reference]
      ,[id_categories] = [id_categories]
      ,[id_stocke] = [id_stocke]
      ,[id_marque] = [id_marque]
      ,[id_unite]  = [id_unite] 
      ,[id_taille] = [id_taille]
      ,[id_color] =  [id_color]
      ,[id_favoire] = [id_favoire]
      ,[date_expiration] =	 @date_expiration	
      ,[price_achat_HT] =	 @price_achat_HT	
      ,[price_achat_TTC] =	 @price_achat_TTC	
      ,[TVA] =				 @TVA				
      ,[Quantite_TOTAL] =	 [Quantite_TOTAL]+@Quantite_shop	
      ,[price_vente1] =		 @price_vente1	
      ,[price_vente2] =		 @price_vente2	
      ,[price_min] =		 @price_min		
      ,[vente_apres_expiration] = [vente_apres_expiration]
      ,[stocke_negatif] =	[stocke_negatif]
      ,[Quantite_vente] =	 [Quantite_vente]	
      ,[Quantite_rest] =	 [Quantite_rest]+@Quantite_shop		
      ,[Quantite_dechet] =	 [Quantite_dechet]	
      ,[Photo] = [Photo]
      ,[QT_DANS_PACK] =	[QT_DANS_PACK]
      ,[Quantite_alert] = @Quantite_alert
      ,[ihtiyaj] =@ihtiyaj
 WHERE [CodeBarre] = @CodeBarre











GO
/****** Object:  StoredProcedure [dbo].[update_quantite_matier]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_quantite_matier]
 @CODEBARRE nvarchar(50)
,@QUANTITE		int 
AS 
UPDATE [dbo].[TB_MATIER_PREMIER]
   SET [CODEBARRE] = [CODEBARRE]
      ,[DESIGNATION] = [DESIGNATION]
      ,[UNITE] = [UNITE]
      ,[CATEGORIES] = [CATEGORIES]
      ,[STOCKES] = [STOCKES]
      ,[MARKE] = [MARKE]
      ,[QUANTITE] = [QUANTITE]+@QUANTITE
      ,[QUANTITE_REST] = [QUANTITE_REST]+@QUANTITE
      ,[QUANTITE_USE] = [QUANTITE_USE]
      ,[QUANTITE_PACKES] = [QUANTITE_PACKES]
      ,[PHOTO] = [PHOTO]
      ,[DATE_PREPARATION] = [DATE_PREPARATION]
      ,[OBSERVATION] = [OBSERVATION]
      ,[STOCKES_MIN] = [STOCKES_MIN]
      ,[PRODUIT_DES_PIECES] = [PRODUIT_DES_PIECES]
 WHERE CODEBARRE = @CODEBARRE

















GO
/****** Object:  StoredProcedure [dbo].[UPDATE_SOLD_FRNSRE]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE PROC [dbo].[UPDATE_SOLD_FRNSRE]
@ID int
,@SOLD_TOTAL    float
,@SOLD_PAYE     float
,@SOLD_NON_PAYE float
AS 
UPDATE [dbo].[TB_FOURNISSUER]
   SET [NAME] = [NAME]
      ,[PRENAME] = [PRENAME]
      ,[PHONE] = [PHONE]
      ,[FAX] = [FAX]
      ,[EMAIL] = [EMAIL]
      ,[SOLD_TOTAL] =[SOLD_TOTAL]+ @SOLD_TOTAL   
      ,[SOLD_PAYE] =[SOLD_PAYE]+ @SOLD_PAYE    
      ,[SOLD_NON_PAYE] = @SOLD_NON_PAYE
      ,[ADRESSE] = [ADRESSE]
      ,[NIF] = [NIF]
      ,[RC] = [RC]
      ,[Nic] = [Nic]
      ,[article] = [article]
      ,[originale_name_prename] = [originale_name_prename]
 WHERE ID=@ID

















GO
/****** Object:  StoredProcedure [dbo].[update_stock_produit_fabrique]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



CREATE proc [dbo].[update_stock_produit_fabrique]
@Codebarre nvarchar(50),
@Qt_fabrique float
as
UPDATE [dbo].[TB_GESTION_PRODUIT_FINAUX]
   SET [CODE_BARRE] = [CODE_BARRE]
      ,[DESIGNATION] = [DESIGNATION]
      ,[QT_PARAMETRAGE] = [QT_PARAMETRAGE]
      ,[UNITE] = [UNITE]
      ,[CATEGORIE] = [CATEGORIE]
      ,[COUT_DE_PRODUCTION] = [COUT_DE_PRODUCTION]
      ,[QT_DANS_PACK] = [QT_DANS_PACK]
      ,[QT_TOTAL] = [QT_TOTAL]+@Qt_fabrique
      ,[QT_VENTE] = [QT_VENTE]
      ,[QT_REST] = [QT_REST]+@Qt_fabrique
      ,[QT_DECHET] = [QT_DECHET]
      ,[PRICE_VENTE_HT] = [PRICE_VENTE_HT] 
      ,[PRICE_VENTE_TTC] =[PRICE_VENTE_TTC]
      ,[TVA] = [TVA]
      ,[PRICE_GROS] = [PRICE_GROS]
      ,[PRICE_MIN] = [PRICE_MIN]
      ,[qt_alter] = [qt_alter]
 WHERE CODE_BARRE = @Codebarre

















GO
/****** Object:  StoredProcedure [dbo].[update_taille]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




create proc [dbo].[update_taille]
@id		int,
@Taille nvarchar(50)
as 
UPDATE [dbo].[TB_TAILLE]
   SET [TAILLE] = @Taille
 WHERE TB_TAILLE.ID = @id

















GO
/****** Object:  StoredProcedure [dbo].[update_user]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[update_user]
    @ID_OUVERIER int,
    @USERR nvarchar(50),
    @PASS nvarchar(50),
    @ROLE nvarchar(50),
    @ETAS nvarchar(50),
    @Code_Recupiraiton nvarchar(50),
    @id int,
    @Stock int,
    @unite int,
    @categorie int,
    @marque int,
    @favoris int,
    @taille int,
    @color int,
    @fournisseure int,
    @ouverier int,
    @users int,
    @caissier int,
    @client int,
    @historique_client int,
    @remarque int,
    @achat int,
    @facture_achat int,
    @dossier_fctr_achat int,
    @historique_frnsre int,
    @stock_produit int,
    @pack int,
    @facture_vente int,
    @list_vente int,
    @liv int,
    @POS int,
    @les_charge int,
    @lapie int,
    @transition_caissier int,
    @state_total int,
    @benifice int,
    @serverss int,
    @facture_info int
AS
BEGIN
    UPDATE [dbo].[TB_USER]
    SET [ID_OUVERIER] = @ID_OUVERIER,
        [USERR] = @USERR,
        [PASS] = @PASS,
        [ROLE] = @ROLE,
        [ETAS] = @ETAS,
        [Code_Recupiraiton] = @Code_Recupiraiton,
        [Stock] = @Stock,
        [unite] = @unite,
        [categorie] = @categorie,
        [marque] = @marque,
        [favoris] = @favoris,
        [taille] = @taille,
        [color] = @color,
        [fournisseure] = @fournisseure,
        [ouverier] = @ouverier,
        [users] = @users,
        [caissier] = @caissier,
        [client] = @client,
        [historique_client] = @historique_client,
        [remarque] = @remarque,
        [achat] = @achat,
        [facture_achat] = @facture_achat,
        [dossier_fctr_achat] = @dossier_fctr_achat,
        [historique_frnsre] = @historique_frnsre,
        [stock_produit] = @stock_produit,
        [pack] = @pack,
        [facture_vente] = @facture_vente,
        [list_vente] = @list_vente,
        [liv] = @liv,
        [POS] = @POS,
        [les_charge] = @les_charge,
        [lapie] = @lapie,
        [transition_caissier] = @transition_caissier,
        [state_total] = @state_total,
        [benifice] = @benifice,
        [serverss] = @serverss,
        [facture_info] = @facture_info
    WHERE ID = @id;
END














GO
/****** Object:  StoredProcedure [dbo].[update_user_whene_logine]    Script Date: 04/05/2025 15:22:29 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO



create proc [dbo].[update_user_whene_logine]
@ID int ,
@Etas nvarchar(50)
as
UPDATE [dbo].[TB_USER]
   SET [ID_OUVERIER] = [ID_OUVERIER]
      ,[USERR] = [USERR]
      ,[PASS] = [PASS]
      ,[ROLE] = [ROLE]
      ,[ETAS] = @Etas
 WHERE ID = @ID

















GO
